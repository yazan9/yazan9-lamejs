function lamejs(){function ka(D){return new Int32Array(D)}function W(D){return new Float32Array(D)}function Ja(D){if(1==D.length)return W(D[0]);var B=D[0];D=D.slice(1);for(var F=[],N=0;N<B;N++)F.push(Ja(D));return F}function ic(D){if(1==D.length)return ka(D[0]);var B=D[0];D=D.slice(1);for(var F=[],N=0;N<B;N++)F.push(ic(D));return F}function ed(D){if(1==D.length)return new Int16Array(D[0]);var B=D[0];D=D.slice(1);for(var F=[],N=0;N<B;N++)F.push(ed(D));return F}function Vc(D){if(1==D.length)return Array(D[0]);
var B=D[0];D=D.slice(1);for(var F=[],N=0;N<B;N++)F.push(Vc(D));return F}function Va(D){this.ordinal=D}function aa(D){this.ordinal=D}function Ca(D){this.ordinal=function(){return D}}function jd(){this.getLameVersion=function(){return"3.98.4"};this.getLameShortVersion=function(){return"3.98.4"};this.getLameVeryShortVersion=function(){return"LAME3.98r"};this.getPsyVersion=function(){return"0.93"};this.getLameUrl=function(){return"http://www.mp3dev.org/"};this.getLameOsBitness=function(){return"32bits"}}
function kd(){function D(e,y,b,x,G,f,k,c,m,t,r,d,g,h,q){this.vbr_q=e;this.quant_comp=y;this.quant_comp_s=b;this.expY=x;this.st_lrm=G;this.st_s=f;this.masking_adj=k;this.masking_adj_short=c;this.ath_lower=m;this.ath_curve=t;this.ath_sensitivity=r;this.interch=d;this.safejoint=g;this.sfb21mod=h;this.msfix=q}function B(e,y,b,x,G,f,k,c,m,t,r,d,g,h){this.quant_comp=y;this.quant_comp_s=b;this.safejoint=x;this.nsmsfix=G;this.st_lrm=f;this.st_s=k;this.nsbass=c;this.scale=m;this.masking_adj=t;this.ath_lower=
r;this.ath_curve=d;this.interch=g;this.sfscale=h}function F(e,y,b){var x=e.VBR==aa.vbr_rh?K:S,G=e.VBR_q_frac,f=x[y];x=x[y+1];f.st_lrm+=G*(x.st_lrm-f.st_lrm);f.st_s+=G*(x.st_s-f.st_s);f.masking_adj+=G*(x.masking_adj-f.masking_adj);f.masking_adj_short+=G*(x.masking_adj_short-f.masking_adj_short);f.ath_lower+=G*(x.ath_lower-f.ath_lower);f.ath_curve+=G*(x.ath_curve-f.ath_curve);f.ath_sensitivity+=G*(x.ath_sensitivity-f.ath_sensitivity);f.interch+=G*(x.interch-f.interch);f.msfix+=G*(x.msfix-f.msfix);x=
f.vbr_q;0>x&&(x=0);9<x&&(x=9);e.VBR_q=x;e.VBR_q_frac=0;0!=b?e.quant_comp=f.quant_comp:0<Math.abs(e.quant_comp- -1)||(e.quant_comp=f.quant_comp);0!=b?e.quant_comp_short=f.quant_comp_s:0<Math.abs(e.quant_comp_short- -1)||(e.quant_comp_short=f.quant_comp_s);0!=f.expY&&(e.experimentalY=0!=f.expY);0!=b?e.internal_flags.nsPsy.attackthre=f.st_lrm:0<Math.abs(e.internal_flags.nsPsy.attackthre- -1)||(e.internal_flags.nsPsy.attackthre=f.st_lrm);0!=b?e.internal_flags.nsPsy.attackthre_s=f.st_s:0<Math.abs(e.internal_flags.nsPsy.attackthre_s-
-1)||(e.internal_flags.nsPsy.attackthre_s=f.st_s);0!=b?e.maskingadjust=f.masking_adj:0<Math.abs(e.maskingadjust-0)||(e.maskingadjust=f.masking_adj);0!=b?e.maskingadjust_short=f.masking_adj_short:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=f.masking_adj_short);0!=b?e.ATHlower=-f.ath_lower/10:0<Math.abs(10*-e.ATHlower)||(e.ATHlower=-f.ath_lower/10);0!=b?e.ATHcurve=f.ath_curve:0<Math.abs(e.ATHcurve- -1)||(e.ATHcurve=f.ath_curve);0!=b?e.athaa_sensitivity=f.ath_sensitivity:0<Math.abs(e.athaa_sensitivity-
-1)||(e.athaa_sensitivity=f.ath_sensitivity);0<f.interch&&(0!=b?e.interChRatio=f.interch:0<Math.abs(e.interChRatio- -1)||(e.interChRatio=f.interch));0<f.safejoint&&(e.exp_nspsytune|=f.safejoint);0<f.sfb21mod&&(e.exp_nspsytune|=f.sfb21mod<<20);0!=b?e.msfix=f.msfix:0<Math.abs(e.msfix- -1)||(e.msfix=f.msfix);0==b&&(e.VBR_q=y,e.VBR_q_frac=G)}function N(e,y,b){var x=O.nearestBitrateFullIndex(y);e.VBR=aa.vbr_abr;e.VBR_mean_bitrate_kbps=y;e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320);e.VBR_mean_bitrate_kbps=
Math.max(e.VBR_mean_bitrate_kbps,8);e.brate=e.VBR_mean_bitrate_kbps;320<e.VBR_mean_bitrate_kbps&&(e.disable_reservoir=!0);0<p[x].safejoint&&(e.exp_nspsytune|=2);0<p[x].sfscale&&(e.internal_flags.noise_shaping=2);if(0<Math.abs(p[x].nsbass)){var G=int(4*p[x].nsbass);0>G&&(G+=64);e.exp_nspsytune|=G<<2}0!=b?e.quant_comp=p[x].quant_comp:0<Math.abs(e.quant_comp- -1)||(e.quant_comp=p[x].quant_comp);0!=b?e.quant_comp_short=p[x].quant_comp_s:0<Math.abs(e.quant_comp_short- -1)||(e.quant_comp_short=p[x].quant_comp_s);
0!=b?e.msfix=p[x].nsmsfix:0<Math.abs(e.msfix- -1)||(e.msfix=p[x].nsmsfix);0!=b?e.internal_flags.nsPsy.attackthre=p[x].st_lrm:0<Math.abs(e.internal_flags.nsPsy.attackthre- -1)||(e.internal_flags.nsPsy.attackthre=p[x].st_lrm);0!=b?e.internal_flags.nsPsy.attackthre_s=p[x].st_s:0<Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)||(e.internal_flags.nsPsy.attackthre_s=p[x].st_s);0!=b?e.scale=p[x].scale:0<Math.abs(e.scale- -1)||(e.scale=p[x].scale);0!=b?e.maskingadjust=p[x].masking_adj:0<Math.abs(e.maskingadjust-
0)||(e.maskingadjust=p[x].masking_adj);0<p[x].masking_adj?0!=b?e.maskingadjust_short=.9*p[x].masking_adj:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=.9*p[x].masking_adj):0!=b?e.maskingadjust_short=1.1*p[x].masking_adj:0<Math.abs(e.maskingadjust_short-0)||(e.maskingadjust_short=1.1*p[x].masking_adj);0!=b?e.ATHlower=-p[x].ath_lower/10:0<Math.abs(10*-e.ATHlower)||(e.ATHlower=-p[x].ath_lower/10);0!=b?e.ATHcurve=p[x].ath_curve:0<Math.abs(e.ATHcurve- -1)||(e.ATHcurve=p[x].ath_curve);0!=
b?e.interChRatio=p[x].interch:0<Math.abs(e.interChRatio- -1)||(e.interChRatio=p[x].interch);return y}var O;this.setModules=function(e){O=e};var K=[new D(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new D(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new D(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new D(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new D(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new D(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2E-4,0,0,1.95),new D(6,9,9,1,6.6,145,.67,.65,-14.7,
6.5,-19,4E-4,0,0,2.3),new D(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6E-4,0,0,2.7),new D(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7E-4,0,0,0),new D(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8E-4,0,0,0),new D(10,9,9,1,6.6,145,2,2,-36,12,-25,8E-4,0,0,0)],S=[new D(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new D(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new D(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new D(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new D(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new D(5,
9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2E-4,0,0,1.95),new D(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4E-4,0,0,2),new D(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6E-4,0,0,2),new D(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7E-4,0,0,2),new D(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8E-4,0,0,2),new D(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8E-4,0,0,2)],p=[new B(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new B(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new B(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new B(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),
new B(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new B(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9E-4,1),new B(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8E-4,1),new B(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8E-4,1),new B(80,9,9,0,0,6.6,145,0,.95,0,0,8,7E-4,1),new B(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6E-4,1),new B(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5E-4,1),new B(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2E-4,1),new B(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new B(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new B(224,9,9,1,1.25,5.2,
125,0,.98,-6,9,2,0,0),new B(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new B(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];this.apply_preset=function(e,y,b){switch(y){case ia.R3MIX:y=ia.V3;e.VBR=aa.vbr_mtrh;break;case ia.MEDIUM:y=ia.V4;e.VBR=aa.vbr_rh;break;case ia.MEDIUM_FAST:y=ia.V4;e.VBR=aa.vbr_mtrh;break;case ia.STANDARD:y=ia.V2;e.VBR=aa.vbr_rh;break;case ia.STANDARD_FAST:y=ia.V2;e.VBR=aa.vbr_mtrh;break;case ia.EXTREME:y=ia.V0;e.VBR=aa.vbr_rh;break;case ia.EXTREME_FAST:y=ia.V0;e.VBR=aa.vbr_mtrh;break;case ia.INSANE:return y=
320,e.preset=y,N(e,y,b),e.VBR=aa.vbr_off,y}e.preset=y;switch(y){case ia.V9:return F(e,9,b),y;case ia.V8:return F(e,8,b),y;case ia.V7:return F(e,7,b),y;case ia.V6:return F(e,6,b),y;case ia.V5:return F(e,5,b),y;case ia.V4:return F(e,4,b),y;case ia.V3:return F(e,3,b),y;case ia.V2:return F(e,2,b),y;case ia.V1:return F(e,1,b),y;case ia.V0:return F(e,0,b),y}if(8<=y&&320>=y)return N(e,y,b);e.preset=0;return y}}function ra(){function D(p,e,y,b,x,G){for(;0!=x--;)y[b]=1E-10+p[e+0]*G[0]-y[b-1]*G[1]+p[e-1]*G[2]-
y[b-2]*G[3]+p[e-2]*G[4]-y[b-3]*G[5]+p[e-3]*G[6]-y[b-4]*G[7]+p[e-4]*G[8]-y[b-5]*G[9]+p[e-5]*G[10]-y[b-6]*G[11]+p[e-6]*G[12]-y[b-7]*G[13]+p[e-7]*G[14]-y[b-8]*G[15]+p[e-8]*G[16]-y[b-9]*G[17]+p[e-9]*G[18]-y[b-10]*G[19]+p[e-10]*G[20],++b,++e}function B(p,e,y,b,x,G){for(;0!=x--;)y[b]=p[e+0]*G[0]-y[b-1]*G[1]+p[e-1]*G[2]-y[b-2]*G[3]+p[e-2]*G[4],++b,++e}function F(p){return p*p}var N=ra.RMS_WINDOW_TIME_NUMERATOR,O=ra.RMS_WINDOW_TIME_DENOMINATOR,K=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,
-.00123395316851,-11.34170355132042,-9.291677959E-5,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,1.2025322027E-4,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,
-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,
-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-8.28086748E-6,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,
-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],
[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,
.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,
-.02217936801134]],S=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,
.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];this.InitGainAnalysis=function(p,e){a:{for(var y=0;y<MAX_ORDER;y++)p.linprebuf[y]=p.lstepbuf[y]=p.loutbuf[y]=p.rinprebuf[y]=p.rstepbuf[y]=p.routbuf[y]=0;switch(0|e){case 48E3:p.reqindex=0;break;case 44100:p.reqindex=
1;break;case 32E3:p.reqindex=2;break;case 24E3:p.reqindex=3;break;case 22050:p.reqindex=4;break;case 16E3:p.reqindex=5;break;case 12E3:p.reqindex=6;break;case 11025:p.reqindex=7;break;case 8E3:p.reqindex=8;break;default:e=INIT_GAIN_ANALYSIS_ERROR;break a}p.sampleWindow=0|(e*N+O-1)/O;p.lsum=0;p.rsum=0;p.totsamp=0;nb.ill(p.A,0);e=INIT_GAIN_ANALYSIS_OK}if(e!=INIT_GAIN_ANALYSIS_OK)return INIT_GAIN_ANALYSIS_ERROR;p.linpre=MAX_ORDER;p.rinpre=MAX_ORDER;p.lstep=MAX_ORDER;p.rstep=MAX_ORDER;p.lout=MAX_ORDER;
p.rout=MAX_ORDER;nb.fill(p.B,0);return INIT_GAIN_ANALYSIS_OK};this.AnalyzeSamples=function(p,e,y,b,x,G,f){if(0==G)return GAIN_ANALYSIS_OK;var k=0;var c=G;switch(f){case 1:b=e;x=y;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}G<MAX_ORDER?(la.arraycopy(e,y,p.linprebuf,MAX_ORDER,G),la.arraycopy(b,x,p.rinprebuf,MAX_ORDER,G)):(la.arraycopy(e,y,p.linprebuf,MAX_ORDER,MAX_ORDER),la.arraycopy(b,x,p.rinprebuf,MAX_ORDER,MAX_ORDER));for(;0<c;){var m=c>p.sampleWindow-p.totsamp?p.sampleWindow-p.totsamp:
c;if(k<MAX_ORDER){f=p.linpre+k;var t=p.linprebuf;var r=p.rinpre+k;var d=p.rinprebuf;m>MAX_ORDER-k&&(m=MAX_ORDER-k)}else f=y+k,t=e,r=x+k,d=b;D(t,f,p.lstepbuf,p.lstep+p.totsamp,m,K[p.reqindex]);D(d,r,p.rstepbuf,p.rstep+p.totsamp,m,K[p.reqindex]);B(p.lstepbuf,p.lstep+p.totsamp,p.loutbuf,p.lout+p.totsamp,m,S[p.reqindex]);B(p.rstepbuf,p.rstep+p.totsamp,p.routbuf,p.rout+p.totsamp,m,S[p.reqindex]);f=p.lout+p.totsamp;t=p.loutbuf;r=p.rout+p.totsamp;d=p.routbuf;for(var g=m%8;0!=g--;)p.lsum+=F(t[f++]),p.rsum+=
F(d[r++]);for(g=m/8;0!=g--;)p.lsum+=F(t[f+0])+F(t[f+1])+F(t[f+2])+F(t[f+3])+F(t[f+4])+F(t[f+5])+F(t[f+6])+F(t[f+7]),f+=8,p.rsum+=F(d[r+0])+F(d[r+1])+F(d[r+2])+F(d[r+3])+F(d[r+4])+F(d[r+5])+F(d[r+6])+F(d[r+7]),r+=8;c-=m;k+=m;p.totsamp+=m;p.totsamp==p.sampleWindow&&(f=10*ra.STEPS_per_dB*Math.log10((p.lsum+p.rsum)/p.totsamp*.5+1E-37),f=0>=f?0:0|f,f>=p.A.length&&(f=p.A.length-1),p.A[f]++,p.lsum=p.rsum=0,la.arraycopy(p.loutbuf,p.totsamp,p.loutbuf,0,MAX_ORDER),la.arraycopy(p.routbuf,p.totsamp,p.routbuf,
0,MAX_ORDER),la.arraycopy(p.lstepbuf,p.totsamp,p.lstepbuf,0,MAX_ORDER),la.arraycopy(p.rstepbuf,p.totsamp,p.rstepbuf,0,MAX_ORDER),p.totsamp=0);if(p.totsamp>p.sampleWindow)return GAIN_ANALYSIS_ERROR}G<MAX_ORDER?(la.arraycopy(p.linprebuf,G,p.linprebuf,0,MAX_ORDER-G),la.arraycopy(p.rinprebuf,G,p.rinprebuf,0,MAX_ORDER-G),la.arraycopy(e,y,p.linprebuf,MAX_ORDER-G,G),la.arraycopy(b,x,p.rinprebuf,MAX_ORDER-G,G)):(la.arraycopy(e,y+G-MAX_ORDER,p.linprebuf,0,MAX_ORDER),la.arraycopy(b,x+G-MAX_ORDER,p.rinprebuf,
0,MAX_ORDER));return GAIN_ANALYSIS_OK};this.GetTitleGain=function(p){var e=p.A;var y=p.A.length,b,x=0;for(b=0;b<y;b++)x+=e[b];if(0==x)e=GAIN_NOT_ENOUGH_SAMPLES;else{x=0|Math.ceil(x*(1-.95));for(b=y;0<b--&&!(0>=(x-=e[b])););e=64.82-b/ra.STEPS_per_dB}for(y=0;y<p.A.length;y++)p.B[y]+=p.A[y],p.A[y]=0;for(y=0;y<MAX_ORDER;y++)p.linprebuf[y]=p.lstepbuf[y]=p.loutbuf[y]=p.rinprebuf[y]=p.rstepbuf[y]=p.routbuf[y]=0;p.totsamp=0;p.lsum=p.rsum=0;return e}}function zc(){function D(t){this.bits=0|t}function B(t,
r,d,g,h,q){r=.5946/r;for(t>>=1;0!=t--;)h[q++]=r>d[g++]?0:1,h[q++]=r>d[g++]?0:1}function F(t,r,d,g,h,q){t>>=1;var a=t%2;for(t>>=1;0!=t--;){var l=d[g++]*r;var n=d[g++]*r;var u=0|l;var A=d[g++]*r;var L=0|n;var I=d[g++]*r;var P=0|A;l+=K.adj43[u];u=0|I;n+=K.adj43[L];h[q++]=0|l;A+=K.adj43[P];h[q++]=0|n;I+=K.adj43[u];h[q++]=0|A;h[q++]=0|I}0!=a&&(l=d[g++]*r,n=d[g++]*r,l+=K.adj43[0|l],n+=K.adj43[0|n],h[q++]=0|l,h[q++]=0|n)}function N(t,r,d,g){var h,q=r,a=h=0;do{var l=t[q++],n=t[q++];h<l&&(h=l);a<n&&(a=n)}while(q<
d);h<a&&(h=a);switch(h){case 0:return h;case 1:q=r;r=0;h=R.ht[1].hlen;do a=2*t[q+0]+t[q+1],q+=2,r+=h[a];while(q<d);g.bits+=r;return 1;case 2:case 3:q=r;r=p[h-1];h=0;a=R.ht[r].xlen;l=2==r?R.table23:R.table56;do n=t[q+0]*a+t[q+1],q+=2,h+=l[n];while(q<d);t=h&65535;h>>=16;h>t&&(h=t,r++);g.bits+=h;return r;case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:q=r;r=p[h-1];l=a=h=0;n=R.ht[r].xlen;var u=R.ht[r].hlen,A=R.ht[r+1].hlen,L=R.ht[r+2].hlen;do{var I=t[q+0]*n+t[q+
1];q+=2;h+=u[I];a+=A[I];l+=L[I]}while(q<d);t=r;h>a&&(h=a,t++);h>l&&(h=l,t=r+2);g.bits+=h;return t;default:if(h>fb.IXMAX_VAL)return g.bits=fb.LARGE_BITS,-1;h-=15;for(q=24;32>q&&!(R.ht[q].linmax>=h);q++);for(a=q-8;24>a&&!(R.ht[a].linmax>=h);a++);h=a;l=65536*R.ht[h].xlen+R.ht[q].xlen;a=0;do n=t[r++],u=t[r++],0!=n&&(14<n&&(n=15,a+=l),n*=16),0!=u&&(14<u&&(u=15,a+=l),n+=u),a+=R.largetbl[n];while(r<d);t=a&65535;a>>=16;a>t&&(a=t,h=q);g.bits+=a;return h}}function O(t,r,d,g,h,q,a,l){for(var n=r.big_values,
u=2;u<v.SBMAX_l+1;u++){var A=t.scalefac_band.l[u];if(A>=n)break;var L=h[u-2]+r.count1bits;if(d.part2_3_length<=L)break;L=new D(L);A=N(g,A,n,L);L=L.bits;d.part2_3_length<=L||(d.assign(r),d.part2_3_length=L,d.region0_count=q[u-2],d.region1_count=u-2-q[u-2],d.table_select[0]=a[u-2],d.table_select[1]=l[u-2],d.table_select[2]=A)}}var K=null;this.qupvt=null;this.setModules=function(t){K=this.qupvt=t};var S=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],
[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]],p=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];this.noquant_count_bits=function(t,r,d){var g=r.l3_enc,h=Math.min(576,r.max_nonzero_coeff+2>>1<<1);null!=d&&(d.sfb_count1=0);for(;1<h&&0==(g[h-1]|g[h-2]);h-=2);r.count1=h;for(var q=0,a=0;3<h&&!(1<((g[h-1]|g[h-2]|g[h-3]|g[h-4])&2147483647));h-=4){var l=2*(2*(2*g[h-4]+g[h-3])+g[h-2])+g[h-1];q+=R.t32l[l];a+=R.t33l[l]}l=q;r.count1table_select=0;q>a&&(l=a,r.count1table_select=1);r.count1bits=l;r.big_values=h;if(0==h)return l;
r.block_type==v.SHORT_TYPE?(q=3*t.scalefac_band.s[3],q>r.big_values&&(q=r.big_values),a=r.big_values):r.block_type==v.NORM_TYPE?(q=r.region0_count=t.bv_scf[h-2],a=r.region1_count=t.bv_scf[h-1],a=t.scalefac_band.l[q+a+2],q=t.scalefac_band.l[q+1],a<h&&(l=new D(l),r.table_select[2]=N(g,a,h,l),l=l.bits)):(r.region0_count=7,r.region1_count=v.SBMAX_l-1-7-1,q=t.scalefac_band.l[8],a=h,q>a&&(q=a));q=Math.min(q,h);a=Math.min(a,h);0<q&&(l=new D(l),r.table_select[0]=N(g,0,q,l),l=l.bits);q<a&&(l=new D(l),r.table_select[1]=
N(g,q,a,l),l=l.bits);2==t.use_best_huffman&&(r.part2_3_length=l,best_huffman_divide(t,r),l=r.part2_3_length);if(null!=d&&r.block_type==v.NORM_TYPE){for(g=0;t.scalefac_band.l[g]<r.big_values;)g++;d.sfb_count1=g}return l};this.count_bits=function(t,r,d,g){var h=d.l3_enc,q=fb.IXMAX_VAL/K.IPOW20(d.global_gain);if(d.xrpow_max>q)return fb.LARGE_BITS;q=K.IPOW20(d.global_gain);var a,l=0,n=0,u=0,A=0,L=0,I=h,P=0,w=r,z=0;var C=null!=g&&d.global_gain==g.global_gain;var E=d.block_type==v.SHORT_TYPE?38:21;for(a=
0;a<=E;a++){var Q=-1;if(C||d.block_type==v.NORM_TYPE)Q=d.global_gain-(d.scalefac[a]+(0!=d.preflag?K.pretab[a]:0)<<d.scalefac_scale+1)-8*d.subblock_gain[d.window[a]];if(C&&g.step[a]==Q)0!=n&&(F(n,q,w,z,I,P),n=0),0!=u&&(B(u,q,w,z,I,P),u=0);else{var H=d.width[a];l+d.width[a]>d.max_nonzero_coeff&&(a=d.max_nonzero_coeff-l+1,nb.fill(h,d.max_nonzero_coeff,576,0),H=a,0>H&&(H=0),a=E+1);0==n&&0==u&&(I=h,P=L,w=r,z=A);null!=g&&0<g.sfb_count1&&a>=g.sfb_count1&&0<g.step[a]&&Q>=g.step[a]?(0!=n&&(F(n,q,w,z,I,P),
n=0,I=h,P=L,w=r,z=A),u+=H):(0!=u&&(B(u,q,w,z,I,P),u=0,I=h,P=L,w=r,z=A),n+=H);if(0>=H){0!=u&&(B(u,q,w,z,I,P),u=0);0!=n&&(F(n,q,w,z,I,P),n=0);break}}a<=E&&(L+=d.width[a],A+=d.width[a],l+=d.width[a])}0!=n&&F(n,q,w,z,I,P);0!=u&&B(u,q,w,z,I,P);if(0!=(t.substep_shaping&2))for(q=0,E=.634521682242439/K.IPOW20(d.global_gain+d.scalefac_scale),l=0;l<d.sfbmax;l++)if(C=d.width[l],0==t.pseudohalf[l])q+=C;else for(n=q,q+=C;n<q;++n)h[n]=r[n]>=E?h[n]:0;return this.noquant_count_bits(t,d,g)};this.best_huffman_divide=
function(t,r){var d=new Lc,g=r.l3_enc,h=ka(23),q=ka(23),a=ka(23),l=ka(23);if(r.block_type!=v.SHORT_TYPE||1!=t.mode_gr){d.assign(r);if(r.block_type==v.NORM_TYPE){for(var n=r.big_values,u=0;22>=u;u++)h[u]=fb.LARGE_BITS;for(u=0;16>u;u++){var A=t.scalefac_band.l[u+1];if(A>=n)break;var L=0,I=new D(L),P=N(g,0,A,I);L=I.bits;for(var w=0;8>w;w++){var z=t.scalefac_band.l[u+w+2];if(z>=n)break;I=L;I=new D(I);z=N(g,A,z,I);I=I.bits;h[u+w]>I&&(h[u+w]=I,q[u+w]=u,a[u+w]=P,l[u+w]=z)}}O(t,d,r,g,h,q,a,l)}n=d.big_values;
if(!(0==n||1<(g[n-2]|g[n-1])||(n=r.count1+2,576<n))){d.assign(r);d.count1=n;for(A=u=0;n>d.big_values;n-=4)L=2*(2*(2*g[n-4]+g[n-3])+g[n-2])+g[n-1],u+=R.t32l[L],A+=R.t33l[L];d.big_values=n;d.count1table_select=0;u>A&&(u=A,d.count1table_select=1);d.count1bits=u;d.block_type==v.NORM_TYPE?O(t,d,r,g,h,q,a,l):(d.part2_3_length=u,u=t.scalefac_band.l[8],u>n&&(u=n),0<u&&(t=new D(d.part2_3_length),d.table_select[0]=N(g,0,u,t),d.part2_3_length=t.bits),n>u&&(t=new D(d.part2_3_length),d.table_select[1]=N(g,u,n,
t),d.part2_3_length=t.bits),r.part2_3_length>d.part2_3_length&&r.assign(d))}}};var e=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],y=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],b=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],x=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];zc.slen1_tab=b;zc.slen2_tab=x;this.best_scalefac_store=function(t,r,d,g){var h=g.tt[r][d],q,a,l=0;for(q=a=0;q<h.sfbmax;q++){var n=h.width[q];a+=n;for(n=-n;0>n&&0==h.l3_enc[n+a];n++);0==n&&(h.scalefac[q]=l=-2)}if(0==h.scalefac_scale&&0==h.preflag){for(q=a=0;q<h.sfbmax;q++)0<
h.scalefac[q]&&(a|=h.scalefac[q]);if(0==(a&1)&&0!=a){for(q=0;q<h.sfbmax;q++)0<h.scalefac[q]&&(h.scalefac[q]>>=1);h.scalefac_scale=l=1}}if(0==h.preflag&&h.block_type!=v.SHORT_TYPE&&2==t.mode_gr){for(q=11;q<v.SBPSY_l&&!(h.scalefac[q]<K.pretab[q]&&-2!=h.scalefac[q]);q++);if(q==v.SBPSY_l){for(q=11;q<v.SBPSY_l;q++)0<h.scalefac[q]&&(h.scalefac[q]-=K.pretab[q]);h.preflag=l=1}}for(q=0;4>q;q++)g.scfsi[d][q]=0;if(2==t.mode_gr&&1==r&&g.tt[0][d].block_type!=v.SHORT_TYPE&&g.tt[1][d].block_type!=v.SHORT_TYPE){r=
g.tt[1][d];a=g.tt[0][d];for(l=0;l<R.scfsi_band.length-1;l++){for(q=R.scfsi_band[l];q<R.scfsi_band[l+1]&&!(a.scalefac[q]!=r.scalefac[q]&&0<=r.scalefac[q]);q++);if(q==R.scfsi_band[l+1]){for(q=R.scfsi_band[l];q<R.scfsi_band[l+1];q++)r.scalefac[q]=-1;g.scfsi[d][l]=1}}for(q=g=d=0;11>q;q++)-1!=r.scalefac[q]&&(g++,d<r.scalefac[q]&&(d=r.scalefac[q]));for(n=a=0;q<v.SBPSY_l;q++)-1!=r.scalefac[q]&&(n++,a<r.scalefac[q]&&(a=r.scalefac[q]));for(l=0;16>l;l++)d<e[l]&&a<y[l]&&(q=b[l]*g+x[l]*n,r.part2_length>q&&(r.part2_length=
q,r.scalefac_compress=l));l=0}for(q=0;q<h.sfbmax;q++)-2==h.scalefac[q]&&(h.scalefac[q]=0);0!=l&&(2==t.mode_gr?this.scale_bitcount(h):this.scale_bitcount_lsf(t,h))};var G=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],f=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],k=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var r,d=0,g=0,h=t.scalefac;if(t.block_type==v.SHORT_TYPE){var q=G;0!=t.mixed_block_flag&&(q=f)}else if(q=k,0==t.preflag){for(r=11;r<v.SBPSY_l&&
!(h[r]<K.pretab[r]);r++);if(r==v.SBPSY_l)for(t.preflag=1,r=11;r<v.SBPSY_l;r++)h[r]-=K.pretab[r]}for(r=0;r<t.sfbdivide;r++)d<h[r]&&(d=h[r]);for(;r<t.sfbmax;r++)g<h[r]&&(g=h[r]);t.part2_length=fb.LARGE_BITS;for(r=0;16>r;r++)d<e[r]&&g<y[r]&&t.part2_length>q[r]&&(t.part2_length=q[r],t.scalefac_compress=r);return t.part2_length==fb.LARGE_BITS};var c=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,r){var d,g,h,q,a=ka(4),l=r.scalefac;t=0!=r.preflag?
2:0;for(h=0;4>h;h++)a[h]=0;if(r.block_type==v.SHORT_TYPE){var n=1;var u=K.nr_of_sfb_block[t][n];for(d=q=0;4>d;d++){var A=u[d]/3;for(h=0;h<A;h++,q++)for(g=0;3>g;g++)l[3*q+g]>a[d]&&(a[d]=l[3*q+g])}}else for(n=0,u=K.nr_of_sfb_block[t][n],d=q=0;4>d;d++)for(A=u[d],h=0;h<A;h++,q++)l[q]>a[d]&&(a[d]=l[q]);A=!1;for(d=0;4>d;d++)a[d]>c[t][d]&&(A=!0);if(!A){r.sfb_partition_table=K.nr_of_sfb_block[t][n];for(d=0;4>d;d++)r.slen[d]=m[a[d]];n=r.slen[0];d=r.slen[1];a=r.slen[2];g=r.slen[3];switch(t){case 0:r.scalefac_compress=
(5*n+d<<4)+(a<<2)+g;break;case 1:r.scalefac_compress=400+(5*n+d<<2)+a;break;case 2:r.scalefac_compress=500+3*n+d;break;default:la.err.printf("intensity stereo not implemented yet\n")}}if(!A)for(d=r.part2_length=0;4>d;d++)r.part2_length+=r.slen[d]*r.sfb_partition_table[d];return A};var m=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(t){for(var r=2;576>=r;r+=2){for(var d=0,g;t.scalefac_band.l[++d]<r;);for(g=S[d][0];t.scalefac_band.l[g+1]>r;)g--;0>g&&(g=S[d][0]);t.bv_scf[r-2]=g;for(g=
S[d][1];t.scalefac_band.l[g+t.bv_scf[r-2]+2]>r;)g--;0>g&&(g=S[d][1]);t.bv_scf[r-1]=g}}}function ld(){var D;this.setModules=function(B){D=B};this.ResvFrameBegin=function(B,F){var N=B.internal_flags,O=N.l3_side,K=D.getframebits(B);F.bits=(K-8*N.sideinfo_len)/N.mode_gr;var S=2048*N.mode_gr-8;if(320<B.brate)var p=8*int(1E3*B.brate/(B.out_samplerate/1152)/8+.5);else p=11520,B.strict_ISO&&(p=8*int(32E4/(B.out_samplerate/1152)/8+.5));N.ResvMax=p-K;N.ResvMax>S&&(N.ResvMax=S);if(0>N.ResvMax||B.disable_reservoir)N.ResvMax=
0;B=F.bits*N.mode_gr+Math.min(N.ResvSize,N.ResvMax);B>p&&(B=p);O.resvDrain_pre=0;null!=N.pinfo&&(N.pinfo.mean_bits=F.bits/2,N.pinfo.resvsize=N.ResvSize);return B};this.ResvMaxBits=function(B,F,N,O){var K=B.internal_flags,S=K.ResvSize,p=K.ResvMax;0!=O&&(S+=F);0!=(K.substep_shaping&1)&&(p*=.9);N.bits=F;10*S>9*p?(O=S-9*p/10,N.bits+=O,K.substep_shaping|=128):(O=0,K.substep_shaping&=127,B.disable_reservoir||0!=(K.substep_shaping&1)||(N.bits-=.1*F));B=S<6*K.ResvMax/10?S:6*K.ResvMax/10;B-=O;0>B&&(B=0);return B};
this.ResvAdjust=function(B,F){B.ResvSize-=F.part2_3_length+F.part2_length};this.ResvFrameEnd=function(B,F){var N,O=B.l3_side;B.ResvSize+=F*B.mode_gr;F=0;O.resvDrain_post=0;O.resvDrain_pre=0;0!=(N=B.ResvSize%8)&&(F+=N);N=B.ResvSize-F-B.ResvMax;0<N&&(F+=N);N=Math.min(8*O.main_data_begin,F)/8;O.resvDrain_pre+=8*N;F-=8*N;B.ResvSize-=8*N;O.main_data_begin-=N;O.resvDrain_post+=F;B.ResvSize-=F}}function Wa(){function D(d,g,h){for(;0<h;){if(0==r){r=8;t++;if(d.header[d.w_ptr].write_timing==m){var q=d;la.arraycopy(q.header[q.w_ptr].buf,
0,c,t,q.sideinfo_len);t+=q.sideinfo_len;m+=8*q.sideinfo_len;q.w_ptr=q.w_ptr+1&Ba.MAX_HEADER_BUF-1}c[t]=0}q=Math.min(h,r);h-=q;r-=q;c[t]|=g>>h<<r;m+=q}}function B(d,g){var h=d.internal_flags,q;8<=g&&(D(h,76,8),g-=8);8<=g&&(D(h,65,8),g-=8);8<=g&&(D(h,77,8),g-=8);8<=g&&(D(h,69,8),g-=8);if(32<=g){var a=f.getLameShortVersion();if(32<=g)for(q=0;q<a.length&&8<=g;++q)g-=8,D(h,a.charAt(q),8)}for(;1<=g;--g)D(h,h.ancillary_flag,1),h.ancillary_flag^=d.disable_reservoir?0:1}function F(d,g,h){for(var q=d.header[d.h_ptr].ptr;0<
h;){var a=Math.min(h,8-(q&7));h-=a;d.header[d.h_ptr].buf[q>>3]|=g>>h<<8-(q&7)-a;q+=a}d.header[d.h_ptr].ptr=q}function N(d,g){d<<=8;for(var h=0;8>h;h++)d<<=1,g<<=1,0!=((g^d)&65536)&&(g^=32773);return g}function O(d,g){var h=R.ht[g.count1table_select+32],q,a=0,l=g.big_values,n=g.big_values;for(q=(g.count1-g.big_values)/4;0<q;--q){var u=0,A=0;var L=g.l3_enc[l+0];0!=L&&(A+=8,0>g.xr[n+0]&&u++);L=g.l3_enc[l+1];0!=L&&(A+=4,u*=2,0>g.xr[n+1]&&u++);L=g.l3_enc[l+2];0!=L&&(A+=2,u*=2,0>g.xr[n+2]&&u++);L=g.l3_enc[l+
3];0!=L&&(A++,u*=2,0>g.xr[n+3]&&u++);l+=4;n+=4;D(d,u+h.table[A],h.hlen[A]);a+=h.hlen[A]}return a}function K(d,g,h,q,a){var l=R.ht[g],n=0;if(0==g)return n;for(;h<q;h+=2){var u=0,A=0,L=l.xlen,I=l.xlen,P=0,w=a.l3_enc[h],z=a.l3_enc[h+1];0!=w&&(0>a.xr[h]&&P++,u--);15<g&&(14<w&&(P|=w-15<<1,A=L,w=15),14<z&&(I=z-15,P<<=L,P|=I,A+=L,z=15),I=16);0!=z&&(P<<=1,0>a.xr[h+1]&&P++,u--);w=w*I+z;A-=u;u+=l.hlen[w];D(d,l.table[w],u);D(d,P,A);n+=u+A}return n}function S(d,g){var h=3*d.scalefac_band.s[3];h>g.big_values&&
(h=g.big_values);var q=K(d,g.table_select[0],0,h,g);return q+=K(d,g.table_select[1],h,g.big_values,g)}function p(d,g){var h=g.big_values;var q=g.region0_count+1;var a=d.scalefac_band.l[q];q+=g.region1_count+1;var l=d.scalefac_band.l[q];a>h&&(a=h);l>h&&(l=h);q=K(d,g.table_select[0],0,a,g);q+=K(d,g.table_select[1],a,l,g);return q+=K(d,g.table_select[2],l,h,g)}function e(){this.total=0}function y(d,g){var h=d.internal_flags;var q=h.w_ptr;var a=h.h_ptr-1;-1==a&&(a=Ba.MAX_HEADER_BUF-1);var l=h.header[a].write_timing-
m;g.total=l;if(0<=l){var n=1+a-q;a<q&&(n=1+a-q+Ba.MAX_HEADER_BUF);l-=8*n*h.sideinfo_len}d=b.getframebits(d);l+=d;g.total+=d;g.total=0!=g.total%8?1+g.total/8:g.total/8;g.total+=t+1;0>l&&la.err.println("strange error flushing buffer ... \n");return l}var b=this,x=null,G=null,f=null,k=null;this.setModules=function(d,g,h,q){x=d;G=g;f=h;k=q};var c=null,m=0,t=0,r=0;this.getframebits=function(d){var g=d.internal_flags;return 8*(0|72E3*(d.version+1)*(0!=g.bitrate_index?R.bitrate_table[d.version][g.bitrate_index]:
d.brate)/d.out_samplerate+g.padding)};this.CRC_writeheader=function(d,g){var h=N(g[2]&255,65535);h=N(g[3]&255,h);for(var q=6;q<d.sideinfo_len;q++)h=N(g[q]&255,h);g[4]=byte(h>>8);g[5]=byte(h&255)};this.flush_bitstream=function(d){var g=d.internal_flags,h;var q=g.l3_side;0>(h=y(d,new e))||(B(d,h),g.ResvSize=0,q.main_data_begin=0,g.findReplayGain&&(q=x.GetTitleGain(g.rgdata),g.RadioGain=Math.floor(10*q+.5)|0),g.findPeakSample&&(g.noclipGainChange=Math.ceil(200*Math.log10(g.PeakSample/32767))|0,0<g.noclipGainChange?
EQ(d.scale,1)||EQ(d.scale,0)?g.noclipScale=Math.floor(32767/g.PeakSample*100)/100:g.noclipScale=-1:g.noclipScale=-1))};this.add_dummy_byte=function(d,g,h){d=d.internal_flags;for(var q;0<h--;){q=g;for(var a=8;0<a;){0==r&&(r=8,t++,c[t]=0);var l=Math.min(a,r);a-=l;r-=l;c[t]|=q>>a<<r;m+=l}for(q=0;q<Ba.MAX_HEADER_BUF;++q)d.header[q].write_timing+=8}};this.format_bitstream=function(d){var g=d.internal_flags;var h=g.l3_side;var q=this.getframebits(d);B(d,h.resvDrain_pre);var a=d.internal_flags,l,n;var u=
a.l3_side;a.header[a.h_ptr].ptr=0;nb.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0);16E3>d.out_samplerate?F(a,4094,12):F(a,4095,12);F(a,d.version,1);F(a,1,2);F(a,d.error_protection?0:1,1);F(a,a.bitrate_index,4);F(a,a.samplerate_index,2);F(a,a.padding,1);F(a,d.extension,1);F(a,d.mode.ordinal(),2);F(a,a.mode_ext,2);F(a,d.copyright,1);F(a,d.original,1);F(a,d.emphasis,2);d.error_protection&&F(a,0,16);if(1==d.version){F(a,u.main_data_begin,9);2==a.channels_out?F(a,u.private_bits,3):F(a,u.private_bits,
5);for(n=0;n<a.channels_out;n++)for(l=0;4>l;l++)F(a,u.scfsi[n][l],1);for(l=0;2>l;l++)for(n=0;n<a.channels_out;n++){var A=u.tt[l][n];F(a,A.part2_3_length+A.part2_length,12);F(a,A.big_values/2,9);F(a,A.global_gain,8);F(a,A.scalefac_compress,4);A.block_type!=v.NORM_TYPE?(F(a,1,1),F(a,A.block_type,2),F(a,A.mixed_block_flag,1),14==A.table_select[0]&&(A.table_select[0]=16),F(a,A.table_select[0],5),14==A.table_select[1]&&(A.table_select[1]=16),F(a,A.table_select[1],5),F(a,A.subblock_gain[0],3),F(a,A.subblock_gain[1],
3),F(a,A.subblock_gain[2],3)):(F(a,0,1),14==A.table_select[0]&&(A.table_select[0]=16),F(a,A.table_select[0],5),14==A.table_select[1]&&(A.table_select[1]=16),F(a,A.table_select[1],5),14==A.table_select[2]&&(A.table_select[2]=16),F(a,A.table_select[2],5),F(a,A.region0_count,4),F(a,A.region1_count,3));F(a,A.preflag,1);F(a,A.scalefac_scale,1);F(a,A.count1table_select,1)}}else for(F(a,u.main_data_begin,8),F(a,u.private_bits,a.channels_out),n=l=0;n<a.channels_out;n++)A=u.tt[l][n],F(a,A.part2_3_length+A.part2_length,
12),F(a,A.big_values/2,9),F(a,A.global_gain,8),F(a,A.scalefac_compress,9),A.block_type!=v.NORM_TYPE?(F(a,1,1),F(a,A.block_type,2),F(a,A.mixed_block_flag,1),14==A.table_select[0]&&(A.table_select[0]=16),F(a,A.table_select[0],5),14==A.table_select[1]&&(A.table_select[1]=16),F(a,A.table_select[1],5),F(a,A.subblock_gain[0],3),F(a,A.subblock_gain[1],3),F(a,A.subblock_gain[2],3)):(F(a,0,1),14==A.table_select[0]&&(A.table_select[0]=16),F(a,A.table_select[0],5),14==A.table_select[1]&&(A.table_select[1]=16),
F(a,A.table_select[1],5),14==A.table_select[2]&&(A.table_select[2]=16),F(a,A.table_select[2],5),F(a,A.region0_count,4),F(a,A.region1_count,3)),F(a,A.scalefac_scale,1),F(a,A.count1table_select,1);d.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);u=a.h_ptr;a.h_ptr=u+1&Ba.MAX_HEADER_BUF-1;a.header[a.h_ptr].write_timing=a.header[u].write_timing+q;a.h_ptr==a.w_ptr&&la.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n");a=8*g.sideinfo_len;var L=0,I=d.internal_flags,P=I.l3_side;if(1==
d.version)for(u=0;2>u;u++)for(n=0;n<I.channels_out;n++){var w=P.tt[u][n],z=zc.slen1_tab[w.scalefac_compress],C=zc.slen2_tab[w.scalefac_compress];for(l=A=0;l<w.sfbdivide;l++)-1!=w.scalefac[l]&&(D(I,w.scalefac[l],z),A+=z);for(;l<w.sfbmax;l++)-1!=w.scalefac[l]&&(D(I,w.scalefac[l],C),A+=C);A=w.block_type==v.SHORT_TYPE?A+S(I,w):A+p(I,w);A+=O(I,w);L+=A}else for(n=u=0;n<I.channels_out;n++){w=P.tt[u][n];var E=0;C=l=A=0;if(w.block_type==v.SHORT_TYPE){for(;4>C;C++){var Q=w.sfb_partition_table[C]/3,H=w.slen[C];
for(z=0;z<Q;z++,l++)D(I,Math.max(w.scalefac[3*l],0),H),D(I,Math.max(w.scalefac[3*l+1],0),H),D(I,Math.max(w.scalefac[3*l+2],0),H),E+=3*H}A+=S(I,w)}else{for(;4>C;C++)for(Q=w.sfb_partition_table[C],H=w.slen[C],z=0;z<Q;z++,l++)D(I,Math.max(w.scalefac[l],0),H),E+=H;A+=p(I,w)}A+=O(I,w);L+=E+A}a+=L;B(d,h.resvDrain_post);a+=h.resvDrain_post;h.main_data_begin+=(q-a)/8;y(d,new e)!=g.ResvSize&&la.err.println("Internal buffer inconsistency. flushbits <> ResvSize");8*h.main_data_begin!=g.ResvSize&&(la.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",
8*h.main_data_begin,g.ResvSize,h.resvDrain_post,h.resvDrain_pre,8*g.sideinfo_len,a-h.resvDrain_post-8*g.sideinfo_len,a,a%8,q),la.err.println("This is a fatal error.  It has several possible causes:"),la.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),la.err.println(" 9%%  Your system is overclocked"),la.err.println(" 1%%  bug in LAME encoding library"),g.ResvSize=8*h.main_data_begin);if(1E9<m){for(d=0;d<Ba.MAX_HEADER_BUF;++d)g.header[d].write_timing-=m;m=
0}return 0};this.copy_buffer=function(d,g,h,q,a){var l=t+1;if(0>=l)return 0;if(0!=q&&l>q)return-1;la.arraycopy(c,0,g,h,l);t=-1;r=0;if(0!=a&&(q=ka(1),q[0]=d.nMusicCRC,k.updateMusicCRC(q,g,h,l),d.nMusicCRC=q[0],0<l&&(d.VBR_seek_table.nBytesWritten+=l),d.decode_on_the_fly)){q=Ja([2,1152]);a=l;for(var n=-1,u;0!=n;)if(n=G.hip_decode1_unclipped(d.hip,g,h,a,q[0],q[1]),a=0,-1==n&&(n=0),0<n){if(d.findPeakSample){for(u=0;u<n;u++)q[0][u]>d.PeakSample?d.PeakSample=q[0][u]:-q[0][u]>d.PeakSample&&(d.PeakSample=
-q[0][u]);if(1<d.channels_out)for(u=0;u<n;u++)q[1][u]>d.PeakSample?d.PeakSample=q[1][u]:-q[1][u]>d.PeakSample&&(d.PeakSample=-q[1][u])}if(d.findReplayGain&&x.AnalyzeSamples(d.rgdata,q[0],0,q[1],0,n,d.channels_out)==ra.GAIN_ANALYSIS_ERROR)return-6}}return l};this.init_bit_stream_w=function(d){c=new Int8Array(ia.LAME_MAXMP3BUFFER);d.h_ptr=d.w_ptr=0;d.header[d.h_ptr].write_timing=0;t=-1;m=r=0}}function Ac(){function D(f,k){var c=f[k+0]&255;c=c<<8|f[k+1]&255;c=c<<8|f[k+2]&255;return c=c<<8|f[k+3]&255}
function B(f,k,c){f[k+0]=c>>24&255;f[k+1]=c>>16&255;f[k+2]=c>>8&255;f[k+3]=c&255}function F(f,k,c){f[k+0]=c>>8&255;f[k+1]=c&255}function N(f,k,c){return 255&(f<<k|c&~(-1<<k))}function O(f,k){var c=f.internal_flags;k[0]=N(k[0],8,255);k[1]=N(k[1],3,7);k[1]=N(k[1],1,16E3>f.out_samplerate?0:1);k[1]=N(k[1],1,f.version);k[1]=N(k[1],2,1);k[1]=N(k[1],1,f.error_protection?0:1);k[2]=N(k[2],4,c.bitrate_index);k[2]=N(k[2],2,c.samplerate_index);k[2]=N(k[2],1,0);k[2]=N(k[2],1,f.extension);k[3]=N(k[3],2,f.mode.ordinal());
k[3]=N(k[3],2,c.mode_ext);k[3]=N(k[3],1,f.copyright);k[3]=N(k[3],1,f.original);k[3]=N(k[3],2,f.emphasis);k[0]=255;c=k[1]&241;var m=1==f.version?128:16E3>f.out_samplerate?32:64;f.VBR==aa.vbr_off&&(m=f.brate);m=f.free_format?0:255&16*S.BitrateIndex(m,f.version,f.out_samplerate);k[1]=1==f.version?255&(c|10):255&(c|2);c=k[2]&13;k[2]=255&(m|c)}function K(f,k){return k=k>>8^G[(k^f)&255]}var S,p,e;this.setModules=function(f,k,c){S=f;p=k;e=c};var y=Ac.NUMTOCENTRIES,b=Ac.MAXFRAMESIZE,x=y+4+4+4+4+4+9+1+1+8+
1+1+3+1+1+2+4+2+2,G=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8E3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16E3,
65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,
32E3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];
this.addVbrFrame=function(f){var k=f.internal_flags;var c=k.VBR_seek_table;f=R.bitrate_table[f.version][k.bitrate_index];c.nVbrNumFrames++;c.sum+=f;c.seen++;if(!(c.seen<c.want)&&(c.pos<c.size&&(c.bag[c.pos]=c.sum,c.pos++,c.seen=0),c.pos==c.size)){for(f=1;f<c.size;f+=2)c.bag[f/2]=c.bag[f];c.want*=2;c.pos/=2}};this.getVbrTag=function(f){var k=new VBRTagData,c=0;k.flags=0;var m=f[c+1]>>3&1,t=f[c+2]>>2&3,r=f[c+3]>>6&3,d=f[c+2]>>4&15;d=R.bitrate_table[m][d];k.samprate=14==f[c+1]>>4?R.samplerate_table[2][t]:
R.samplerate_table[m][t];t=c=0!=m?3!=r?c+36:c+21:3!=r?c+21:c+13;if(!(new String(f,t,4(),null)).equals("Xing")&&!(new String(f,t,4(),null)).equals("Info"))return null;c+=4;k.hId=m;t=k.flags=D(f,c);c+=4;0!=(t&1)&&(k.frames=D(f,c),c+=4);0!=(t&2)&&(k.bytes=D(f,c),c+=4);if(0!=(t&4)){if(null!=k.toc)for(r=0;r<y;r++)k.toc[r]=f[c+r];c+=y}k.vbrScale=-1;0!=(t&8)&&(k.vbrScale=D(f,c),c+=4);k.headersize=72E3*(m+1)*d/k.samprate;c+=21;m=f[c+0]<<4;m+=f[c+1]>>4;d=(f[c+1]&15)<<8;d+=f[c+2]&255;if(0>m||3E3<m)m=-1;if(0>
d||3E3<d)d=-1;k.encDelay=m;k.encPadding=d;return k};this.InitVbrTag=function(f){var k=f.internal_flags;var c=1==f.version?128:16E3>f.out_samplerate?32:64;f.VBR==aa.vbr_off&&(c=f.brate);c=72E3*(f.version+1)*c/f.out_samplerate;var m=k.sideinfo_len+x;k.VBR_seek_table.TotalFrameSize=c;if(c<m||c>b)f.bWriteVbrTag=!1;else for(k.VBR_seek_table.nVbrNumFrames=0,k.VBR_seek_table.nBytesWritten=0,k.VBR_seek_table.sum=0,k.VBR_seek_table.seen=0,k.VBR_seek_table.want=1,k.VBR_seek_table.pos=0,null==k.VBR_seek_table.bag&&
(k.VBR_seek_table.bag=new int[400],k.VBR_seek_table.size=400),c=new Int8Array(b),O(f,c),k=k.VBR_seek_table.TotalFrameSize,m=0;m<k;++m)p.add_dummy_byte(f,c[m]&255,1)};this.updateMusicCRC=function(f,k,c,m){for(var t=0;t<m;++t)f[0]=K(k[c+t],f[0])};this.getLameTagFrame=function(f,k){var c=f.internal_flags;if(!f.bWriteVbrTag||c.Class_ID!=ia.LAME_ID||0>=c.VBR_seek_table.pos)return 0;if(k.length<c.VBR_seek_table.TotalFrameSize)return c.VBR_seek_table.TotalFrameSize;nb.fill(k,0,c.VBR_seek_table.TotalFrameSize,
0);O(f,k);var m=new Int8Array(y);if(f.free_format)for(var t=1;t<y;++t)m[t]=255&255*t/100;else{var r=c.VBR_seek_table;if(!(0>=r.pos))for(t=1;t<y;++t){var d=0|Math.floor(t/y*r.pos);d>r.pos-1&&(d=r.pos-1);d=0|256*r.bag[d]/r.sum;255<d&&(d=255);m[t]=255&d}}d=c.sideinfo_len;f.error_protection&&(d-=2);k[d++]=0;k[d++]=0;k[d++]=0;k[d++]=0;B(k,d,15);d+=4;B(k,d,c.VBR_seek_table.nVbrNumFrames);d+=4;r=c.VBR_seek_table.nBytesWritten+c.VBR_seek_table.TotalFrameSize;B(k,d,0|r);d+=4;la.arraycopy(m,0,k,d,m.length);
d+=m.length;f.error_protection&&p.CRC_writeheader(c,k);var g=0;for(t=0;t<d;t++)g=K(k[t],g);m=d;t=g;var h=f.internal_flags;d=0;g=f.encoder_delay;var q=f.encoder_padding,a=100-10*f.VBR_q-f.quality,l=e.getLameVeryShortVersion();var n=[1,5,3,2,4,0,3];var u=0|(255<f.lowpassfreq/100+.5?255:f.lowpassfreq/100+.5),A=0,L=0,I=f.internal_flags.noise_shaping,P=0,w,z=0!=(f.exp_nspsytune&1);var C=0!=(f.exp_nspsytune&2);var E=w=!1,Q=f.internal_flags.nogap_total,H=f.internal_flags.nogap_current,M=f.ATHtype;switch(f.VBR){case vbr_abr:var ca=
f.VBR_mean_bitrate_kbps;break;case vbr_off:ca=f.brate;break;default:ca=f.VBR_min_bitrate_kbps}n=0+(f.VBR.ordinal()<n.length?n[f.VBR.ordinal()]:0);h.findReplayGain&&(510<h.RadioGain&&(h.RadioGain=510),-510>h.RadioGain&&(h.RadioGain=-510),L=11264,L=0<=h.RadioGain?L|h.RadioGain:L|512|-h.RadioGain);h.findPeakSample&&(A=Math.abs(0|h.PeakSample/32767*Math.pow(2,23)+.5));-1!=Q&&(0<H&&(E=!0),H<Q-1&&(w=!0));z=M+((z?1:0)<<4)+((C?1:0)<<5)+((w?1:0)<<6)+((E?1:0)<<7);0>a&&(a=0);switch(f.mode){case MONO:C=0;break;
case STEREO:C=1;break;case DUAL_CHANNEL:C=2;break;case JOINT_STEREO:C=f.force_ms?4:3;break;default:C=7}w=32E3>=f.in_samplerate?0:48E3==f.in_samplerate?2:48E3<f.in_samplerate?3:1;if(f.short_blocks==Va.short_block_forced||f.short_blocks==Va.short_block_dispensed||-1==f.lowpassfreq&&-1==f.highpassfreq||f.scale_left<f.scale_right||f.scale_left>f.scale_right||f.disable_reservoir&&320>f.brate||f.noATH||f.ATHonly||0==M||32E3>=f.in_samplerate)P=1;I=I+(C<<2)+(P<<5)+(w<<6);h=h.nMusicCRC;B(k,m+d,a);d+=4;for(a=
0;9>a;a++)k[m+d+a]=255&l.charAt(a);d+=9;k[m+d]=255&n;d++;k[m+d]=255&u;d++;B(k,m+d,A);d+=4;F(k,m+d,L);d+=2;F(k,m+d,0);d+=2;k[m+d]=255&z;d++;k[m+d]=255<=ca?255:255&ca;d++;k[m+d]=255&g>>4;k[m+d+1]=255&(g<<4)+(q>>8);k[m+d+2]=255&q;d+=3;k[m+d]=255&I;d++;k[m+d++]=0;F(k,m+d,f.preset);d+=2;B(k,m+d,r);d+=4;F(k,m+d,h);d+=2;for(f=0;f<d;f++)t=K(k[m+f],t);F(k,m+d,t);return c.VBR_seek_table.TotalFrameSize};this.putVbrTag=function(f,k){if(0>=f.internal_flags.VBR_seek_table.pos)return-1;k.seek(k.length());if(0==
k.length())return-1;k.seek(0);var c=new Int8Array(10);k.readFully(c);c=(new String(c,"ISO-8859-1")).startsWith("ID3")?0:((c[6]&127)<<21|(c[7]&127)<<14|(c[8]&127)<<7|c[9]&127)+c.length;k.seek(c);c=new Int8Array(b);f=getLameTagFrame(f,c);if(f>c.length)return-1;if(1>f)return 0;k.write(c,0,f);return 0}}function jc(D){this.bits=D}function ya(D,B,F,N){this.xlen=D;this.linmax=B;this.table=F;this.hlen=N}function md(){this.setModules=function(D,B){}}function Mc(){this.bits=this.over_SSD=this.over_count=this.max_noise=
this.tot_noise=this.over_noise=0}function Kb(D,B,F,N){this.l=ka(1+v.SBMAX_l);this.s=ka(1+v.SBMAX_s);this.psfb21=ka(1+v.PSFB21);this.psfb12=ka(1+v.PSFB12);var O=this.l,K=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],la.arraycopy(this.arrL,0,O,0,Math.min(this.arrL.length,this.l.length)),la.arraycopy(this.arrS,0,K,0,Math.min(this.arrS.length,this.s.length)),la.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,
this.psfb21.length)),la.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function nd(){this.scale_right=this.scale_left=this.scale=this.out_samplerate=this.in_samplerate=this.num_channels=this.num_samples=this.class_id=0;this.decode_only=this.bWriteVbrTag=this.analysis=!1;this.quality=0;this.mode=Ca.STEREO;this.write_id3tag_automatic=this.decode_on_the_fly=this.findReplayGain=this.free_format=this.force_ms=!1;this.error_protection=this.emphasis=this.extension=
this.original=this.copyright=this.compression_ratio=this.brate=0;this.disable_reservoir=this.strict_ISO=!1;this.quant_comp_short=this.quant_comp=0;this.experimentalY=!1;this.preset=this.exp_nspsytune=this.experimentalZ=0;this.VBR=null;this.maskingadjust_short=this.maskingadjust=this.highpasswidth=this.lowpasswidth=this.highpassfreq=this.lowpassfreq=this.VBR_hard_min=this.VBR_max_bitrate_kbps=this.VBR_min_bitrate_kbps=this.VBR_mean_bitrate_kbps=this.VBR_q=this.VBR_q_frac=0;this.noATH=this.ATHshort=
this.ATHonly=!1;this.athaa_sensitivity=this.athaa_loudapprox=this.athaa_type=this.ATHlower=this.ATHcurve=this.ATHtype=0;this.short_blocks=null;this.useTemporal=!1;this.msfix=this.interChRatio=0;this.tune=!1;this.lame_allocated_gfp=this.frameNum=this.framesize=this.encoder_padding=this.encoder_delay=this.version=this.tune_value_a=0;this.internal_flags=null}function od(){this.floor=this.decay=this.adjustLimit=this.adjust=this.aaSensitivityP=this.useAdjust=0;this.l=W(v.SBMAX_l);this.s=W(v.SBMAX_s);this.psfb21=
W(v.PSFB21);this.psfb12=W(v.PSFB12);this.cb_l=W(v.CBANDS);this.cb_s=W(v.CBANDS);this.eql_w=W(v.BLKSIZE/2)}function pd(){this.linprebuf=W(2*ra.MAX_ORDER);this.linpre=0;this.lstepbuf=W(ra.MAX_SAMPLES_PER_WINDOW+ra.MAX_ORDER);this.lstep=0;this.loutbuf=W(ra.MAX_SAMPLES_PER_WINDOW+ra.MAX_ORDER);this.lout=0;this.rinprebuf=W(2*ra.MAX_ORDER);this.rinpre=0;this.rstepbuf=W(ra.MAX_SAMPLES_PER_WINDOW+ra.MAX_ORDER);this.rstep=0;this.routbuf=W(ra.MAX_SAMPLES_PER_WINDOW+ra.MAX_ORDER);this.first=this.freqindex=this.rsum=
this.lsum=this.totsamp=this.sampleWindow=this.rout=0;this.A=ka(0|ra.STEPS_per_dB*ra.MAX_dB);this.B=ka(0|ra.STEPS_per_dB*ra.MAX_dB)}function qd(D){this.quantize=D;this.iteration_loop=function(B,F,N,O){var K=B.internal_flags,S=W(Cb.SFBMAX),p=W(576),e=ka(2),y=K.l3_side;var b=new jc(0);this.quantize.rv.ResvFrameBegin(B,b);b=b.bits;for(var x=0;x<K.mode_gr;x++){var G=this.quantize.qupvt.on_pe(B,F,e,b,x,x);K.mode_ext==v.MPG_MD_MS_LR&&(this.quantize.ms_convert(K.l3_side,x),this.quantize.qupvt.reduce_side(e,
N[x],b,G));for(G=0;G<K.channels_out;G++){var f=y.tt[x][G];if(f.block_type!=v.SHORT_TYPE){var k=0;k=K.PSY.mask_adjust-k}else k=0,k=K.PSY.mask_adjust_short-k;K.masking_lower=Math.pow(10,.1*k);this.quantize.init_outer_loop(K,f);this.quantize.init_xrpow(K,f,p)&&(this.quantize.qupvt.calc_xmin(B,O[x][G],f,S),this.quantize.outer_loop(B,f,S,p,G,e[G]));this.quantize.iteration_finish_one(K,x,G)}}this.quantize.rv.ResvFrameEnd(K,b)}}function rd(){this.sfb_count1=this.global_gain=0;this.step=ka(39);this.noise=
W(39);this.noise_log=W(39)}function Lc(){this.xr=W(576);this.l3_enc=ka(576);this.scalefac=ka(Cb.SFBMAX);this.mixed_block_flag=this.block_type=this.scalefac_compress=this.global_gain=this.count1=this.big_values=this.part2_3_length=this.xrpow_max=0;this.table_select=ka(3);this.subblock_gain=ka(4);this.sfbdivide=this.psymax=this.sfbmax=this.psy_lmax=this.sfb_smin=this.sfb_lmax=this.part2_length=this.count1table_select=this.scalefac_scale=this.preflag=this.region1_count=this.region0_count=0;this.width=
ka(Cb.SFBMAX);this.window=ka(Cb.SFBMAX);this.count1bits=0;this.sfb_partition_table=null;this.slen=ka(4);this.max_nonzero_coeff=0;var D=this;this.assign=function(B){D.xr=new Float32Array(B.xr);D.l3_enc=new Int32Array(B.l3_enc);D.scalefac=new Int32Array(B.scalefac);D.xrpow_max=B.xrpow_max;D.part2_3_length=B.part2_3_length;D.big_values=B.big_values;D.count1=B.count1;D.global_gain=B.global_gain;D.scalefac_compress=B.scalefac_compress;D.block_type=B.block_type;D.mixed_block_flag=B.mixed_block_flag;D.table_select=
new Int32Array(B.table_select);D.subblock_gain=new Int32Array(B.subblock_gain);D.region0_count=B.region0_count;D.region1_count=B.region1_count;D.preflag=B.preflag;D.scalefac_scale=B.scalefac_scale;D.count1table_select=B.count1table_select;D.part2_length=B.part2_length;D.sfb_lmax=B.sfb_lmax;D.sfb_smin=B.sfb_smin;D.psy_lmax=B.psy_lmax;D.sfbmax=B.sfbmax;D.psymax=B.psymax;D.sfbdivide=B.sfbdivide;D.width=new Int32Array(B.width);D.window=new Int32Array(B.window);D.count1bits=B.count1bits;D.sfb_partition_table=
B.sfb_partition_table.slice(0);D.slen=new Int32Array(B.slen);D.max_nonzero_coeff=B.max_nonzero_coeff}}function sd(){function D(p){this.ordinal=p}function B(p){for(var e=0;e<p.sfbmax;e++)if(0==p.scalefac[e]+p.subblock_gain[p.window[e]])return!1;return!0}var F;this.rv=null;var N;this.qupvt=null;var O,K=new md,S;this.setModules=function(p,e,y,b){F=p;this.rv=N=e;this.qupvt=O=y;S=b;K.setModules(O,S)};this.ms_convert=function(p,e){for(var y=0;576>y;++y){var b=p.tt[e][0].xr[y],x=p.tt[e][1].xr[y];p.tt[e][0].xr[y]=
.5*(b+x)*na.SQRT2;p.tt[e][1].xr[y]=.5*(b-x)*na.SQRT2}};this.init_xrpow=function(p,e,y){var b=0|e.max_nonzero_coeff;e.xrpow_max=0;nb.fill(y,b,576,0);for(var x,G=x=0;G<=b;++G){var f=Math.abs(e.xr[G]);x+=f;y[G]=Math.sqrt(f*Math.sqrt(f));y[G]>e.xrpow_max&&(e.xrpow_max=y[G])}if(1E-20<x){y=0;0!=(p.substep_shaping&2)&&(y=1);for(b=0;b<e.psymax;b++)p.pseudohalf[b]=y;return!0}nb.fill(e.l3_enc,0,576,0);return!1};this.init_outer_loop=function(p,e){e.part2_3_length=0;e.big_values=0;e.count1=0;e.global_gain=210;
e.scalefac_compress=0;e.table_select[0]=0;e.table_select[1]=0;e.table_select[2]=0;e.subblock_gain[0]=0;e.subblock_gain[1]=0;e.subblock_gain[2]=0;e.subblock_gain[3]=0;e.region0_count=0;e.region1_count=0;e.preflag=0;e.scalefac_scale=0;e.count1table_select=0;e.part2_length=0;e.sfb_lmax=v.SBPSY_l;e.sfb_smin=v.SBPSY_s;e.psy_lmax=p.sfb21_extra?v.SBMAX_l:v.SBPSY_l;e.psymax=e.psy_lmax;e.sfbmax=e.sfb_lmax;e.sfbdivide=11;for(var y=0;y<v.SBMAX_l;y++)e.width[y]=p.scalefac_band.l[y+1]-p.scalefac_band.l[y],e.window[y]=
3;if(e.block_type==v.SHORT_TYPE){var b=W(576);e.sfb_smin=0;e.sfb_lmax=0;0!=e.mixed_block_flag&&(e.sfb_smin=3,e.sfb_lmax=2*p.mode_gr+4);e.psymax=e.sfb_lmax+3*((p.sfb21_extra?v.SBMAX_s:v.SBPSY_s)-e.sfb_smin);e.sfbmax=e.sfb_lmax+3*(v.SBPSY_s-e.sfb_smin);e.sfbdivide=e.sfbmax-18;e.psy_lmax=e.sfb_lmax;var x=p.scalefac_band.l[e.sfb_lmax];la.arraycopy(e.xr,0,b,0,576);for(y=e.sfb_smin;y<v.SBMAX_s;y++)for(var G=p.scalefac_band.s[y],f=p.scalefac_band.s[y+1],k=0;3>k;k++)for(var c=G;c<f;c++)e.xr[x++]=b[3*c+k];
b=e.sfb_lmax;for(y=e.sfb_smin;y<v.SBMAX_s;y++)e.width[b]=e.width[b+1]=e.width[b+2]=p.scalefac_band.s[y+1]-p.scalefac_band.s[y],e.window[b]=0,e.window[b+1]=1,e.window[b+2]=2,b+=3}e.count1bits=0;e.sfb_partition_table=O.nr_of_sfb_block[0][0];e.slen[0]=0;e.slen[1]=0;e.slen[2]=0;e.slen[3]=0;e.max_nonzero_coeff=575;nb.fill(e.scalefac,0);y=p.ATH;b=e.xr;if(e.block_type!=v.SHORT_TYPE)for(e=!1,x=v.PSFB21-1;0<=x&&!e;x--)for(G=p.scalefac_band.psfb21[x],f=p.scalefac_band.psfb21[x+1],k=O.athAdjust(y.adjust,y.psfb21[x],
y.floor),1E-12<p.nsPsy.longfact[21]&&(k*=p.nsPsy.longfact[21]),--f;f>=G;f--)if(Math.abs(b[f])<k)b[f]=0;else{e=!0;break}else for(k=0;3>k;k++)for(e=!1,x=v.PSFB12-1;0<=x&&!e;x--)for(G=3*p.scalefac_band.s[12]+(p.scalefac_band.s[13]-p.scalefac_band.s[12])*k+(p.scalefac_band.psfb12[x]-p.scalefac_band.psfb12[0]),f=G+(p.scalefac_band.psfb12[x+1]-p.scalefac_band.psfb12[x]),c=O.athAdjust(y.adjust,y.psfb12[x],y.floor),1E-12<p.nsPsy.shortfact[12]&&(c*=p.nsPsy.shortfact[12]),--f;f>=G;f--)if(Math.abs(b[f])<c)b[f]=
0;else{e=!0;break}};D.BINSEARCH_NONE=new D(0);D.BINSEARCH_UP=new D(1);D.BINSEARCH_DOWN=new D(2);this.trancate_smallspectrums=function(p,e,y,b){var x=W(Cb.SFBMAX);if((0!=(p.substep_shaping&4)||e.block_type!=v.SHORT_TYPE)&&0==(p.substep_shaping&128)){O.calc_noise(e,y,x,new Mc,null);for(var G=0;576>G;G++){var f=0;0!=e.l3_enc[G]&&(f=Math.abs(e.xr[G]));b[G]=f}G=0;f=8;e.block_type==v.SHORT_TYPE&&(f=6);do{var k,c,m=e.width[f];G+=m;if(!(1<=x[f]||(nb.sort(b,G-m,m),Wa.EQ(b[G-1],0)))){var t=(1-x[f])*y[f];var r=
k=0;do{for(c=1;r+c<m&&!Wa.NEQ(b[r+G-m],b[r+G+c-m]);c++);var d=b[r+G-m]*b[r+G-m]*c;if(t<d){0!=r&&(k=b[r+G-m-1]);break}t-=d;r+=c}while(r<m);if(!Wa.EQ(k,0)){do Math.abs(e.xr[G-m])<=k&&(e.l3_enc[G-m]=0);while(0<--m)}}}while(++f<e.psymax);e.part2_3_length=S.noquant_count_bits(p,e,null)}};this.outer_loop=function(p,e,y,b,x,G){var f=p.internal_flags,k=new Lc,c=W(576),m=W(Cb.SFBMAX),t=new Mc,r=new rd,d=9999999,g=!1,h=!1,q=0,a,l=f.CurrentStep[x],n=!1,u=f.OldValue[x];var A=D.BINSEARCH_NONE;e.global_gain=u;
for(a=G-e.part2_length;;){var L=S.count_bits(f,b,e,null);if(1==l||L==a)break;L>a?(A==D.BINSEARCH_DOWN&&(n=!0),n&&(l/=2),A=D.BINSEARCH_UP,L=l):(A==D.BINSEARCH_UP&&(n=!0),n&&(l/=2),A=D.BINSEARCH_DOWN,L=-l);e.global_gain+=L;0>e.global_gain&&(e.global_gain=0,n=!0);255<e.global_gain&&(e.global_gain=255,n=!0)}for(;L>a&&255>e.global_gain;)e.global_gain++,L=S.count_bits(f,b,e,null);f.CurrentStep[x]=4<=u-e.global_gain?4:2;f.OldValue[x]=e.global_gain;e.part2_3_length=L;if(0==f.noise_shaping)return 100;O.calc_noise(e,
y,m,t,r);t.bits=e.part2_3_length;k.assign(e);x=0;for(la.arraycopy(b,0,c,0,576);!g;){do{a=new Mc;n=255;l=0!=(f.substep_shaping&2)?20:3;if(f.sfb21_extra){if(1<m[k.sfbmax])break;if(k.block_type==v.SHORT_TYPE&&(1<m[k.sfbmax+1]||1<m[k.sfbmax+2]))break}u=k;L=b;A=p.internal_flags;var I=u,P=m,w=L,z=p.internal_flags;var C=0==I.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var E=0,Q=0;Q<I.sfbmax;Q++)E<P[Q]&&(E=P[Q]);Q=z.noise_shaping_amp;3==Q&&(Q=h?2:1);switch(Q){case 2:break;case 1:E=1<E?Math.pow(E,
.5):.95*E;break;default:E=1<E?1:.95*E}var H=0;for(Q=0;Q<I.sfbmax;Q++){var M=I.width[Q];H+=M;if(!(P[Q]<E)){if(0!=(z.substep_shaping&2)&&(z.pseudohalf[Q]=0==z.pseudohalf[Q]?1:0,0==z.pseudohalf[Q]&&2==z.noise_shaping_amp))break;I.scalefac[Q]++;for(M=-M;0>M;M++)w[H+M]*=C,w[H+M]>I.xrpow_max&&(I.xrpow_max=w[H+M]);if(2==z.noise_shaping_amp)break}}if(C=B(u))u=!1;else if(C=2==A.mode_gr?S.scale_bitcount(u):S.scale_bitcount_lsf(A,u)){if(1<A.noise_shaping)if(nb.fill(A.pseudohalf,0),0==u.scalefac_scale){C=u;for(P=
I=0;P<C.sfbmax;P++){z=C.width[P];w=C.scalefac[P];0!=C.preflag&&(w+=O.pretab[P]);I+=z;if(0!=(w&1))for(w++,z=-z;0>z;z++)L[I+z]*=1.2968395546510096,L[I+z]>C.xrpow_max&&(C.xrpow_max=L[I+z]);C.scalefac[P]=w>>1}C.preflag=0;C.scalefac_scale=1;C=!1}else if(u.block_type==v.SHORT_TYPE&&0<A.subblock_gain){b:{C=A;I=u;P=L;w=I.scalefac;for(L=0;L<I.sfb_lmax;L++)if(16<=w[L]){L=!0;break b}for(z=0;3>z;z++){Q=E=0;for(L=I.sfb_lmax+z;L<I.sfbdivide;L+=3)E<w[L]&&(E=w[L]);for(;L<I.sfbmax;L+=3)Q<w[L]&&(Q=w[L]);if(!(16>E&&
8>Q)){if(7<=I.subblock_gain[z]){L=!0;break b}I.subblock_gain[z]++;E=C.scalefac_band.l[I.sfb_lmax];for(L=I.sfb_lmax+z;L<I.sfbmax;L+=3)if(Q=I.width[L],H=w[L],H-=4>>I.scalefac_scale,0<=H)w[L]=H,E+=3*Q;else{w[L]=0;H=O.IPOW20(210+(H<<I.scalefac_scale+1));E+=Q*(z+1);for(M=-Q;0>M;M++)P[E+M]*=H,P[E+M]>I.xrpow_max&&(I.xrpow_max=P[E+M]);E+=Q*(3-z-1)}H=O.IPOW20(202);E+=I.width[L]*(z+1);for(M=-I.width[L];0>M;M++)P[E+M]*=H,P[E+M]>I.xrpow_max&&(I.xrpow_max=P[E+M])}}L=!1}C=L||B(u)}C||=2==A.mode_gr?S.scale_bitcount(u):
S.scale_bitcount_lsf(A,u);u=!C}else u=!0;if(!u)break;0!=k.scalefac_scale&&(n=254);u=G-k.part2_length;if(0>=u)break;for(;(k.part2_3_length=S.count_bits(f,b,k,r))>u&&k.global_gain<=n;)k.global_gain++;if(k.global_gain>n)break;if(0==t.over_count){for(;(k.part2_3_length=S.count_bits(f,b,k,r))>d&&k.global_gain<=n;)k.global_gain++;if(k.global_gain>n)break}O.calc_noise(k,y,m,a,r);a.bits=k.part2_3_length;A=e.block_type!=v.SHORT_TYPE?p.quant_comp:p.quant_comp_short;n=t;u=a;C=k;L=m;switch(A){default:case 9:0<
n.over_count?(A=u.over_SSD<=n.over_SSD,u.over_SSD==n.over_SSD&&(A=u.bits<n.bits)):A=0>u.max_noise&&10*u.max_noise+u.bits<=10*n.max_noise+n.bits;break;case 0:A=u.over_count<n.over_count||u.over_count==n.over_count&&u.over_noise<n.over_noise||u.over_count==n.over_count&&Wa.EQ(u.over_noise,n.over_noise)&&u.tot_noise<n.tot_noise;break;case 8:A=u;P=1E-37;for(I=0;I<C.psymax;I++)w=L[I],w=na.FAST_LOG10(.368+.632*w*w*w),P+=w;A.max_noise=Math.max(1E-20,P);case 1:A=u.max_noise<n.max_noise;break;case 2:A=u.tot_noise<
n.tot_noise;break;case 3:A=u.tot_noise<n.tot_noise&&u.max_noise<n.max_noise;break;case 4:A=0>=u.max_noise&&.2<n.max_noise||0>=u.max_noise&&0>n.max_noise&&n.max_noise>u.max_noise-.2&&u.tot_noise<n.tot_noise||0>=u.max_noise&&0<n.max_noise&&n.max_noise>u.max_noise-.2&&u.tot_noise<n.tot_noise+n.over_noise||0<u.max_noise&&-.05<n.max_noise&&n.max_noise>u.max_noise-.1&&u.tot_noise+u.over_noise<n.tot_noise+n.over_noise||0<u.max_noise&&-.1<n.max_noise&&n.max_noise>u.max_noise-.15&&u.tot_noise+u.over_noise+
u.over_noise<n.tot_noise+n.over_noise+n.over_noise;break;case 5:A=u.over_noise<n.over_noise||Wa.EQ(u.over_noise,n.over_noise)&&u.tot_noise<n.tot_noise;break;case 6:A=u.over_noise<n.over_noise||Wa.EQ(u.over_noise,n.over_noise)&&(u.max_noise<n.max_noise||Wa.EQ(u.max_noise,n.max_noise)&&u.tot_noise<=n.tot_noise);break;case 7:A=u.over_count<n.over_count||u.over_noise<n.over_noise}0==n.over_count&&(A=A&&u.bits<n.bits);A=A?1:0;if(0!=A)d=e.part2_3_length,t=a,e.assign(k),x=0,la.arraycopy(b,0,c,0,576);else if(0==
f.full_outer_loop){if(++x>l&&0==t.over_count)break;if(3==f.noise_shaping_amp&&h&&30<x)break;if(3==f.noise_shaping_amp&&h&&15<k.global_gain-q)break}}while(255>k.global_gain+k.scalefac_scale);3==f.noise_shaping_amp?h?g=!0:(k.assign(e),la.arraycopy(c,0,b,0,576),x=0,q=k.global_gain,h=!0):g=!0}p.VBR==aa.vbr_rh||p.VBR==aa.vbr_mtrh?la.arraycopy(c,0,b,0,576):0!=(f.substep_shaping&1)&&trancate_smallspectrums(f,e,y,b);return t.over_count};this.iteration_finish_one=function(p,e,y){var b=p.l3_side,x=b.tt[e][y];
S.best_scalefac_store(p,e,y,b);1==p.use_best_huffman&&S.best_huffman_divide(p,x);N.ResvAdjust(p,x)};this.VBR_encode_granule=function(p,e,y,b,x,G,f){var k=p.internal_flags,c=new Lc,m=W(576),t=f,r=(f+G)/2,d=0,g=k.sfb21_extra;nb.fill(c.l3_enc,0);do{k.sfb21_extra=r>t-42?!1:g;var h=outer_loop(p,e,y,b,x,r);0>=h?(d=1,f=e.part2_3_length,c.assign(e),la.arraycopy(b,0,m,0,576),f-=32,h=f-G,r=(f+G)/2):(G=r+32,h=f-G,r=(f+G)/2,0!=d&&(d=2,e.assign(c),la.arraycopy(m,0,b,0,576)))}while(12<h);k.sfb21_extra=g;2==d&&
la.arraycopy(c.l3_enc,0,e.l3_enc,0,576)};this.get_framebits=function(p,e){var y=p.internal_flags;y.bitrate_index=y.VBR_min_bitrate;F.getframebits(p);y.bitrate_index=1;var b=F.getframebits(p);for(var x=1;x<=y.VBR_max_bitrate;x++)y.bitrate_index=x,b=new jc(b),e[x]=N.ResvFrameBegin(p,b),b=b.bits};this.VBR_old_prepare=function(p,e,y,b,x,G,f,k,c){var m=p.internal_flags,t=1,r=0;m.bitrate_index=m.VBR_max_bitrate;var d=N.ResvFrameBegin(p,new jc(0))/m.mode_gr;get_framebits(p,G);for(var g=0;g<m.mode_gr;g++){var h=
O.on_pe(p,e,k[g],d,g,0);m.mode_ext==v.MPG_MD_MS_LR&&(ms_convert(m.l3_side,g),O.reduce_side(k[g],y[g],d,h));for(h=0;h<m.channels_out;++h){var q=m.l3_side.tt[g][h];if(q.block_type!=v.SHORT_TYPE){var a=1.28/(1+Math.exp(3.5-e[g][h]/300))-.05;a=m.PSY.mask_adjust-a}else a=2.56/(1+Math.exp(3.5-e[g][h]/300))-.14,a=m.PSY.mask_adjust_short-a;m.masking_lower=Math.pow(10,.1*a);init_outer_loop(m,q);c[g][h]=O.calc_xmin(p,b[g][h],q,x[g][h]);0!=c[g][h]&&(t=0);f[g][h]=126;r+=k[g][h]}}for(g=0;g<m.mode_gr;g++)for(h=
0;h<m.channels_out;h++)r>G[m.VBR_max_bitrate]&&(k[g][h]*=G[m.VBR_max_bitrate],k[g][h]/=r),f[g][h]>k[g][h]&&(f[g][h]=k[g][h]);return t};this.bitpressure_strategy=function(p,e,y,b){for(var x=0;x<p.mode_gr;x++)for(var G=0;G<p.channels_out;G++){for(var f=p.l3_side.tt[x][G],k=e[x][G],c=0,m=0;m<f.psy_lmax;m++)k[c++]*=1+.029*m*m/v.SBMAX_l/v.SBMAX_l;if(f.block_type==v.SHORT_TYPE)for(m=f.sfb_smin;m<v.SBMAX_s;m++)k[c++]*=1+.029*m*m/v.SBMAX_s/v.SBMAX_s,k[c++]*=1+.029*m*m/v.SBMAX_s/v.SBMAX_s,k[c++]*=1+.029*m*
m/v.SBMAX_s/v.SBMAX_s;b[x][G]=0|Math.max(y[x][G],.9*b[x][G])}};this.VBR_new_prepare=function(p,e,y,b,x,G){var f=p.internal_flags,k=1,c=0,m=0;if(p.free_format){f.bitrate_index=0;c=new jc(c);var t=N.ResvFrameBegin(p,c);c=c.bits;x[0]=t}else f.bitrate_index=f.VBR_max_bitrate,c=new jc(c),N.ResvFrameBegin(p,c),c=c.bits,get_framebits(p,x),t=x[f.VBR_max_bitrate];for(x=0;x<f.mode_gr;x++){O.on_pe(p,e,G[x],c,x,0);f.mode_ext==v.MPG_MD_MS_LR&&ms_convert(f.l3_side,x);for(var r=0;r<f.channels_out;++r){var d=f.l3_side.tt[x][r];
f.masking_lower=Math.pow(10,.1*f.PSY.mask_adjust);init_outer_loop(f,d);0!=O.calc_xmin(p,y[x][r],d,b[x][r])&&(k=0);m+=G[x][r]}}for(x=0;x<f.mode_gr;x++)for(r=0;r<f.channels_out;r++)m>t&&(G[x][r]*=t,G[x][r]/=m);return k};this.calc_target_bits=function(p,e,y,b,x,G){var f=p.internal_flags,k=f.l3_side;f.bitrate_index=f.VBR_max_bitrate;var c=new jc(0);G[0]=N.ResvFrameBegin(p,c);f.bitrate_index=1;c=F.getframebits(p)-8*f.sideinfo_len;x[0]=c/(f.mode_gr*f.channels_out);c=p.VBR_mean_bitrate_kbps*p.framesize*
1E3;0!=(f.substep_shaping&1)&&(c*=1.09);c/=p.out_samplerate;c-=8*f.sideinfo_len;c/=f.mode_gr*f.channels_out;var m=.93+.07*(11-p.compression_ratio)/5.5;.9>m&&(m=.9);1<m&&(m=1);for(p=0;p<f.mode_gr;p++){var t=0;for(x=0;x<f.channels_out;x++){b[p][x]=int(m*c);if(700<e[p][x]){var r=int((e[p][x]-700)/1.4),d=k.tt[p][x];b[p][x]=int(m*c);d.block_type==v.SHORT_TYPE&&r<c/2&&(r=c/2);r>3*c/2?r=3*c/2:0>r&&(r=0);b[p][x]+=r}b[p][x]>Ba.MAX_BITS_PER_CHANNEL&&(b[p][x]=Ba.MAX_BITS_PER_CHANNEL);t+=b[p][x]}if(t>Ba.MAX_BITS_PER_GRANULE)for(x=
0;x<f.channels_out;++x)b[p][x]*=Ba.MAX_BITS_PER_GRANULE,b[p][x]/=t}if(f.mode_ext==v.MPG_MD_MS_LR)for(p=0;p<f.mode_gr;p++)O.reduce_side(b[p],y[p],c*f.channels_out,Ba.MAX_BITS_PER_GRANULE);for(p=e=0;p<f.mode_gr;p++)for(x=0;x<f.channels_out;x++)b[p][x]>Ba.MAX_BITS_PER_CHANNEL&&(b[p][x]=Ba.MAX_BITS_PER_CHANNEL),e+=b[p][x];if(e>G[0])for(p=0;p<f.mode_gr;p++)for(x=0;x<f.channels_out;x++)b[p][x]*=G[0],b[p][x]/=e}}function td(){function D(e,y,b){for(var x=10,G=y+238-14-286,f=-15;0>f;f++){var k=B[x+-10];var c=
e[G+-224]*k;var m=e[y+224]*k;k=B[x+-9];c+=e[G+-160]*k;m+=e[y+160]*k;k=B[x+-8];c+=e[G+-96]*k;m+=e[y+96]*k;k=B[x+-7];c+=e[G+-32]*k;m+=e[y+32]*k;k=B[x+-6];c+=e[G+32]*k;m+=e[y+-32]*k;k=B[x+-5];c+=e[G+96]*k;m+=e[y+-96]*k;k=B[x+-4];c+=e[G+160]*k;m+=e[y+-160]*k;k=B[x+-3];c+=e[G+224]*k;m+=e[y+-224]*k;k=B[x+-2];c+=e[y+-256]*k;m-=e[G+256]*k;k=B[x+-1];c+=e[y+-192]*k;m-=e[G+192]*k;k=B[x+0];c+=e[y+-128]*k;m-=e[G+128]*k;k=B[x+1];c+=e[y+-64]*k;m-=e[G+64]*k;k=B[x+2];c+=e[y+0]*k;m-=e[G+0]*k;k=B[x+3];c+=e[y+64]*k;
m-=e[G+-64]*k;k=B[x+4];c+=e[y+128]*k;m-=e[G+-128]*k;k=B[x+5];c+=e[y+192]*k;m-=e[G+-192]*k;c*=B[x+6];k=m-c;b[30+2*f]=m+c;b[31+2*f]=B[x+7]*k;x+=18;y--;G++}m=e[y+-16]*B[x+-10];c=e[y+-32]*B[x+-2];m+=(e[y+-48]-e[y+16])*B[x+-9];c+=e[y+-96]*B[x+-1];m+=(e[y+-80]+e[y+48])*B[x+-8];c+=e[y+-160]*B[x+0];m+=(e[y+-112]-e[y+80])*B[x+-7];c+=e[y+-224]*B[x+1];m+=(e[y+-144]+e[y+112])*B[x+-6];c-=e[y+32]*B[x+2];m+=(e[y+-176]-e[y+144])*B[x+-5];c-=e[y+96]*B[x+3];m+=(e[y+-208]+e[y+176])*B[x+-4];c-=e[y+160]*B[x+4];m+=(e[y+
-240]-e[y+208])*B[x+-3];c-=e[y+224];e=c-m;y=c+m;m=b[14];c=b[15]-m;b[31]=y+m;b[30]=e+c;b[15]=e-c;b[14]=y-m;c=b[28]-b[0];b[0]+=b[28];b[28]=c*B[x+-36+7];c=b[29]-b[1];b[1]+=b[29];b[29]=c*B[x+-36+7];c=b[26]-b[2];b[2]+=b[26];b[26]=c*B[x+-72+7];c=b[27]-b[3];b[3]+=b[27];b[27]=c*B[x+-72+7];c=b[24]-b[4];b[4]+=b[24];b[24]=c*B[x+-108+7];c=b[25]-b[5];b[5]+=b[25];b[25]=c*B[x+-108+7];c=b[22]-b[6];b[6]+=b[22];b[22]=c*na.SQRT2;c=b[23]-b[7];b[7]+=b[23];b[23]=c*na.SQRT2-b[7];b[7]-=b[6];b[22]-=b[7];b[23]-=b[22];c=b[6];
b[6]=b[31]-c;b[31]+=c;c=b[7];b[7]=b[30]-c;b[30]+=c;c=b[22];b[22]=b[15]-c;b[15]+=c;c=b[23];b[23]=b[14]-c;b[14]+=c;c=b[20]-b[8];b[8]+=b[20];b[20]=c*B[x+-180+7];c=b[21]-b[9];b[9]+=b[21];b[21]=c*B[x+-180+7];c=b[18]-b[10];b[10]+=b[18];b[18]=c*B[x+-216+7];c=b[19]-b[11];b[11]+=b[19];b[19]=c*B[x+-216+7];c=b[16]-b[12];b[12]+=b[16];b[16]=c*B[x+-252+7];c=b[17]-b[13];b[13]+=b[17];b[17]=c*B[x+-252+7];c=-b[20]+b[24];b[20]+=b[24];b[24]=c*B[x+-216+7];c=-b[21]+b[25];b[21]+=b[25];b[25]=c*B[x+-216+7];c=b[4]-b[8];b[4]+=
b[8];b[8]=c*B[x+-216+7];c=b[5]-b[9];b[5]+=b[9];b[9]=c*B[x+-216+7];c=b[0]-b[12];b[0]+=b[12];b[12]=c*B[x+-72+7];c=b[1]-b[13];b[1]+=b[13];b[13]=c*B[x+-72+7];c=b[16]-b[28];b[16]+=b[28];b[28]=c*B[x+-72+7];c=-b[17]+b[29];b[17]+=b[29];b[29]=c*B[x+-72+7];c=na.SQRT2*(b[2]-b[10]);b[2]+=b[10];b[10]=c;c=na.SQRT2*(b[3]-b[11]);b[3]+=b[11];b[11]=c;c=na.SQRT2*(-b[18]+b[26]);b[18]+=b[26];b[26]=c-b[18];c=na.SQRT2*(-b[19]+b[27]);b[19]+=b[27];b[27]=c-b[19];c=b[2];b[19]-=b[3];b[3]-=c;b[2]=b[31]-c;b[31]+=c;c=b[3];b[11]-=
b[19];b[18]-=c;b[3]=b[30]-c;b[30]+=c;c=b[18];b[27]-=b[11];b[19]-=c;b[18]=b[15]-c;b[15]+=c;c=b[19];b[10]-=c;b[19]=b[14]-c;b[14]+=c;c=b[10];b[11]-=c;b[10]=b[23]-c;b[23]+=c;c=b[11];b[26]-=c;b[11]=b[22]-c;b[22]+=c;c=b[26];b[27]-=c;b[26]=b[7]-c;b[7]+=c;c=b[27];b[27]=b[6]-c;b[6]+=c;c=na.SQRT2*(b[0]-b[4]);b[0]+=b[4];b[4]=c;c=na.SQRT2*(b[1]-b[5]);b[1]+=b[5];b[5]=c;c=na.SQRT2*(b[16]-b[20]);b[16]+=b[20];b[20]=c;c=na.SQRT2*(b[17]-b[21]);b[17]+=b[21];b[21]=c;c=-na.SQRT2*(b[8]-b[12]);b[8]+=b[12];b[12]=c-b[8];
c=-na.SQRT2*(b[9]-b[13]);b[9]+=b[13];b[13]=c-b[9];c=-na.SQRT2*(b[25]-b[29]);b[25]+=b[29];b[29]=c-b[25];c=-na.SQRT2*(b[24]+b[28]);b[24]-=b[28];b[28]=c-b[24];c=b[24]-b[16];b[24]=c;c=b[20]-c;b[20]=c;c=b[28]-c;b[28]=c;c=b[25]-b[17];b[25]=c;c=b[21]-c;b[21]=c;c=b[29]-c;b[29]=c;c=b[17]-b[1];b[17]=c;c=b[9]-c;b[9]=c;c=b[25]-c;b[25]=c;c=b[5]-c;b[5]=c;c=b[21]-c;b[21]=c;c=b[13]-c;b[13]=c;c=b[29]-c;b[29]=c;c=b[1]-b[0];b[1]=c;c=b[16]-c;b[16]=c;c=b[17]-c;b[17]=c;c=b[8]-c;b[8]=c;c=b[9]-c;b[9]=c;c=b[24]-c;b[24]=c;
c=b[25]-c;b[25]=c;c=b[4]-c;b[4]=c;c=b[5]-c;b[5]=c;c=b[20]-c;b[20]=c;c=b[21]-c;b[21]=c;c=b[12]-c;b[12]=c;c=b[13]-c;b[13]=c;c=b[28]-c;b[28]=c;c=b[29]-c;b[29]=c;c=b[0];b[0]+=b[31];b[31]-=c;c=b[1];b[1]+=b[30];b[30]-=c;c=b[16];b[16]+=b[15];b[15]-=c;c=b[17];b[17]+=b[14];b[14]-=c;c=b[8];b[8]+=b[23];b[23]-=c;c=b[9];b[9]+=b[22];b[22]-=c;c=b[24];b[24]+=b[7];b[7]-=c;c=b[25];b[25]+=b[6];b[6]-=c;c=b[4];b[4]+=b[27];b[27]-=c;c=b[5];b[5]+=b[26];b[26]-=c;c=b[20];b[20]+=b[11];b[11]-=c;c=b[21];b[21]+=b[10];b[10]-=c;
c=b[12];b[12]+=b[19];b[19]-=c;c=b[13];b[13]+=b[18];b[18]-=c;c=b[28];b[28]+=b[3];b[3]-=c;c=b[29];b[29]+=b[2];b[2]-=c}var B=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,
817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,
-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,
12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,
-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,
13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,
-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,
13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,
-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,
13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,
-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.0178904535*na.SQRT2/2.384E-6,.008938074*na.SQRT2/2.384E-6,.0015673635*na.SQRT2/2.384E-6,.001228571*na.SQRT2/2.384E-6,4.856585E-4*na.SQRT2/2.384E-6,1.09434E-4*na.SQRT2/2.384E-6,5.0783E-5*na.SQRT2/2.384E-6,6.914E-6*na.SQRT2/2.384E-6,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],F=[[2.382191739347913E-13,6.423305872147834E-13,
9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.40084909404969E-13,6.423305872147839E-13,2.382191739347918E-13,5.456116108943412E-12,4.878985199565852E-12,4.240448995017367E-12,3.559909094758252E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558783E-12,8.371015190102974E-13,2.599706096327376E-13,-5.456116108943412E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758252E-12,-2.858043359288076E-12,-2.156177623817898E-12,-1.475637723558783E-12,
-8.371015190102975E-13,-2.599706096327376E-13,-2.382191739347923E-13,-6.423305872147843E-13,-9.400849094049696E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049694E-13,-6.42330587214784E-13,-2.382191739347918E-13],[2.382191739347913E-13,6.423305872147834E-13,9.400849094049688E-13,1.122435026096556E-12,1.183840321267481E-12,1.122435026096556E-12,9.400849094049688E-13,6.423305872147841E-13,2.382191739347918E-13,5.456116108943413E-12,4.878985199565852E-12,4.240448995017367E-12,
3.559909094758253E-12,2.858043359288075E-12,2.156177623817898E-12,1.475637723558782E-12,8.371015190102975E-13,2.599706096327376E-13,-5.461314069809755E-12,-4.921085770524055E-12,-4.343405037091838E-12,-3.732668368707687E-12,-3.093523840190885E-12,-2.430835727329465E-12,-1.734679010007751E-12,-9.74825365660928E-13,-2.797435120168326E-13,0,0,0,0,0,0,-2.283748241799531E-13,-4.037858874020686E-13,-2.146547464825323E-13],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,
1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,
.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2.283748241799531E-13,4.037858874020686E-13,2.146547464825323E-13,5.461314069809755E-12,4.921085770524055E-12,4.343405037091838E-12,3.732668368707687E-12,3.093523840190885E-12,2.430835727329466E-12,1.734679010007751E-12,9.74825365660928E-13,2.797435120168326E-13,-5.456116108943413E-12,-4.878985199565852E-12,-4.240448995017367E-12,-3.559909094758253E-12,-2.858043359288075E-12,-2.156177623817898E-12,-1.475637723558782E-12,-8.371015190102975E-13,
-2.599706096327376E-13,-2.382191739347913E-13,-6.423305872147834E-13,-9.400849094049688E-13,-1.122435026096556E-12,-1.183840321267481E-12,-1.122435026096556E-12,-9.400849094049688E-13,-6.423305872147841E-13,-2.382191739347918E-13]],N=F[v.SHORT_TYPE],O=F[v.SHORT_TYPE],K=F[v.SHORT_TYPE],S=F[v.SHORT_TYPE],p=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];this.mdct_sub48=function(e,y,b){for(var x=286,G=0;G<e.channels_out;G++){for(var f=0;f<e.mode_gr;f++){for(var k,
c=e.l3_side.tt[f][G],m=c.xr,t=0,r=e.sb_sample[G][1-f],d=0,g=0;9>g;g++)for(D(y,x,r[d]),D(y,x+32,r[d+1]),d+=2,x+=64,k=1;32>k;k+=2)r[d-1][k]*=-1;for(k=0;32>k;k++,t+=18){r=c.block_type;d=e.sb_sample[G][f];var h=e.sb_sample[G][1-f];0!=c.mixed_block_flag&&2>k&&(r=0);if(1E-12>e.amp_filter[k])nb.fill(m,t+0,t+18,0);else{if(1>e.amp_filter[k])for(g=0;18>g;g++)h[g][p[k]]*=e.amp_filter[k];if(r==v.SHORT_TYPE){for(g=-3;0>g;g++){var q=F[v.SHORT_TYPE][g+3];m[t+3*g+9]=d[9+g][p[k]]*q-d[8-g][p[k]];m[t+3*g+18]=d[14-g][p[k]]*
q+d[15+g][p[k]];m[t+3*g+10]=d[15+g][p[k]]*q-d[14-g][p[k]];m[t+3*g+19]=h[2-g][p[k]]*q+h[3+g][p[k]];m[t+3*g+11]=h[3+g][p[k]]*q-h[2-g][p[k]];m[t+3*g+20]=h[8-g][p[k]]*q+h[9+g][p[k]]}g=m;d=t;for(q=0;3>q;q++){var a=g[d+6]*F[v.SHORT_TYPE][0]-g[d+15];h=g[d+0]*F[v.SHORT_TYPE][2]-g[d+9];var l=a+h;var n=a-h;a=g[d+15]*F[v.SHORT_TYPE][0]+g[d+6];h=g[d+9]*F[v.SHORT_TYPE][2]+g[d+0];var u=a+h;var A=-a+h;h=2.069978111953089E-11*(g[d+3]*F[v.SHORT_TYPE][1]-g[d+12]);a=2.069978111953089E-11*(g[d+12]*F[v.SHORT_TYPE][1]+
g[d+3]);g[d+0]=1.90752519173728E-11*l+h;g[d+15]=1.90752519173728E-11*-u+a;n*=1.6519652744032674E-11;u=9.537625958686404E-12*u+a;g[d+3]=n-u;g[d+6]=n+u;l=9.537625958686404E-12*l-h;A*=1.6519652744032674E-11;g[d+9]=l+A;g[d+12]=l-A;d++}}else{q=W(18);for(g=-9;0>g;g++)l=F[r][g+27]*h[g+9][p[k]]+F[r][g+36]*h[8-g][p[k]],n=F[r][g+9]*d[g+9][p[k]]-F[r][g+18]*d[8-g][p[k]],q[g+9]=l-n*N[3+g+9],q[g+18]=l*N[3+g+9]+n;g=m;d=t;l=q;var L=l[17]-l[9];var I=l[15]-l[11];var P=l[14]-l[12];A=l[0]+l[8];u=l[1]+l[7];a=l[2]+l[6];
n=l[3]+l[5];g[d+17]=A+a-n-(u-l[4]);q=(A+a-n)*O[19]+(u-l[4]);h=(L-I-P)*O[18];g[d+5]=h+q;g[d+6]=h-q;var w=(l[16]-l[10])*O[18];u=u*O[19]+l[4];h=L*O[12]+w+I*O[13]+P*O[14];q=-A*O[16]+u-a*O[17]+n*O[15];g[d+1]=h+q;g[d+2]=h-q;h=L*O[13]-w-I*O[14]+P*O[12];q=-A*O[17]+u-a*O[15]+n*O[16];g[d+9]=h+q;g[d+10]=h-q;h=L*O[14]-w+I*O[12]-P*O[13];q=A*O[15]-u+a*O[16]-n*O[17];g[d+13]=h+q;g[d+14]=h-q;L=l[8]-l[0];I=l[6]-l[2];P=l[5]-l[3];A=l[17]+l[9];u=l[16]+l[10];a=l[15]+l[11];n=l[14]+l[12];g[d+0]=A+a+n+(u+l[13]);h=(A+a+n)*
O[19]-(u+l[13]);q=(L-I+P)*O[18];g[d+11]=h+q;g[d+12]=h-q;w=(l[7]-l[1])*O[18];u=l[13]-u*O[19];h=A*O[15]-u+a*O[16]+n*O[17];q=L*O[14]+w+I*O[12]+P*O[13];g[d+3]=h+q;g[d+4]=h-q;h=-A*O[17]+u-a*O[15]-n*O[16];q=L*O[13]+w-I*O[14]-P*O[12];g[d+7]=h+q;g[d+8]=h-q;h=-A*O[16]+u-a*O[17]-n*O[15];q=L*O[12]-w+I*O[13]-P*O[14];g[d+15]=h+q;g[d+16]=h-q}}if(r!=v.SHORT_TYPE&&0!=k)for(g=7;0<=g;--g)r=m[t+g]*K[20+g]+m[t+-1-g]*S[28+g],d=m[t+g]*S[28+g]-m[t+-1-g]*K[20+g],m[t+-1-g]=r,m[t+g]=d}}y=b;x=286;if(1==e.mode_gr)for(f=0;18>
f;f++)la.arraycopy(e.sb_sample[G][1][f],0,e.sb_sample[G][0][f],0,32)}}}function $b(){this.thm=new Nc;this.en=new Nc}function v(){var D=v.FFTOFFSET,B=v.MPG_MD_MS_LR,F=null,N=this.psy=null,O=null,K=null;this.setModules=function(p,e,y,b){F=p;N=this.psy=e;O=b;K=y};var S=new td;this.lame_encode_mp3_frame=function(p,e,y,b,x,G){var f=Vc([2,2]);f[0][0]=new $b;f[0][1]=new $b;f[1][0]=new $b;f[1][1]=new $b;var k=Vc([2,2]);k[0][0]=new $b;k[0][1]=new $b;k[1][0]=new $b;k[1][1]=new $b;var c=[null,null],m=p.internal_flags,
t=Ja([2,4]),r=[.5,.5],d=[[0,0],[0,0]],g=[[0,0],[0,0]];c[0]=e;c[1]=y;if(0==m.lame_encode_frame_init){e=p.internal_flags;var h,q;if(0==e.lame_encode_frame_init){y=W(2014);var a=W(2014);e.lame_encode_frame_init=1;for(q=h=0;h<286+576*(1+e.mode_gr);++h)h<576*e.mode_gr?(y[h]=0,2==e.channels_out&&(a[h]=0)):(y[h]=c[0][q],2==e.channels_out&&(a[h]=c[1][q]),++q);for(q=0;q<e.mode_gr;q++)for(h=0;h<e.channels_out;h++)e.l3_side.tt[q][h].block_type=v.SHORT_TYPE;S.mdct_sub48(e,y,a)}}m.padding=0;0>(m.slot_lag-=m.frac_SpF)&&
(m.slot_lag+=p.out_samplerate,m.padding=1);if(0!=m.psymodel)for(a=[null,null],h=0,q=ka(2),y=0;y<m.mode_gr;y++){for(e=0;e<m.channels_out;e++)a[e]=c[e],h=576+576*y-v.FFTOFFSET;e=p.VBR==aa.vbr_mtrh||p.VBR==aa.vbr_mt?N.L3psycho_anal_vbr(p,a,h,y,f,k,d[y],g[y],t[y],q):N.L3psycho_anal_ns(p,a,h,y,f,k,d[y],g[y],t[y],q);if(0!=e)return-4;p.mode==Ca.JOINT_STEREO&&(r[y]=t[y][2]+t[y][3],0<r[y]&&(r[y]=t[y][3]/r[y]));for(e=0;e<m.channels_out;e++){var l=m.l3_side.tt[y][e];l.block_type=q[e];l.mixed_block_flag=0}}else for(y=
0;y<m.mode_gr;y++)for(e=0;e<m.channels_out;e++)m.l3_side.tt[y][e].block_type=v.NORM_TYPE,m.l3_side.tt[y][e].mixed_block_flag=0,g[y][e]=d[y][e]=700;0==m.ATH.useAdjust?m.ATH.adjust=1:(e=m.loudness_sq[0][0],t=m.loudness_sq[1][0],2==m.channels_out?(e+=m.loudness_sq[0][1],t+=m.loudness_sq[1][1]):(e+=e,t+=t),2==m.mode_gr&&(e=Math.max(e,t)),e=.5*e*m.ATH.aaSensitivityP,.03125<e?(1<=m.ATH.adjust?m.ATH.adjust=1:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=1):(t=31.98*e+
6.25E-4,m.ATH.adjust>=t?(m.ATH.adjust*=.075*t+.925,m.ATH.adjust<t&&(m.ATH.adjust=t)):m.ATH.adjustLimit>=t?m.ATH.adjust=t:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=t));S.mdct_sub48(m,c[0],c[1]);m.mode_ext=v.MPG_MD_LR_LR;if(p.force_ms)m.mode_ext=v.MPG_MD_MS_LR;else if(p.mode==Ca.JOINT_STEREO){for(y=a=t=0;y<m.mode_gr;y++)for(e=0;e<m.channels_out;e++)t+=g[y][e],a+=d[y][e];t<=1*a&&(t=m.l3_side.tt[0],e=m.l3_side.tt[m.mode_gr-1],t[0].block_type==t[1].block_type&&
e[0].block_type==e[1].block_type&&(m.mode_ext=v.MPG_MD_MS_LR))}m.mode_ext==B&&(f=k,d=g);if(p.analysis&&null!=m.pinfo)for(y=0;y<m.mode_gr;y++)for(e=0;e<m.channels_out;e++)m.pinfo.ms_ratio[y]=m.ms_ratio[y],m.pinfo.ms_ener_ratio[y]=r[y],m.pinfo.blocktype[y][e]=m.l3_side.tt[y][e].block_type,m.pinfo.pe[y][e]=d[y][e],la.arraycopy(m.l3_side.tt[y][e].xr,0,m.pinfo.xr[y][e],0,576),m.mode_ext==B&&(m.pinfo.ers[y][e]=m.pinfo.ers[y][e+2],la.arraycopy(m.pinfo.energy[y][e+2],0,m.pinfo.energy[y][e],0,m.pinfo.energy[y][e].length));
if(p.VBR==aa.vbr_off||p.VBR==aa.vbr_abr){for(k=0;18>k;k++)m.nsPsy.pefirbuf[k]=m.nsPsy.pefirbuf[k+1];for(y=g=0;y<m.mode_gr;y++)for(e=0;e<m.channels_out;e++)g+=d[y][e];m.nsPsy.pefirbuf[18]=g;g=m.nsPsy.pefirbuf[9];for(k=0;9>k;k++)g+=(m.nsPsy.pefirbuf[k]+m.nsPsy.pefirbuf[18-k])*v.fircoef[k];g=3350*m.mode_gr*m.channels_out/g;for(y=0;y<m.mode_gr;y++)for(e=0;e<m.channels_out;e++)d[y][e]*=g}m.iteration_loop.iteration_loop(p,d,r,f);F.format_bitstream(p);b=F.copy_buffer(m,b,x,G,1);p.bWriteVbrTag&&O.addVbrFrame(p);
if(p.analysis&&null!=m.pinfo){for(e=0;e<m.channels_out;e++){for(x=0;x<D;x++)m.pinfo.pcmdata[e][x]=m.pinfo.pcmdata[e][x+p.framesize];for(x=D;1600>x;x++)m.pinfo.pcmdata[e][x]=c[e][x-D]}K.set_frame_pinfo(p,f)}m.bitrate_stereoMode_Hist[m.bitrate_index][4]++;m.bitrate_stereoMode_Hist[15][4]++;2==m.channels_out&&(m.bitrate_stereoMode_Hist[m.bitrate_index][m.mode_ext]++,m.bitrate_stereoMode_Hist[15][m.mode_ext]++);for(p=0;p<m.mode_gr;++p)for(c=0;c<m.channels_out;++c)x=m.l3_side.tt[p][c].block_type|0,0!=
m.l3_side.tt[p][c].mixed_block_flag&&(x=4),m.bitrate_blockType_Hist[m.bitrate_index][x]++,m.bitrate_blockType_Hist[m.bitrate_index][5]++,m.bitrate_blockType_Hist[15][x]++,m.bitrate_blockType_Hist[15][5]++;return b}}function ud(){this.size=this.pos=this.want=this.seen=this.sum=0;this.bag=null;this.TotalFrameSize=this.nBytesWritten=this.nVbrNumFrames=0}function vd(){this.tt=[[null,null],[null,null]];this.resvDrain_post=this.resvDrain_pre=this.private_bits=this.main_data_begin=0;this.scfsi=[ka(4),ka(4)];
for(var D=0;2>D;D++)for(var B=0;2>B;B++)this.tt[D][B]=new Lc}function wd(){this.last_en_subshort=Ja([4,9]);this.lastAttacks=ka(4);this.pefirbuf=W(19);this.longfact=W(v.SBMAX_l);this.shortfact=W(v.SBMAX_s);this.attackthre_s=this.attackthre=0}function Nc(){this.l=W(v.SBMAX_l);this.s=Ja([v.SBMAX_s,3]);var D=this;this.assign=function(B){la.arraycopy(B.l,0,D.l,0,v.SBMAX_l);for(var F=0;F<v.SBMAX_s;F++)for(var N=0;3>N;N++)D.s[F][N]=B.s[F][N]}}function Ba(){function D(){this.ptr=this.write_timing=0;this.buf=
new Int8Array(40)}this.fill_buffer_resample_init=this.iteration_init_init=this.lame_encode_frame_init=this.Class_ID=0;this.mfbuf=Ja([2,Ba.MFSIZE]);this.full_outer_loop=this.use_best_huffman=this.subblock_gain=this.noise_shaping_stop=this.psymodel=this.substep_shaping=this.noise_shaping_amp=this.noise_shaping=this.highpass2=this.highpass1=this.lowpass2=this.lowpass1=this.mode_ext=this.samplerate_index=this.bitrate_index=this.VBR_max_bitrate=this.VBR_min_bitrate=this.mf_size=this.mf_samples_to_encode=
this.resample_ratio=this.channels_out=this.channels_in=this.mode_gr=0;this.l3_side=new vd;this.ms_ratio=W(2);this.slot_lag=this.frac_SpF=this.padding=0;this.tag_spec=null;this.nMusicCRC=0;this.OldValue=ka(2);this.CurrentStep=ka(2);this.masking_lower=0;this.bv_scf=ka(576);this.pseudohalf=ka(Cb.SFBMAX);this.sfb21_extra=!1;this.inbuf_old=Array(2);this.blackfilt=Array(2*Ba.BPC+1);this.itime=new Float64Array(2);this.sideinfo_len=0;this.sb_sample=Ja([2,2,18,v.SBLIMIT]);this.amp_filter=W(32);this.header=
Array(Ba.MAX_HEADER_BUF);this.ResvMax=this.ResvSize=this.ancillary_flag=this.w_ptr=this.h_ptr=0;this.scalefac_band=new Kb;this.minval_l=W(v.CBANDS);this.minval_s=W(v.CBANDS);this.nb_1=Ja([4,v.CBANDS]);this.nb_2=Ja([4,v.CBANDS]);this.nb_s1=Ja([4,v.CBANDS]);this.nb_s2=Ja([4,v.CBANDS]);this.s3_ll=this.s3_ss=null;this.decay=0;this.thm=Array(4);this.en=Array(4);this.tot_ener=W(4);this.loudness_sq=Ja([2,2]);this.loudness_sq_save=W(2);this.mld_l=W(v.SBMAX_l);this.mld_s=W(v.SBMAX_s);this.bm_l=ka(v.SBMAX_l);
this.bo_l=ka(v.SBMAX_l);this.bm_s=ka(v.SBMAX_s);this.bo_s=ka(v.SBMAX_s);this.npart_s=this.npart_l=0;this.s3ind=ic([v.CBANDS,2]);this.s3ind_s=ic([v.CBANDS,2]);this.numlines_s=ka(v.CBANDS);this.numlines_l=ka(v.CBANDS);this.rnumlines_l=W(v.CBANDS);this.mld_cb_l=W(v.CBANDS);this.mld_cb_s=W(v.CBANDS);this.numlines_l_num1=this.numlines_s_num1=0;this.pe=W(4);this.ms_ener_ratio_old=this.ms_ratio_l_old=this.ms_ratio_s_old=0;this.blocktype_old=ka(2);this.nsPsy=new wd;this.VBR_seek_table=new ud;this.PSY=this.ATH=
null;this.nogap_current=this.nogap_total=0;this.findPeakSample=this.findReplayGain=this.decode_on_the_fly=!0;this.AudiophileGain=this.RadioGain=this.PeakSample=0;this.rgdata=null;this.noclipScale=this.noclipGainChange=0;this.bitrate_stereoMode_Hist=ic([16,5]);this.bitrate_blockType_Hist=ic([16,6]);this.hip=this.pinfo=null;this.in_buffer_nsamples=0;this.iteration_loop=this.in_buffer_1=this.in_buffer_0=null;for(var B=0;B<this.en.length;B++)this.en[B]=new Nc;for(B=0;B<this.thm.length;B++)this.thm[B]=
new Nc;for(B=0;B<this.header.length;B++)this.header[B]=new D}function fb(){function D(f,k){k=O.ATHformula(k,f);return k=Math.pow(10,(k-100)/10+f.ATHlower)}function B(f){this.s=f}var F=null,N=null,O=null;this.setModules=function(f,k,c){F=f;N=k;O=c};this.IPOW20=function(f){return b[f]};var K=fb.IXMAX_VAL+2,S=fb.Q_MAX,p=fb.Q_MAX2;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],
[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var e=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=e;this.sfBandIndex=[new Kb([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,6,12,18,24,30,36,44,
54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,4,8,12,16,20,24,30,36,44,54,66,82,
102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Kb([0,12,24,36,48,60,72,88,108,132,160,192,232,280,
336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var y=W(S+p+1),b=W(S),x=W(K),G=W(K);this.adj43=G;this.iteration_init=function(f){var k=f.internal_flags,c=k.l3_side;if(0==k.iteration_init_init){k.iteration_init_init=1;c.main_data_begin=0;c=f.internal_flags.ATH.l;for(var m=f.internal_flags.ATH.psfb21,t=f.internal_flags.ATH.s,r=f.internal_flags.ATH.psfb12,d=f.internal_flags,g=f.out_samplerate,h=0;h<v.SBMAX_l;h++){var q=d.scalefac_band.l[h],
a=d.scalefac_band.l[h+1];for(c[h]=qc.MAX_VALUE;q<a;q++){var l=q*g/1152;l=D(f,l);c[h]=Math.min(c[h],l)}}for(h=0;h<v.PSFB21;h++)for(q=d.scalefac_band.psfb21[h],a=d.scalefac_band.psfb21[h+1],m[h]=qc.MAX_VALUE;q<a;q++)l=q*g/1152,l=D(f,l),m[h]=Math.min(m[h],l);for(h=0;h<v.SBMAX_s;h++){q=d.scalefac_band.s[h];a=d.scalefac_band.s[h+1];for(t[h]=qc.MAX_VALUE;q<a;q++)l=q*g/384,l=D(f,l),t[h]=Math.min(t[h],l);t[h]*=d.scalefac_band.s[h+1]-d.scalefac_band.s[h]}for(h=0;h<v.PSFB12;h++){q=d.scalefac_band.psfb12[h];
a=d.scalefac_band.psfb12[h+1];for(r[h]=qc.MAX_VALUE;q<a;q++)l=q*g/384,l=D(f,l),r[h]=Math.min(r[h],l);r[h]*=d.scalefac_band.s[13]-d.scalefac_band.s[12]}if(f.noATH){for(h=0;h<v.SBMAX_l;h++)c[h]=1E-20;for(h=0;h<v.PSFB21;h++)m[h]=1E-20;for(h=0;h<v.SBMAX_s;h++)t[h]=1E-20;for(h=0;h<v.PSFB12;h++)r[h]=1E-20}d.ATH.floor=10*Math.log10(D(f,-1));x[0]=0;for(c=1;c<K;c++)x[c]=Math.pow(c,4/3);for(c=0;c<K-1;c++)G[c]=c+1-Math.pow(.5*(x[c]+x[c+1]),.75);G[c]=.5;for(c=0;c<S;c++)b[c]=Math.pow(2,-.1875*(c-210));for(c=0;c<=
S+p;c++)y[c]=Math.pow(2,.25*(c-210-p));F.huffman_init(k);c=f.exp_nspsytune>>2&63;32<=c&&(c-=64);m=Math.pow(10,c/4/10);c=f.exp_nspsytune>>8&63;32<=c&&(c-=64);t=Math.pow(10,c/4/10);c=f.exp_nspsytune>>14&63;32<=c&&(c-=64);r=Math.pow(10,c/4/10);c=f.exp_nspsytune>>20&63;32<=c&&(c-=64);f=r*Math.pow(10,c/4/10);for(c=0;c<v.SBMAX_l;c++)d=6>=c?m:13>=c?t:20>=c?r:f,k.nsPsy.longfact[c]=d;for(c=0;c<v.SBMAX_s;c++)d=5>=c?m:10>=c?t:11>=c?r:f,k.nsPsy.shortfact[c]=d}};this.on_pe=function(f,k,c,m,t,r){var d=f.internal_flags,
g=0,h=ka(2),q;g=new jc(g);f=N.ResvMaxBits(f,m,g,r);g=g.bits;var a=g+f;a>Ba.MAX_BITS_PER_GRANULE&&(a=Ba.MAX_BITS_PER_GRANULE);for(q=r=0;q<d.channels_out;++q)c[q]=Math.min(Ba.MAX_BITS_PER_CHANNEL,g/d.channels_out),h[q]=0|c[q]*k[t][q]/700-c[q],h[q]>3*m/4&&(h[q]=3*m/4),0>h[q]&&(h[q]=0),h[q]+c[q]>Ba.MAX_BITS_PER_CHANNEL&&(h[q]=Math.max(0,Ba.MAX_BITS_PER_CHANNEL-c[q])),r+=h[q];if(r>f)for(q=0;q<d.channels_out;++q)h[q]=f*h[q]/r;for(q=0;q<d.channels_out;++q)c[q]+=h[q],f-=h[q];for(q=r=0;q<d.channels_out;++q)r+=
c[q];if(r>Ba.MAX_BITS_PER_GRANULE)for(q=0;q<d.channels_out;++q)c[q]*=Ba.MAX_BITS_PER_GRANULE,c[q]/=r;return a};this.reduce_side=function(f,k,c,m){k=.33*(.5-k)/.5;0>k&&(k=0);.5<k&&(k=.5);k=0|.5*k*(f[0]+f[1]);k>Ba.MAX_BITS_PER_CHANNEL-f[0]&&(k=Ba.MAX_BITS_PER_CHANNEL-f[0]);0>k&&(k=0);125<=f[1]&&(125<f[1]-k?(f[0]<c&&(f[0]+=k),f[1]-=k):(f[0]+=f[1]-125,f[1]=125));k=f[0]+f[1];k>m&&(f[0]=m*f[0]/k,f[1]=m*f[1]/k)};this.athAdjust=function(f,k,c){k=na.FAST_LOG10_X(k,10);f*=f;var m=0;k-=c;1E-20<f&&(m=1+na.FAST_LOG10_X(f,
10/90.30873362));0>m&&(m=0);return Math.pow(10,.1*(k*m+(c+90.30873362-94.82444863)))};this.calc_xmin=function(f,k,c,m){var t=0,r=f.internal_flags,d,g=0,h=0,q=r.ATH,a=c.xr,l=f.VBR==aa.vbr_mtrh?1:0,n=r.masking_lower;if(f.VBR==aa.vbr_mtrh||f.VBR==aa.vbr_mt)n=1;for(d=0;d<c.psy_lmax;d++){var u=f.VBR==aa.vbr_rh||f.VBR==aa.vbr_mtrh?athAdjust(q.adjust,q.l[d],q.floor):q.adjust*q.l[d];var A=c.width[d];var L=u/A;var I=2.220446049250313E-16;var P=A>>1;var w=0;do{var z=a[g]*a[g];w+=z;I+=z<L?z:L;g++;z=a[g]*a[g];
w+=z;I+=z<L?z:L;g++}while(0<--P);w>u&&h++;d==v.SBPSY_l&&(L=u*r.nsPsy.longfact[d],I<L&&(I=L));0!=l&&(u=I);f.ATHonly||(I=k.en.l[d],0<I&&(L=w*k.thm.l[d]*n/I,0!=l&&(L*=r.nsPsy.longfact[d]),u<L&&(u=L)));0!=l?m[t++]=u:m[t++]=u*r.nsPsy.longfact[d]}w=575;if(c.block_type!=v.SHORT_TYPE)for(u=576;0!=u--&&Wa.EQ(a[u],0);)w=u;c.max_nonzero_coeff=w;for(var C=c.sfb_smin;d<c.psymax;C++,d+=3){var E;var Q=f.VBR==aa.vbr_rh||f.VBR==aa.vbr_mtrh?athAdjust(q.adjust,q.s[C],q.floor):q.adjust*q.s[C];A=c.width[d];for(E=0;3>
E;E++){w=0;P=A>>1;L=Q/A;I=2.220446049250313E-16;do z=a[g]*a[g],w+=z,I+=z<L?z:L,g++,z=a[g]*a[g],w+=z,I+=z<L?z:L,g++;while(0<--P);w>Q&&h++;C==v.SBPSY_s&&(L=Q*r.nsPsy.shortfact[C],I<L&&(I=L));u=0!=l?I:Q;f.ATHonly||f.ATHshort||(I=k.en.s[C][E],0<I&&(L=w*k.thm.s[C][E]*n/I,0!=l&&(L*=r.nsPsy.shortfact[C]),u<L&&(u=L)));0!=l?m[t++]=u:m[t++]=u*r.nsPsy.shortfact[C]}f.useTemporal&&(m[t-3]>m[t-3+1]&&(m[t-3+1]+=(m[t-3]-m[t-3+1])*r.decay),m[t-3+1]>m[t-3+2]&&(m[t-3+2]+=(m[t-3+1]-m[t-3+2])*r.decay))}return h};this.calc_noise_core=
function(f,k,c,m){var t=0,r=k.s,d=f.l3_enc;if(r>f.count1)for(;0!=c--;){var g=f.xr[r];r++;t+=g*g;g=f.xr[r];r++;t+=g*g}else if(r>f.big_values){var h=W(2);h[0]=0;for(h[1]=m;0!=c--;)g=Math.abs(f.xr[r])-h[d[r]],r++,t+=g*g,g=Math.abs(f.xr[r])-h[d[r]],r++,t+=g*g}else for(;0!=c--;)g=Math.abs(f.xr[r])-x[d[r]]*m,r++,t+=g*g,g=Math.abs(f.xr[r])-x[d[r]]*m,r++,t+=g*g;k.s=r;return t};this.calc_noise=function(f,k,c,m,t){var r=0,d=0,g,h=0,q=0,a=0,l=-20,n=0,u=f.scalefac,A=0;for(g=m.over_SSD=0;g<f.psymax;g++){var L=
f.global_gain-(u[A++]+(0!=f.preflag?e[g]:0)<<f.scalefac_scale+1)-8*f.subblock_gain[f.window[g]];if(null!=t&&t.step[g]==L){var I=t.noise[g];n+=f.width[g];c[r++]=I/k[d++];I=t.noise_log[g]}else{I=y[L+fb.Q_MAX2];var P=f.width[g]>>1;n+f.width[g]>f.max_nonzero_coeff&&(P=f.max_nonzero_coeff-n+1,P=0<P?P>>1:0);n=new B(n);I=this.calc_noise_core(f,n,P,I);n=n.s;null!=t&&(t.step[g]=L,t.noise[g]=I);I=c[r++]=I/k[d++];I=na.FAST_LOG10(Math.max(I,1E-20));null!=t&&(t.noise_log[g]=I)}null!=t&&(t.global_gain=f.global_gain);
a+=I;0<I&&(L=Math.max(0|10*I+.5,1),m.over_SSD+=L*L,h++,q+=I);l=Math.max(l,I)}m.over_count=h;m.tot_noise=a;m.over_noise=q;m.max_noise=l;return h};this.set_pinfo=function(f,k,c,m,t){var r=f.internal_flags,d,g,h=0==k.scalefac_scale?.5:1,q=k.scalefac,a=W(Cb.SFBMAX),l=W(Cb.SFBMAX),n=new Mc;calc_xmin(f,c,k,a);calc_noise(k,a,l,n,null);var u=0;var A=k.sfb_lmax;k.block_type!=v.SHORT_TYPE&&0==k.mixed_block_flag&&(A=22);for(d=0;d<A;d++){var L=r.scalefac_band.l[d],I=r.scalefac_band.l[d+1],P=I-L;for(g=0;u<I;u++)g+=
k.xr[u]*k.xr[u];g/=P;var w=1E15;r.pinfo.en[m][t][d]=w*g;r.pinfo.xfsf[m][t][d]=w*a[d]*l[d]/P;g=0<c.en.l[d]&&!f.ATHonly?g/c.en.l[d]:0;r.pinfo.thr[m][t][d]=w*Math.max(g*c.thm.l[d],r.ATH.l[d]);r.pinfo.LAMEsfb[m][t][d]=0;0!=k.preflag&&11<=d&&(r.pinfo.LAMEsfb[m][t][d]=-h*e[d]);d<v.SBPSY_l&&(r.pinfo.LAMEsfb[m][t][d]-=h*q[d])}if(k.block_type==v.SHORT_TYPE)for(A=d,d=k.sfb_smin;d<v.SBMAX_s;d++){L=r.scalefac_band.s[d];I=r.scalefac_band.s[d+1];P=I-L;for(var z=0;3>z;z++){g=0;for(w=L;w<I;w++)g+=k.xr[u]*k.xr[u],
u++;g=Math.max(g/P,1E-20);w=1E15;r.pinfo.en_s[m][t][3*d+z]=w*g;r.pinfo.xfsf_s[m][t][3*d+z]=w*a[A]*l[A]/P;g=0<c.en.s[d][z]?g/c.en.s[d][z]:0;if(f.ATHonly||f.ATHshort)g=0;r.pinfo.thr_s[m][t][3*d+z]=w*Math.max(g*c.thm.s[d][z],r.ATH.s[d]);r.pinfo.LAMEsfb_s[m][t][3*d+z]=-2*k.subblock_gain[z];d<v.SBPSY_s&&(r.pinfo.LAMEsfb_s[m][t][3*d+z]-=h*q[A]);A++}}r.pinfo.LAMEqss[m][t]=k.global_gain;r.pinfo.LAMEmainbits[m][t]=k.part2_3_length+k.part2_length;r.pinfo.LAMEsfbits[m][t]=k.part2_length;r.pinfo.over[m][t]=n.over_count;
r.pinfo.max_noise[m][t]=10*n.max_noise;r.pinfo.over_noise[m][t]=10*n.over_noise;r.pinfo.tot_noise[m][t]=10*n.tot_noise;r.pinfo.over_SSD[m][t]=n.over_SSD}}function xd(){function D(K,S,p){var e=0;p<<=1;var y=S+p;var b=4;do{var x;var G=b>>1;var f=b;var k=b<<1;var c=k+f;b=k<<1;var m=S;var t=m+G;do{var r=K[m+0]-K[m+f];var d=K[m+0]+K[m+f];var g=K[m+k]-K[m+c];var h=K[m+k]+K[m+c];K[m+k]=d-h;K[m+0]=d+h;K[m+c]=r-g;K[m+f]=r+g;r=K[t+0]-K[t+f];d=K[t+0]+K[t+f];g=na.SQRT2*K[t+c];h=na.SQRT2*K[t+k];K[t+k]=d-h;K[t+
0]=d+h;K[t+c]=r-g;K[t+f]=r+g;t+=b;m+=b}while(m<y);var q=N[e+0];var a=N[e+1];for(x=1;x<G;x++){var l=1-2*a*a;var n=2*a*q;m=S+x;t=S+f-x;do{var u=n*K[m+f]-l*K[t+f];h=l*K[m+f]+n*K[t+f];r=K[m+0]-h;d=K[m+0]+h;var A=K[t+0]-u;var L=K[t+0]+u;u=n*K[m+c]-l*K[t+c];h=l*K[m+c]+n*K[t+c];g=K[m+k]-h;h=K[m+k]+h;var I=K[t+k]-u;var P=K[t+k]+u;u=a*h-q*I;h=q*h+a*I;K[m+k]=d-h;K[m+0]=d+h;K[t+c]=A-u;K[t+f]=A+u;u=q*P-a*g;h=a*P+q*g;K[t+k]=L-h;K[t+0]=L+h;K[m+c]=r-u;K[m+f]=r+u;t+=b;m+=b}while(m<y);l=q;q=l*N[e+0]-a*N[e+1];a=l*
N[e+1]+a*N[e+0]}e+=2}while(b<p)}var B=W(v.BLKSIZE),F=W(v.BLKSIZE_s/2),N=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475],O=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,
242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(K,S,p,e,y){for(K=0;3>K;K++){var b=v.BLKSIZE_s/2,x=65535&192*(K+1),G=v.BLKSIZE_s/8-1;do{var f=O[G<<2]&255;var k=F[f]*e[p][y+f+x];var c=F[127-f]*e[p][y+f+x+128];var m=k-c;k+=c;var t=F[f+64]*e[p][y+f+x+64];c=F[63-f]*e[p][y+f+x+192];var r=t-c;t+=c;b-=4;S[K][b+0]=k+t;S[K][b+2]=k-t;S[K][b+1]=m+r;S[K][b+3]=
m-r;k=F[f+1]*e[p][y+f+x+1];c=F[126-f]*e[p][y+f+x+129];m=k-c;k+=c;t=F[f+65]*e[p][y+f+x+65];c=F[62-f]*e[p][y+f+x+193];r=t-c;t+=c;S[K][b+v.BLKSIZE_s/2+0]=k+t;S[K][b+v.BLKSIZE_s/2+2]=k-t;S[K][b+v.BLKSIZE_s/2+1]=m+r;S[K][b+v.BLKSIZE_s/2+3]=m-r}while(0<=--G);D(S[K],b,v.BLKSIZE_s/2)}};this.fft_long=function(K,S,p,e,y){K=v.BLKSIZE/8-1;var b=v.BLKSIZE/2;do{var x=O[K]&255;var G=B[x]*e[p][y+x];var f=B[x+512]*e[p][y+x+512];var k=G-f;G+=f;var c=B[x+256]*e[p][y+x+256];f=B[x+768]*e[p][y+x+768];var m=c-f;c+=f;b-=
4;S[b+0]=G+c;S[b+2]=G-c;S[b+1]=k+m;S[b+3]=k-m;G=B[x+1]*e[p][y+x+1];f=B[x+513]*e[p][y+x+513];k=G-f;G+=f;c=B[x+257]*e[p][y+x+257];f=B[x+769]*e[p][y+x+769];m=c-f;c+=f;S[b+v.BLKSIZE/2+0]=G+c;S[b+v.BLKSIZE/2+2]=G-c;S[b+v.BLKSIZE/2+1]=k+m;S[b+v.BLKSIZE/2+3]=k-m}while(0<=--K);D(S,b,v.BLKSIZE/2)};this.init_fft=function(K){for(K=0;K<v.BLKSIZE;K++)B[K]=.42-.5*Math.cos(2*Math.PI*(K+.5)/v.BLKSIZE)+.08*Math.cos(4*Math.PI*(K+.5)/v.BLKSIZE);for(K=0;K<v.BLKSIZE_s/2;K++)F[K]=.5*(1-Math.cos(2*Math.PI*(K+.5)/v.BLKSIZE_s))}}
function Wc(){function D(w,z){for(var C=0,E=0;E<v.BLKSIZE/2;++E)C+=w[E]*z.ATH.eql_w[E];return C*=r}function B(w,z,C,E,Q,H){if(z>w)if(z<w*g)var M=z/w;else return w+z;else{if(w>=z*g)return w+z;M=w/z}w+=z;if(6>=E+3){if(M>=d)return w;E=0|na.FAST_LOG10_X(M,16);return w*l[E]}E=0|na.FAST_LOG10_X(M,16);z=0!=H?Q.ATH.cb_s[C]*Q.ATH.adjust:Q.ATH.cb_l[C]*Q.ATH.adjust;return w<h*z?w>z?(C=1,13>=E&&(C=n[E]),z=na.FAST_LOG10_X(w/z,10/15),w*((a[E]-C)*z+C)):13<E?w:w*n[E]:w*a[E]}function F(w,z,C){0>w&&(w=0);0>z&&(z=0);
if(0>=w)return z;if(0>=z)return w;var E=z>w?z/w:w/z;if(-2<=C&&2>=C){if(E>=d)return w+z;C=0|na.FAST_LOG10_X(E,16);return(w+z)*u[C]}if(E<g)return w+z;w<z&&(w=z);return w}function N(w,z,C,E,Q){var H,M,ca=0,Y=0;for(H=M=0;H<v.SBMAX_s;++M,++H){var U=w.bo_s[H],J=w.npart_s;for(U=U<J?U:J;M<U;)ca+=z[M],Y+=C[M],M++;w.en[E].s[H][Q]=ca;w.thm[E].s[H][Q]=Y;if(M>=J){++H;break}Y=w.PSY.bo_s_weight[H];J=1-Y;ca=Y*z[M];Y*=C[M];w.en[E].s[H][Q]+=ca;w.thm[E].s[H][Q]+=Y;ca=J*z[M];Y=J*C[M]}for(;H<v.SBMAX_s;++H)w.en[E].s[H][Q]=
0,w.thm[E].s[H][Q]=0}function O(w,z,C,E){var Q,H,M=0,ca=0;for(Q=H=0;Q<v.SBMAX_l;++H,++Q){var Y=w.bo_l[Q],U=w.npart_l;for(Y=Y<U?Y:U;H<Y;)M+=z[H],ca+=C[H],H++;w.en[E].l[Q]=M;w.thm[E].l[Q]=ca;if(H>=U){++Q;break}ca=w.PSY.bo_l_weight[Q];U=1-ca;M=ca*z[H];ca*=C[H];w.en[E].l[Q]+=M;w.thm[E].l[Q]+=ca;M=U*z[H];ca=U*C[H]}for(;Q<v.SBMAX_l;++Q)w.en[E].l[Q]=0,w.thm[E].l[Q]=0}function K(w,z,C){return 1<=C?w:0>=C?z:0<z?Math.pow(w/z,C)*z:0}function S(w,z){for(var C=309.07,E=0;E<v.SBMAX_s-1;E++)for(var Q=0;3>Q;Q++){var H=
w.thm.s[E][Q];if(0<H){H*=z;var M=w.en.s[E][Q];M>H&&(C=M>1E10*H?C+23.02585092994046*A[E]:C+A[E]*na.FAST_LOG10(M/H))}}return C}function p(w,z){for(var C=281.0575,E=0;E<v.SBMAX_l-1;E++){var Q=w.thm.l[E];if(0<Q){Q*=z;var H=w.en.l[E];H>Q&&(C=H>1E10*Q?C+23.02585092994046*L[E]:C+L[E]*na.FAST_LOG10(H/Q))}}return C}function e(w,z,C,E,Q){var H,M;for(H=M=0;H<w.npart_l;++H){var ca=0,Y=0,U;for(U=0;U<w.numlines_l[H];++U,++M){var J=z[M];ca+=J;Y<J&&(Y=J)}C[H]=ca;E[H]=Y;Q[H]=ca*w.rnumlines_l[H]}}function y(w,z,C,
E){var Q=q.length-1,H=0,M=C[H]+C[H+1];if(0<M){var ca=z[H];ca<z[H+1]&&(ca=z[H+1]);M=20*(2*ca-M)/(M*(w.numlines_l[H]+w.numlines_l[H+1]-1));M|=0;M>Q&&(M=Q);E[H]=M}else E[H]=0;for(H=1;H<w.npart_l-1;H++)M=C[H-1]+C[H]+C[H+1],0<M?(ca=z[H-1],ca<z[H]&&(ca=z[H]),ca<z[H+1]&&(ca=z[H+1]),M=20*(3*ca-M)/(M*(w.numlines_l[H-1]+w.numlines_l[H]+w.numlines_l[H+1]-1)),M|=0,M>Q&&(M=Q),E[H]=M):E[H]=0;M=C[H-1]+C[H];0<M?(ca=z[H-1],ca<z[H]&&(ca=z[H]),M=20*(2*ca-M)/(M*(w.numlines_l[H-1]+w.numlines_l[H]-1)),M|=0,M>Q&&(M=Q),
E[H]=M):E[H]=0}function b(w,z,C,E,Q,H,M){var ca=2*H;Q=0<H?Math.pow(10,Q):1;for(var Y,U,J=0;J<M;++J){var ma=w[2][J],qa=w[3][J],ba=z[0][J],X=z[1][J],xa=z[2][J],ha=z[3][J];ba<=1.58*X&&X<=1.58*ba?(Y=C[J]*ma,U=Math.max(xa,Math.min(ha,C[J]*qa)),Y=Math.max(ha,Math.min(xa,Y))):(U=xa,Y=ha);0<H&&(ha=E[J]*Q,ba=Math.min(Math.max(ba,ha),Math.max(X,ha)),xa=Math.max(U,ha),ha=Math.max(Y,ha),X=xa+ha,0<X&&ba*ca<X&&(ba=ba*ca/X,xa*=ba,ha*=ba),U=Math.min(xa,U),Y=Math.min(ha,Y));U>ma&&(U=ma);Y>qa&&(Y=qa);z[2][J]=U;z[3][J]=
Y}}function x(w,z){w=0<=w?27*-w:w*z;return-72>=w?0:Math.exp(.2302585093*w)}function G(w){0>w&&(w=0);w*=.001;return 13*Math.atan(.76*w)+3.5*Math.atan(w*w/56.25)}function f(w,z,C,E,Q,H,M,ca,Y,U,J,ma){var qa=W(v.CBANDS+1),ba=ca/(15<ma?1152:384),X=ka(v.HBLKSIZE),xa;ca/=Y;var ha=0,Ka=0;for(xa=0;xa<v.CBANDS;xa++){var V;var va=G(ca*ha);qa[xa]=ca*ha;for(V=ha;.34>G(ca*V)-va&&V<=Y/2;V++);w[xa]=V-ha;for(Ka=xa+1;ha<V;)X[ha++]=xa;if(ha>Y/2){ha=Y/2;++xa;break}}qa[xa]=ca*ha;for(ha=0;ha<ma;ha++)xa=U[ha],va=U[ha+
1],xa=0|Math.floor(.5+J*(xa-.5)),0>xa&&(xa=0),V=0|Math.floor(.5+J*(va-.5)),V>Y/2&&(V=Y/2),C[ha]=(X[xa]+X[V])/2,z[ha]=X[V],M[ha]=(ba*va-qa[z[ha]])/(qa[z[ha]+1]-qa[z[ha]]),0>M[ha]?M[ha]=0:1<M[ha]&&(M[ha]=1),va=G(ca*U[ha]*J),va=Math.min(va,15.5)/15.5,H[ha]=Math.pow(10,1.25*(1-Math.cos(Math.PI*va))-2.5);for(z=ha=0;z<Ka;z++)C=w[z],va=G(ca*ha),H=G(ca*(ha+C-1)),E[z]=.5*(va+H),va=G(ca*(ha-.5)),H=G(ca*(ha+C-.5)),Q[z]=H-va,ha+=C;return Ka}function k(w,z,C,E,Q,H){var M=Ja([v.CBANDS,v.CBANDS]),ca=0;if(H)for(var Y=
0;Y<z;Y++)for(H=0;H<z;H++){var U=C[Y]-C[H];U=0<=U?3*U:1.5*U;if(.5<=U&&2.5>=U){var J=U-.5;J=8*(J*J-2*J)}else J=0;U+=.474;U=15.811389+7.5*U-17.5*Math.sqrt(1+U*U);-60>=U?J=0:(U=Math.exp(.2302585093*(J+U)),J=U/.6609193);U=J*E[H];M[Y][H]=U*Q[Y]}else for(H=0;H<z;H++){J=15+Math.min(21/C[H],12);var ma;var qa;Y=J;for(ma=0;1E-20<x(ma,Y);--ma);var ba=ma;for(qa=0;1E-12<Math.abs(qa-ba);)ma=(qa+ba)/2,0<x(ma,Y)?qa=ma:ba=ma;U=ba;for(ma=0;1E-20<x(ma,Y);ma+=1);ba=0;for(qa=ma;1E-12<Math.abs(qa-ba);)ma=(qa+ba)/2,0<x(ma,
Y)?ba=ma:qa=ma;ba=qa;var X=0;for(qa=0;1E3>=qa;++qa)ma=U+qa*(ba-U)/1E3,ma=x(ma,Y),X+=ma;ma=1001/(X*(ba-U));for(Y=0;Y<z;Y++)U=ma*x(C[Y]-C[H],J)*E[H],M[Y][H]=U*Q[Y]}for(Y=0;Y<z;Y++){for(H=0;H<z&&!(0<M[Y][H]);H++);w[Y][0]=H;for(H=z-1;0<H&&!(0<M[Y][H]);H--);w[Y][1]=H;ca+=w[Y][1]-w[Y][0]+1}C=W(ca);for(Y=E=0;Y<z;Y++)for(H=w[Y][0];H<=w[Y][1];H++)C[E++]=M[Y][H];return C}function c(w){w=G(w);w=Math.min(w,15.5)/15.5;return Math.pow(10,1.25*(1-Math.cos(Math.PI*w))-2.5)}function m(w,z){-.3>w&&(w=3410);w=Math.max(.1,
w/1E3);return 3.64*Math.pow(w,-.8)-6.8*Math.exp(-.6*Math.pow(w-3.4,2))+6*Math.exp(-.15*Math.pow(w-8.7,2))+.001*(.6+.04*z)*Math.pow(w,4)}var t=new xd,r=1/217621504/(v.BLKSIZE/2),d,g,h,q=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],a=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,
1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],l=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],n=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276],u=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,
1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],A=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130],L=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1],I=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_ns=function(w,z,C,E,Q,H,M,ca,Y,U){var J=w.internal_flags,ma=Ja([2,v.BLKSIZE]),qa=Ja([2,3,v.BLKSIZE_s]),ba=W(v.CBANDS+1),X=W(v.CBANDS+
1),xa=W(v.CBANDS+2),ha=ka(2),Ka=ka(2),V,va,T,wa,bb,ua,fa,Za=Ja([2,576]),$a=ka(v.CBANDS+2),ea=ka(v.CBANDS+2);nb.fill(ea,0);var Ea=J.channels_out;w.mode==Ca.JOINT_STEREO&&(Ea=4);var Z=w.VBR==aa.vbr_off?0==J.ResvMax?0:J.ResvSize/J.ResvMax*.5:w.VBR==aa.vbr_rh||w.VBR==aa.vbr_mtrh||w.VBR==aa.vbr_mt?.6:1;for(V=0;V<J.channels_out;V++){var kb=z[V],ob=C+576-350-21+192;for(T=0;576>T;T++){var Oa;var Sa=kb[ob+T+10];for(wa=Oa=0;9>wa;wa+=2)Sa+=I[wa]*(kb[ob+T+wa]+kb[ob+T+21-wa]),Oa+=I[wa+1]*(kb[ob+T+wa+1]+kb[ob+
T+21-wa-1]);Za[V][T]=Sa+Oa}Q[E][V].en.assign(J.en[V]);Q[E][V].thm.assign(J.thm[V]);2<Ea&&(H[E][V].en.assign(J.en[V+2]),H[E][V].thm.assign(J.thm[V+2]))}for(V=0;V<Ea;V++){var Da=W(12),Pa=[0,0,0,0],Rb=W(12),Sb=1,Oc=W(v.CBANDS),rc=W(v.CBANDS),Fa=[0,0,0,0],Bc=W(v.HBLKSIZE),Pc=Ja([3,v.HBLKSIZE_s]);for(T=0;3>T;T++)Da[T]=J.nsPsy.last_en_subshort[V][T+6],Rb[T]=Da[T]/J.nsPsy.last_en_subshort[V][T+4],Pa[0]+=Da[T];if(2==V)for(T=0;576>T;T++){var pb=Za[0][T];var Cc=Za[1][T];Za[0][T]=pb+Cc;Za[1][T]=pb-Cc}var sc=
Za[V&1],Tb=0;for(T=0;9>T;T++){for(var Dc=Tb+64,Ta=1;Tb<Dc;Tb++)Ta<Math.abs(sc[Tb])&&(Ta=Math.abs(sc[Tb]));J.nsPsy.last_en_subshort[V][T]=Da[T+3]=Ta;Pa[1+T/3]+=Ta;Ta=Ta>Da[T+3-2]?Ta/Da[T+3-2]:Da[T+3-2]>10*Ta?Da[T+3-2]/(10*Ta):0;Rb[T+3]=Ta}if(w.analysis){var Ec=Rb[0];for(T=1;12>T;T++)Ec<Rb[T]&&(Ec=Rb[T]);J.pinfo.ers[E][V]=J.pinfo.ers_save[V];J.pinfo.ers_save[V]=Ec}var tc=3==V?J.nsPsy.attackthre_s:J.nsPsy.attackthre;for(T=0;12>T;T++)0==Fa[T/3]&&Rb[T]>tc&&(Fa[T/3]=T%3+1);for(T=1;4>T;T++)1.7>(Pa[T-1]>
Pa[T]?Pa[T-1]/Pa[T]:Pa[T]/Pa[T-1])&&(Fa[T]=0,1==T&&(Fa[0]=0));0!=Fa[0]&&0!=J.nsPsy.lastAttacks[V]&&(Fa[0]=0);if(3==J.nsPsy.lastAttacks[V]||0!=Fa[0]+Fa[1]+Fa[2]+Fa[3])Sb=0,0!=Fa[1]&&0!=Fa[0]&&(Fa[1]=0),0!=Fa[2]&&0!=Fa[1]&&(Fa[2]=0),0!=Fa[3]&&0!=Fa[2]&&(Fa[3]=0);2>V?Ka[V]=Sb:0==Sb&&(Ka[0]=Ka[1]=0);Y[V]=J.tot_ener[V];var da=w,Ua=Bc,ac=Pc,ab=ma,Db=V&1,gb=qa,cb=V&1,ub=E,La=V,Ha=z,Fc=C,lb=da.internal_flags;if(2>La)t.fft_long(lb,ab[Db],La,Ha,Fc),t.fft_short(lb,gb[cb],La,Ha,Fc);else if(2==La){for(var sa=
v.BLKSIZE-1;0<=sa;--sa){var bc=ab[Db+0][sa],cc=ab[Db+1][sa];ab[Db+0][sa]=(bc+cc)*na.SQRT2*.5;ab[Db+1][sa]=(bc-cc)*na.SQRT2*.5}for(var Ma=2;0<=Ma;--Ma)for(sa=v.BLKSIZE_s-1;0<=sa;--sa)bc=gb[cb+0][Ma][sa],cc=gb[cb+1][Ma][sa],gb[cb+0][Ma][sa]=(bc+cc)*na.SQRT2*.5,gb[cb+1][Ma][sa]=(bc-cc)*na.SQRT2*.5}Ua[0]=ab[Db+0][0];Ua[0]*=Ua[0];for(sa=v.BLKSIZE/2-1;0<=sa;--sa){var kc=ab[Db+0][v.BLKSIZE/2-sa],Lb=ab[Db+0][v.BLKSIZE/2+sa];Ua[v.BLKSIZE/2-sa]=.5*(kc*kc+Lb*Lb)}for(Ma=2;0<=Ma;--Ma)for(ac[Ma][0]=gb[cb+0][Ma][0],
ac[Ma][0]*=ac[Ma][0],sa=v.BLKSIZE_s/2-1;0<=sa;--sa)kc=gb[cb+0][Ma][v.BLKSIZE_s/2-sa],Lb=gb[cb+0][Ma][v.BLKSIZE_s/2+sa],ac[Ma][v.BLKSIZE_s/2-sa]=.5*(kc*kc+Lb*Lb);var za=0;for(sa=11;sa<v.HBLKSIZE;sa++)za+=Ua[sa];lb.tot_ener[La]=za;if(da.analysis){for(sa=0;sa<v.HBLKSIZE;sa++)lb.pinfo.energy[ub][La][sa]=lb.pinfo.energy_save[La][sa],lb.pinfo.energy_save[La][sa]=Ua[sa];lb.pinfo.pe[ub][La]=lb.pe[La]}2==da.athaa_loudapprox&&2>La&&(lb.loudness_sq[ub][La]=lb.loudness_sq_save[La],lb.loudness_sq_save[La]=D(Ua,
lb));e(J,Bc,ba,Oc,rc);y(J,Oc,rc,$a);for(fa=0;3>fa;fa++){var oa=void 0,Ub=void 0,Vb=Pc,hb=X,qb=xa,Mb=V,Qc=fa,Xa=w.internal_flags;for(oa=Ub=0;oa<Xa.npart_s;++oa){for(var lc=0,Rc=0,vb=Xa.numlines_s[oa],Sc=0;Sc<vb;++Sc,++Ub){var Wb=Vb[Qc][Ub];lc+=Wb;Rc<Wb&&(Rc=Wb)}hb[oa]=lc}for(Ub=oa=0;oa<Xa.npart_s;oa++){var Xb=Xa.s3ind_s[oa][0],rb=Xa.s3_ss[Ub++]*hb[Xb];for(++Xb;Xb<=Xa.s3ind_s[oa][1];)rb+=Xa.s3_ss[Ub]*hb[Xb],++Ub,++Xb;var Nb=2*Xa.nb_s1[Mb][oa];qb[oa]=Math.min(rb,Nb);Xa.blocktype_old[Mb&1]==v.SHORT_TYPE&&
(Nb=16*Xa.nb_s2[Mb][oa],qb[oa]=Math.min(Nb,qb[oa]));Xa.nb_s2[Mb][oa]=Xa.nb_s1[Mb][oa];Xa.nb_s1[Mb][oa]=rb}for(;oa<=v.CBANDS;++oa)hb[oa]=0,qb[oa]=0;N(J,X,xa,V,fa);for(ua=0;ua<v.SBMAX_s;ua++){var ib=J.thm[V].s[ua][fa];ib*=.8;if(2<=Fa[fa]||1==Fa[fa+1]){var Ob=0!=fa?fa-1:2;Ta=K(J.thm[V].s[ua][Ob],ib,.6*Z);ib=Math.min(ib,Ta)}if(1==Fa[fa])Ob=0!=fa?fa-1:2,Ta=K(J.thm[V].s[ua][Ob],ib,.3*Z),ib=Math.min(ib,Ta);else if(0!=fa&&3==Fa[fa-1]||0==fa&&3==J.nsPsy.lastAttacks[V])Ob=2!=fa?fa+1:0,Ta=K(J.thm[V].s[ua][Ob],
ib,.3*Z),ib=Math.min(ib,Ta);var uc=Da[3*fa+3]+Da[3*fa+4]+Da[3*fa+5];6*Da[3*fa+5]<uc&&(ib*=.5,6*Da[3*fa+4]<uc&&(ib*=.5));J.thm[V].s[ua][fa]=ib}}J.nsPsy.lastAttacks[V]=Fa[2];for(va=bb=0;va<J.npart_l;va++){for(var wb=J.s3ind[va][0],dc=ba[wb]*q[$a[wb]],Eb=J.s3_ll[bb++]*dc;++wb<=J.s3ind[va][1];)dc=ba[wb]*q[$a[wb]],Eb=B(Eb,J.s3_ll[bb++]*dc,wb,wb-va,J,0);Eb*=.158489319246111;xa[va]=J.blocktype_old[V&1]==v.SHORT_TYPE?Eb:K(Math.min(Eb,Math.min(2*J.nb_1[V][va],16*J.nb_2[V][va])),Eb,Z);J.nb_2[V][va]=J.nb_1[V][va];
J.nb_1[V][va]=Eb}for(;va<=v.CBANDS;++va)ba[va]=0,xa[va]=0;O(J,ba,xa,V)}if((w.mode==Ca.STEREO||w.mode==Ca.JOINT_STEREO)&&0<w.interChRatio){var Pb=w.interChRatio,pa=w.internal_flags;if(1<pa.channels_out){for(var Na=0;Na<v.SBMAX_l;Na++){var mc=pa.thm[0].l[Na],Yb=pa.thm[1].l[Na];pa.thm[0].l[Na]+=Yb*Pb;pa.thm[1].l[Na]+=mc*Pb}for(Na=0;Na<v.SBMAX_s;Na++)for(var xb=0;3>xb;xb++)mc=pa.thm[0].s[Na][xb],Yb=pa.thm[1].s[Na][xb],pa.thm[0].s[Na][xb]+=Yb*Pb,pa.thm[1].s[Na][xb]+=mc*Pb}}if(w.mode==Ca.JOINT_STEREO){for(var db,
ta=0;ta<v.SBMAX_l;ta++)if(!(J.thm[0].l[ta]>1.58*J.thm[1].l[ta]||J.thm[1].l[ta]>1.58*J.thm[0].l[ta])){var jb=J.mld_l[ta]*J.en[3].l[ta],yb=Math.max(J.thm[2].l[ta],Math.min(J.thm[3].l[ta],jb));jb=J.mld_l[ta]*J.en[2].l[ta];var Gc=Math.max(J.thm[3].l[ta],Math.min(J.thm[2].l[ta],jb));J.thm[2].l[ta]=yb;J.thm[3].l[ta]=Gc}for(ta=0;ta<v.SBMAX_s;ta++)for(var Ga=0;3>Ga;Ga++)J.thm[0].s[ta][Ga]>1.58*J.thm[1].s[ta][Ga]||J.thm[1].s[ta][Ga]>1.58*J.thm[0].s[ta][Ga]||(jb=J.mld_s[ta]*J.en[3].s[ta][Ga],yb=Math.max(J.thm[2].s[ta][Ga],
Math.min(J.thm[3].s[ta][Ga],jb)),jb=J.mld_s[ta]*J.en[2].s[ta][Ga],Gc=Math.max(J.thm[3].s[ta][Ga],Math.min(J.thm[2].s[ta][Ga],jb)),J.thm[2].s[ta][Ga]=yb,J.thm[3].s[ta][Ga]=Gc);db=w.msfix;if(0<Math.abs(db)){var ec=db,Hc=ec,vc=Math.pow(10,w.ATHlower*J.ATH.adjust);ec*=2;Hc*=2;for(var Ia=0;Ia<v.SBMAX_l;Ia++){var ja=J.ATH.cb_l[J.bm_l[Ia]]*vc;var mb=Math.min(Math.max(J.thm[0].l[Ia],ja),Math.max(J.thm[1].l[Ia],ja));var sb=Math.max(J.thm[2].l[Ia],ja);var Fb=Math.max(J.thm[3].l[Ia],ja);if(mb*ec<sb+Fb){var zb=
mb*Hc/(sb+Fb);sb*=zb;Fb*=zb}J.thm[2].l[Ia]=Math.min(sb,J.thm[2].l[Ia]);J.thm[3].l[Ia]=Math.min(Fb,J.thm[3].l[Ia])}vc*=v.BLKSIZE_s/v.BLKSIZE;for(Ia=0;Ia<v.SBMAX_s;Ia++)for(var Qa=0;3>Qa;Qa++)ja=J.ATH.cb_s[J.bm_s[Ia]]*vc,mb=Math.min(Math.max(J.thm[0].s[Ia][Qa],ja),Math.max(J.thm[1].s[Ia][Qa],ja)),sb=Math.max(J.thm[2].s[Ia][Qa],ja),Fb=Math.max(J.thm[3].s[Ia][Qa],ja),mb*ec<sb+Fb&&(zb=mb*ec/(sb+Fb),sb*=zb,Fb*=zb),J.thm[2].s[Ia][Qa]=Math.min(J.thm[2].s[Ia][Qa],sb),J.thm[3].s[Ia][Qa]=Math.min(J.thm[3].s[Ia][Qa],
Fb)}}var Ab=w.internal_flags;w.short_blocks!=Va.short_block_coupled||0!=Ka[0]&&0!=Ka[1]||(Ka[0]=Ka[1]=0);for(var Ya=0;Ya<Ab.channels_out;Ya++)ha[Ya]=v.NORM_TYPE,w.short_blocks==Va.short_block_dispensed&&(Ka[Ya]=1),w.short_blocks==Va.short_block_forced&&(Ka[Ya]=0),0!=Ka[Ya]?Ab.blocktype_old[Ya]==v.SHORT_TYPE&&(ha[Ya]=v.STOP_TYPE):(ha[Ya]=v.SHORT_TYPE,Ab.blocktype_old[Ya]==v.NORM_TYPE&&(Ab.blocktype_old[Ya]=v.START_TYPE),Ab.blocktype_old[Ya]==v.STOP_TYPE&&(Ab.blocktype_old[Ya]=v.SHORT_TYPE)),U[Ya]=
Ab.blocktype_old[Ya],Ab.blocktype_old[Ya]=ha[Ya];for(V=0;V<Ea;V++){var Ra=0;if(1<V){var fc=ca;Ra=-2;var nc=v.NORM_TYPE;if(U[0]==v.SHORT_TYPE||U[1]==v.SHORT_TYPE)nc=v.SHORT_TYPE;var Zb=H[E][V-2]}else fc=M,Ra=0,nc=U[V],Zb=Q[E][V];fc[Ra+V]=nc==v.SHORT_TYPE?S(Zb,J.masking_lower):p(Zb,J.masking_lower);w.analysis&&(J.pinfo.pe[E][V]=fc[Ra+V])}return 0};var P=[-1.730326E-17,-.01703172,-1.349528E-17,.0418072,-6.73278E-17,-.0876324,-3.0835E-17,.1863476,-1.104424E-16,-.627638];this.L3psycho_anal_vbr=function(w,
z,C,E,Q,H,M,ca,Y,U){for(var J=w.internal_flags,ma,qa,ba=W(v.HBLKSIZE),X=Ja([3,v.HBLKSIZE_s]),xa=Ja([2,v.BLKSIZE]),ha=Ja([2,3,v.BLKSIZE_s]),Ka=Ja([4,v.CBANDS]),V=Ja([4,v.CBANDS]),va=Ja([4,3]),T=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],wa=ka(2),bb=w.mode==Ca.JOINT_STEREO?4:J.channels_out,ua=Ja([2,576]),fa=w.internal_flags,Za=fa.channels_out,$a=w.mode==Ca.JOINT_STEREO?4:Za,ea=0;ea<Za;ea++){firbuf=z[ea];for(var Ea=C+576-350-21+192,Z=0;576>Z;Z++){var kb;var ob=firbuf[Ea+Z+10];for(var Oa=kb=0;9>Oa;Oa+=
2)ob+=P[Oa]*(firbuf[Ea+Z+Oa]+firbuf[Ea+Z+21-Oa]),kb+=P[Oa+1]*(firbuf[Ea+Z+Oa+1]+firbuf[Ea+Z+21-Oa-1]);ua[ea][Z]=ob+kb}Q[E][ea].en.assign(fa.en[ea]);Q[E][ea].thm.assign(fa.thm[ea]);2<$a&&(H[E][ea].en.assign(fa.en[ea+2]),H[E][ea].thm.assign(fa.thm[ea+2]))}for(ea=0;ea<$a;ea++){var Sa=W(12),Da=W(12),Pa=[0,0,0,0],Rb=ua[ea&1],Sb=0,Oc=3==ea?fa.nsPsy.attackthre_s:fa.nsPsy.attackthre,rc=1;if(2==ea)for(Z=0,Oa=576;0<Oa;++Z,--Oa){var Fa=ua[0][Z],Bc=ua[1][Z];ua[0][Z]=Fa+Bc;ua[1][Z]=Fa-Bc}for(Z=0;3>Z;Z++)Da[Z]=
fa.nsPsy.last_en_subshort[ea][Z+6],Sa[Z]=Da[Z]/fa.nsPsy.last_en_subshort[ea][Z+4],Pa[0]+=Da[Z];for(Z=0;9>Z;Z++){for(var Pc=Sb+64,pb=1;Sb<Pc;Sb++)pb<Math.abs(Rb[Sb])&&(pb=Math.abs(Rb[Sb]));fa.nsPsy.last_en_subshort[ea][Z]=Da[Z+3]=pb;Pa[1+Z/3]+=pb;pb=pb>Da[Z+3-2]?pb/Da[Z+3-2]:Da[Z+3-2]>10*pb?Da[Z+3-2]/(10*pb):0;Sa[Z+3]=pb}for(Z=0;3>Z;++Z){var Cc=Da[3*Z+3]+Da[3*Z+4]+Da[3*Z+5],sc=1;6*Da[3*Z+5]<Cc&&(sc*=.5,6*Da[3*Z+4]<Cc&&(sc*=.5));va[ea][Z]=sc}if(w.analysis){var Tb=Sa[0];for(Z=1;12>Z;Z++)Tb<Sa[Z]&&(Tb=
Sa[Z]);fa.pinfo.ers[E][ea]=fa.pinfo.ers_save[ea];fa.pinfo.ers_save[ea]=Tb}for(Z=0;12>Z;Z++)0==T[ea][Z/3]&&Sa[Z]>Oc&&(T[ea][Z/3]=Z%3+1);for(Z=1;4>Z;Z++){var Dc=Pa[Z-1],Ta=Pa[Z];4E4>Math.max(Dc,Ta)&&Dc<1.7*Ta&&Ta<1.7*Dc&&(1==Z&&T[ea][0]<=T[ea][Z]&&(T[ea][0]=0),T[ea][Z]=0)}T[ea][0]<=fa.nsPsy.lastAttacks[ea]&&(T[ea][0]=0);if(3==fa.nsPsy.lastAttacks[ea]||0!=T[ea][0]+T[ea][1]+T[ea][2]+T[ea][3])rc=0,0!=T[ea][1]&&0!=T[ea][0]&&(T[ea][1]=0),0!=T[ea][2]&&0!=T[ea][1]&&(T[ea][2]=0),0!=T[ea][3]&&0!=T[ea][2]&&(T[ea][3]=
0);2>ea?wa[ea]=rc:0==rc&&(wa[0]=wa[1]=0);Y[ea]=fa.tot_ener[ea]}var Ec=w.internal_flags;w.short_blocks!=Va.short_block_coupled||0!=wa[0]&&0!=wa[1]||(wa[0]=wa[1]=0);for(var tc=0;tc<Ec.channels_out;tc++)w.short_blocks==Va.short_block_dispensed&&(wa[tc]=1),w.short_blocks==Va.short_block_forced&&(wa[tc]=0);for(var da=0;da<bb;da++){var Ua=da&1;ma=xa;var ac=w,ab=da,Db=E,gb=ba,cb=ma,ub=Ua,La=ac.internal_flags;if(2>ab)t.fft_long(La,cb[ub],ab,z,C);else if(2==ab)for(var Ha=v.BLKSIZE-1;0<=Ha;--Ha){var Fc=cb[ub+
0][Ha],lb=cb[ub+1][Ha];cb[ub+0][Ha]=(Fc+lb)*na.SQRT2*.5;cb[ub+1][Ha]=(Fc-lb)*na.SQRT2*.5}gb[0]=cb[ub+0][0];gb[0]*=gb[0];for(Ha=v.BLKSIZE/2-1;0<=Ha;--Ha){var sa=cb[ub+0][v.BLKSIZE/2-Ha],bc=cb[ub+0][v.BLKSIZE/2+Ha];gb[v.BLKSIZE/2-Ha]=.5*(sa*sa+bc*bc)}var cc=0;for(Ha=11;Ha<v.HBLKSIZE;Ha++)cc+=gb[Ha];La.tot_ener[ab]=cc;if(ac.analysis){for(Ha=0;Ha<v.HBLKSIZE;Ha++)La.pinfo.energy[Db][ab][Ha]=La.pinfo.energy_save[ab][Ha],La.pinfo.energy_save[ab][Ha]=gb[Ha];La.pinfo.pe[Db][ab]=La.pe[ab]}var Ma=da,kc=ba,Lb=
w.internal_flags;2==w.athaa_loudapprox&&2>Ma&&(Lb.loudness_sq[E][Ma]=Lb.loudness_sq_save[Ma],Lb.loudness_sq_save[Ma]=D(kc,Lb));if(0!=wa[Ua]){var za=void 0,oa=J,Ub=ba,Vb=Ka[da],hb=V[da],qb=da,Mb=W(v.CBANDS),Qc=W(v.CBANDS),Xa=ka(v.CBANDS+2);e(oa,Ub,Vb,Mb,Qc);y(oa,Mb,Qc,Xa);var lc=0;for(za=0;za<oa.npart_l;za++){var Rc,vb=oa.s3ind[za][0],Sc=oa.s3ind[za][1],Wb=0,Xb=0;Wb=Xa[vb];Xb+=1;var rb=oa.s3_ll[lc]*Vb[vb]*q[Xa[vb]];++lc;for(++vb;vb<=Sc;){Wb+=Xa[vb];Xb+=1;var Nb=oa.s3_ll[lc]*Vb[vb]*q[Xa[vb]];rb=Rc=
F(rb,Nb,vb-za);++lc;++vb}Wb=(1+2*Wb)/(2*Xb);var ib=.5*q[Wb];rb*=ib;if(oa.blocktype_old[qb&1]==v.SHORT_TYPE){var Ob=2*oa.nb_1[qb][za];hb[za]=0<Ob?Math.min(rb,Ob):Math.min(rb,.3*Vb[za])}else{var uc=16*oa.nb_2[qb][za],wb=2*oa.nb_1[qb][za];0>=uc&&(uc=rb);0>=wb&&(wb=rb);Ob=oa.blocktype_old[qb&1]==v.NORM_TYPE?Math.min(wb,uc):wb;hb[za]=Math.min(rb,Ob)}oa.nb_2[qb][za]=oa.nb_1[qb][za];oa.nb_1[qb][za]=rb;Nb=Mb[za];Nb*=oa.minval_l[za];Nb*=ib;hb[za]>Nb&&(hb[za]=Nb);1<oa.masking_lower&&(hb[za]*=oa.masking_lower);
hb[za]>Vb[za]&&(hb[za]=Vb[za]);1>oa.masking_lower&&(hb[za]*=oa.masking_lower)}for(;za<v.CBANDS;++za)Vb[za]=0,hb[za]=0}else for(var dc=J,Eb=da,Pb=0;Pb<dc.npart_l;Pb++)dc.nb_2[Eb][Pb]=dc.nb_1[Eb][Pb],dc.nb_1[Eb][Pb]=0}2==wa[0]+wa[1]&&w.mode==Ca.JOINT_STEREO&&b(Ka,V,J.mld_cb_l,J.ATH.cb_l,w.ATHlower*J.ATH.adjust,w.msfix,J.npart_l);for(da=0;da<bb;da++)Ua=da&1,0!=wa[Ua]&&O(J,Ka[da],V[da],da);for(var pa=0;3>pa;pa++){for(da=0;da<bb;++da)if(Ua=da&1,0!=wa[Ua]){var Na=J,mc=da;if(0==pa)for(var Yb=0;Yb<Na.npart_s;Yb++)Na.nb_s2[mc][Yb]=
Na.nb_s1[mc][Yb],Na.nb_s1[mc][Yb]=0}else{qa=ha;var xb=da,db=pa,ta=X,jb=qa,yb=Ua,Gc=w.internal_flags;0==db&&2>xb&&t.fft_short(Gc,jb[yb],xb,z,C);if(2==xb)for(var Ga=v.BLKSIZE_s-1;0<=Ga;--Ga){var ec=jb[yb+0][db][Ga],Hc=jb[yb+1][db][Ga];jb[yb+0][db][Ga]=(ec+Hc)*na.SQRT2*.5;jb[yb+1][db][Ga]=(ec-Hc)*na.SQRT2*.5}ta[db][0]=jb[yb+0][db][0];ta[db][0]*=ta[db][0];for(Ga=v.BLKSIZE_s/2-1;0<=Ga;--Ga){var vc=jb[yb+0][db][v.BLKSIZE_s/2-Ga],Ia=jb[yb+0][db][v.BLKSIZE_s/2+Ga];ta[db][v.BLKSIZE_s/2-Ga]=.5*(vc*vc+Ia*Ia)}var ja=
void 0,mb=void 0,sb=void 0,Fb=X,zb=Ka[da],Qa=V[da],Ab=da,Ya=pa,Ra=w.internal_flags,fc=new float[v.CBANDS],nc=W(v.CBANDS),Zb=new int[v.CBANDS];for(ja=mb=0;ja<Ra.npart_s;++ja){var Xc=0,Yc=0,fd=Ra.numlines_s[ja];for(sb=0;sb<fd;++sb,++mb){var Zc=Fb[Ya][mb];Xc+=Zc;Yc<Zc&&(Yc=Zc)}zb[ja]=Xc;fc[ja]=Yc;nc[ja]=Xc/fd}for(;ja<v.CBANDS;++ja)fc[ja]=0,nc[ja]=0;var gc=Ra,Gb=fc,oc=nc,wc=Zb,xc=q.length-1,Aa=0,eb=oc[Aa]+oc[Aa+1];if(0<eb){var tb=Gb[Aa];tb<Gb[Aa+1]&&(tb=Gb[Aa+1]);eb=20*(2*tb-eb)/(eb*(gc.numlines_s[Aa]+
gc.numlines_s[Aa+1]-1));var Hb=0|eb;Hb>xc&&(Hb=xc);wc[Aa]=Hb}else wc[Aa]=0;for(Aa=1;Aa<gc.npart_s-1;Aa++)eb=oc[Aa-1]+oc[Aa]+oc[Aa+1],0<eb?(tb=Gb[Aa-1],tb<Gb[Aa]&&(tb=Gb[Aa]),tb<Gb[Aa+1]&&(tb=Gb[Aa+1]),eb=20*(3*tb-eb)/(eb*(gc.numlines_s[Aa-1]+gc.numlines_s[Aa]+gc.numlines_s[Aa+1]-1)),Hb=0|eb,Hb>xc&&(Hb=xc),wc[Aa]=Hb):wc[Aa]=0;eb=oc[Aa-1]+oc[Aa];0<eb?(tb=Gb[Aa-1],tb<Gb[Aa]&&(tb=Gb[Aa]),eb=20*(2*tb-eb)/(eb*(gc.numlines_s[Aa-1]+gc.numlines_s[Aa]-1)),Hb=0|eb,Hb>xc&&(Hb=xc),wc[Aa]=Hb):wc[Aa]=0;for(mb=ja=
0;ja<Ra.npart_s;ja++){var Qb=Ra.s3ind_s[ja][0],yd=Ra.s3ind_s[ja][1];var Tc=Zb[Qb];var gd=1;var Ic=Ra.s3_ss[mb]*zb[Qb]*q[Zb[Qb]];++mb;for(++Qb;Qb<=yd;){Tc+=Zb[Qb];gd+=1;var yc=Ra.s3_ss[mb]*zb[Qb]*q[Zb[Qb]];Ic=F(Ic,yc,Qb-ja);++mb;++Qb}Tc=(1+2*Tc)/(2*gd);var hd=.5*q[Tc];Ic*=hd;Qa[ja]=Ic;Ra.nb_s2[Ab][ja]=Ra.nb_s1[Ab][ja];Ra.nb_s1[Ab][ja]=Ic;yc=fc[ja];yc*=Ra.minval_s[ja];yc*=hd;Qa[ja]>yc&&(Qa[ja]=yc);1<Ra.masking_lower&&(Qa[ja]*=Ra.masking_lower);Qa[ja]>zb[ja]&&(Qa[ja]=zb[ja]);1>Ra.masking_lower&&(Qa[ja]*=
Ra.masking_lower)}for(;ja<v.CBANDS;++ja)zb[ja]=0,Qa[ja]=0}0==wa[0]+wa[1]&&w.mode==Ca.JOINT_STEREO&&b(Ka,V,J.mld_cb_s,J.ATH.cb_s,w.ATHlower*J.ATH.adjust,w.msfix,J.npart_s);for(da=0;da<bb;++da)Ua=da&1,0==wa[Ua]&&N(J,Ka[da],V[da],da,pa)}for(da=0;da<bb;da++)if(Ua=da&1,0==wa[Ua])for(var pc=0;pc<v.SBMAX_s;pc++){var id=W(3);for(pa=0;3>pa;pa++){var Bb=J.thm[da].s[pc][pa];Bb*=.8;if(2<=T[da][pa]||1==T[da][pa+1]){var Jc=0!=pa?pa-1:2,Kc=K(J.thm[da].s[pc][Jc],Bb,.36);Bb=Math.min(Bb,Kc)}else if(1==T[da][pa])Jc=
0!=pa?pa-1:2,Kc=K(J.thm[da].s[pc][Jc],Bb,.18),Bb=Math.min(Bb,Kc);else if(0!=pa&&3==T[da][pa-1]||0==pa&&3==J.nsPsy.lastAttacks[da])Jc=2!=pa?pa+1:0,Kc=K(J.thm[da].s[pc][Jc],Bb,.18),Bb=Math.min(Bb,Kc);Bb*=va[da][pa];id[pa]=Bb}for(pa=0;3>pa;pa++)J.thm[da].s[pc][pa]=id[pa]}for(da=0;da<bb;da++)J.nsPsy.lastAttacks[da]=T[da][2];for(var hc=w.internal_flags,Ib=0;Ib<hc.channels_out;Ib++){var $c=v.NORM_TYPE;0!=wa[Ib]?hc.blocktype_old[Ib]==v.SHORT_TYPE&&($c=v.STOP_TYPE):($c=v.SHORT_TYPE,hc.blocktype_old[Ib]==
v.NORM_TYPE&&(hc.blocktype_old[Ib]=v.START_TYPE),hc.blocktype_old[Ib]==v.STOP_TYPE&&(hc.blocktype_old[Ib]=v.SHORT_TYPE));U[Ib]=hc.blocktype_old[Ib];hc.blocktype_old[Ib]=$c}for(da=0;da<bb;da++){if(1<da){var ad=ca;var bd=-2;var cd=v.NORM_TYPE;if(U[0]==v.SHORT_TYPE||U[1]==v.SHORT_TYPE)cd=v.SHORT_TYPE;var dd=H[E][da-2]}else ad=M,bd=0,cd=U[da],dd=Q[E][da];ad[bd+da]=cd==v.SHORT_TYPE?S(dd,J.masking_lower):p(dd,J.masking_lower);w.analysis&&(J.pinfo.pe[E][da]=ad[bd+da])}return 0};this.psymodel_init=function(w){var z=
w.internal_flags,C,E=!0,Q=13,H=0,M=0,ca=-8.25,Y=-4.5,U=W(v.CBANDS),J=W(v.CBANDS),ma=W(v.CBANDS),qa=w.out_samplerate;switch(w.experimentalZ){default:case 0:E=!0;break;case 1:E=w.VBR==aa.vbr_mtrh||w.VBR==aa.vbr_mt?!1:!0;break;case 2:E=!1;break;case 3:Q=8,H=-1.75,M=-.0125,ca=-8.25,Y=-2.25}z.ms_ener_ratio_old=.25;z.blocktype_old[0]=z.blocktype_old[1]=v.NORM_TYPE;for(C=0;4>C;++C){for(var ba=0;ba<v.CBANDS;++ba)z.nb_1[C][ba]=1E20,z.nb_2[C][ba]=1E20,z.nb_s1[C][ba]=z.nb_s2[C][ba]=1;for(var X=0;X<v.SBMAX_l;X++)z.en[C].l[X]=
1E20,z.thm[C].l[X]=1E20;for(ba=0;3>ba;++ba){for(X=0;X<v.SBMAX_s;X++)z.en[C].s[X][ba]=1E20,z.thm[C].s[X][ba]=1E20;z.nsPsy.lastAttacks[C]=0}for(ba=0;9>ba;ba++)z.nsPsy.last_en_subshort[C][ba]=10}z.loudness_sq_save[0]=z.loudness_sq_save[1]=0;z.npart_l=f(z.numlines_l,z.bo_l,z.bm_l,U,J,z.mld_l,z.PSY.bo_l_weight,qa,v.BLKSIZE,z.scalefac_band.l,v.BLKSIZE/1152,v.SBMAX_l);for(C=0;C<z.npart_l;C++)X=H,U[C]>=Q&&(X=M*(U[C]-Q)/(24-Q)+H*(24-U[C])/(24-Q)),ma[C]=Math.pow(10,X/10),z.rnumlines_l[C]=0<z.numlines_l[C]?
1/z.numlines_l[C]:0;z.s3_ll=k(z.s3ind,z.npart_l,U,J,ma,E);for(C=ba=0;C<z.npart_l;C++){M=qc.MAX_VALUE;for(X=0;X<z.numlines_l[C];X++,ba++)H=qa*ba/(1E3*v.BLKSIZE),H=this.ATHformula(1E3*H,w)-20,H=Math.pow(10,.1*H),H*=z.numlines_l[C],M>H&&(M=H);z.ATH.cb_l[C]=M;M=-20+20*U[C]/10;6<M&&(M=100);-15>M&&(M=-15);M-=8;z.minval_l[C]=Math.pow(10,M/10)*z.numlines_l[C]}z.npart_s=f(z.numlines_s,z.bo_s,z.bm_s,U,J,z.mld_s,z.PSY.bo_s_weight,qa,v.BLKSIZE_s,z.scalefac_band.s,v.BLKSIZE_s/384,v.SBMAX_s);for(C=ba=0;C<z.npart_s;C++){X=
ca;U[C]>=Q&&(X=Y*(U[C]-Q)/(24-Q)+ca*(24-U[C])/(24-Q));ma[C]=Math.pow(10,X/10);M=qc.MAX_VALUE;for(X=0;X<z.numlines_s[C];X++,ba++)H=qa*ba/(1E3*v.BLKSIZE_s),H=this.ATHformula(1E3*H,w)-20,H=Math.pow(10,.1*H),H*=z.numlines_s[C],M>H&&(M=H);z.ATH.cb_s[C]=M;M=-7+7*U[C]/12;12<U[C]&&(M*=1+3.1*Math.log(1+M));12>U[C]&&(M*=1+2.3*Math.log(1-M));-15>M&&(M=-15);M-=8;z.minval_s[C]=Math.pow(10,M/10)*z.numlines_s[C]}z.s3_ss=k(z.s3ind_s,z.npart_s,U,J,ma,E);d=Math.pow(10,.5625);g=Math.pow(10,1.5);h=Math.pow(10,1.5);t.init_fft(z);
z.decay=Math.exp(-2.302585092994046/(.01*qa/192));C=3.5;0!=(w.exp_nspsytune&2)&&(C=1);0<Math.abs(w.msfix)&&(C=w.msfix);w.msfix=C;for(E=0;E<z.npart_l;E++)z.s3ind[E][1]>z.npart_l-1&&(z.s3ind[E][1]=z.npart_l-1);z.ATH.decay=Math.pow(10,576*z.mode_gr/qa*-1.2);z.ATH.adjust=.01;z.ATH.adjustLimit=1;if(-1!=w.ATHtype){ba=w.out_samplerate/v.BLKSIZE;for(C=H=E=0;C<v.BLKSIZE/2;++C)H+=ba,z.ATH.eql_w[C]=1/Math.pow(10,this.ATHformula(H,w)/10),E+=z.ATH.eql_w[C];E=1/E;for(C=v.BLKSIZE/2;0<=--C;)z.ATH.eql_w[C]*=E}for(E=
ba=0;E<z.npart_s;++E)for(C=0;C<z.numlines_s[E];++C)++ba;for(E=ba=0;E<z.npart_l;++E)for(C=0;C<z.numlines_l[E];++C)++ba;for(C=ba=0;C<z.npart_l;C++)H=qa*(ba+z.numlines_l[C]/2)/(1*v.BLKSIZE),z.mld_cb_l[C]=c(H),ba+=z.numlines_l[C];for(;C<v.CBANDS;++C)z.mld_cb_l[C]=1;for(C=ba=0;C<z.npart_s;C++)H=qa*(ba+z.numlines_s[C]/2)/(1*v.BLKSIZE_s),z.mld_cb_s[C]=c(H),ba+=z.numlines_s[C];for(;C<v.CBANDS;++C)z.mld_cb_s[C]=1;return 0};this.ATHformula=function(w,z){switch(z.ATHtype){case 0:w=m(w,9);break;case 1:w=m(w,
-1);break;case 2:w=m(w,0);break;case 3:w=m(w,1)+6;break;case 4:w=m(w,z.ATHcurve);break;default:w=m(w,0)}return w}}function ia(){function D(){this.mask_adjust_short=this.mask_adjust=0;this.bo_l_weight=W(v.SBMAX_l);this.bo_s_weight=W(v.SBMAX_s)}function B(){this.lowerlimit=0}function F(a,l){this.lowpass=l}function N(a){return 1<a?0:0>=a?1:Math.cos(Math.PI/2*a)}function O(a,l){switch(a){case 44100:return l.version=1,0;case 48E3:return l.version=1;case 32E3:return l.version=1,2;case 22050:return l.version=
0;case 24E3:return l.version=0,1;case 16E3:return l.version=0,2;case 11025:return l.version=0;case 12E3:return l.version=0,1;case 8E3:return l.version=0,2;default:return l.version=0,-1}}function K(a,l,n){16E3>n&&(l=2);n=R.bitrate_table[l][1];for(var u=2;14>=u;u++)0<R.bitrate_table[l][u]&&Math.abs(R.bitrate_table[l][u]-a)<Math.abs(n-a)&&(n=R.bitrate_table[l][u]);return n}function S(a,l,n){16E3>n&&(l=2);for(n=0;14>=n;n++)if(0<R.bitrate_table[l][n]&&R.bitrate_table[l][n]==a)return n;return-1}function p(a,
l){var n=[new F(8,2E3),new F(16,3700),new F(24,3900),new F(32,5500),new F(40,7E3),new F(48,7500),new F(56,1E4),new F(64,11E3),new F(80,13500),new F(96,15100),new F(112,15600),new F(128,17E3),new F(160,17500),new F(192,18600),new F(224,19400),new F(256,19700),new F(320,20500)];l=f.nearestBitrateFullIndex(l);a.lowerlimit=n[l].lowpass}function e(a){var l=v.BLKSIZE+a.framesize-v.FFTOFFSET;return l=Math.max(l,512+a.framesize-32)}function y(a,l,n,u,A,L,I){var P=a.internal_flags,w=0,z=[null,null],C=[null,
null];if(4294479419!=P.Class_ID)return-3;if(0==u)return 0;var E=c.copy_buffer(P,A,L,I,0);if(0>E)return E;L+=E;w+=E;C[0]=l;C[1]=n;if(Wa.NEQ(a.scale,0)&&Wa.NEQ(a.scale,1))for(E=0;E<u;++E)C[0][E]*=a.scale,2==P.channels_out&&(C[1][E]*=a.scale);if(Wa.NEQ(a.scale_left,0)&&Wa.NEQ(a.scale_left,1))for(E=0;E<u;++E)C[0][E]*=a.scale_left;if(Wa.NEQ(a.scale_right,0)&&Wa.NEQ(a.scale_right,1))for(E=0;E<u;++E)C[1][E]*=a.scale_right;if(2==a.num_channels&&1==P.channels_out)for(E=0;E<u;++E)C[0][E]=.5*(C[0][E]+C[1][E]),
C[1][E]=0;l=e(a);z[0]=P.mfbuf[0];z[1]=P.mfbuf[1];for(n=0;0<u;){var Q=[null,null];Q[0]=C[0];Q[1]=C[1];E=new b;var H=a;var M=z;var ca=n,Y=u,U=E,J=H.internal_flags;if(.9999>J.resample_ratio||1.0001<J.resample_ratio)for(var ma=0;ma<J.channels_out;ma++){var qa=new x,ba=U,X,xa=M[ma],ha=J.mf_size,Ka=H.framesize,V=Q[ma],va=ca,T=Y,wa=qa,bb=ma,ua=H.internal_flags,fa=0,Za=H.out_samplerate/G(H.out_samplerate,H.in_samplerate);Za>Ba.BPC&&(Za=Ba.BPC);var $a=1E-4>Math.abs(ua.resample_ratio-Math.floor(.5+ua.resample_ratio))?
1:0;var ea=1/ua.resample_ratio;1<ea&&(ea=1);var Ea=31;0==Ea%2&&--Ea;Ea+=$a;$a=Ea+1;if(0==ua.fill_buffer_resample_init){ua.inbuf_old[0]=W($a);ua.inbuf_old[1]=W($a);for(X=0;X<=2*Za;++X)ua.blackfilt[X]=W($a);ua.itime[0]=0;for(fa=ua.itime[1]=0;fa<=2*Za;fa++){var Z=0,kb=(fa-Za)/(2*Za);for(X=0;X<=Ea;X++){var ob=ua.blackfilt[fa],Oa=X,Sa=X-kb,Da=Math.PI*ea;Sa/=Ea;0>Sa&&(Sa=0);1<Sa&&(Sa=1);var Pa=Sa-.5;Sa=.42-.5*Math.cos(2*Sa*Math.PI)+.08*Math.cos(4*Sa*Math.PI);Z+=ob[Oa]=1E-9>Math.abs(Pa)?Da/Math.PI:Sa*Math.sin(Ea*
Da*Pa)/(Math.PI*Ea*Pa)}for(X=0;X<=Ea;X++)ua.blackfilt[fa][X]/=Z}ua.fill_buffer_resample_init=1}Z=ua.inbuf_old[bb];for(ea=0;ea<Ka;ea++){X=ea*ua.resample_ratio;fa=0|Math.floor(X-ua.itime[bb]);if(Ea+fa-Ea/2>=T)break;kb=X-ua.itime[bb]-(fa+Ea%2*.5);kb=0|Math.floor(2*kb*Za+Za+.5);for(X=ob=0;X<=Ea;++X)Oa=0|X+fa-Ea/2,ob+=(0>Oa?Z[$a+Oa]:V[va+Oa])*ua.blackfilt[kb][X];xa[ha+ea]=ob}wa.num_used=Math.min(T,Ea+fa-Ea/2);ua.itime[bb]+=wa.num_used-ea*ua.resample_ratio;if(wa.num_used>=$a)for(X=0;X<$a;X++)Z[X]=V[va+
wa.num_used+X-$a];else{xa=$a-wa.num_used;for(X=0;X<xa;++X)Z[X]=Z[X+wa.num_used];for(fa=0;X<$a;++X,++fa)Z[X]=V[va+fa]}ba.n_out=ea;U.n_in=qa.num_used}else for(U.n_out=Math.min(H.framesize,Y),U.n_in=U.n_out,H=0;H<U.n_out;++H)M[0][J.mf_size+H]=Q[0][ca+H],2==J.channels_out&&(M[1][J.mf_size+H]=Q[1][ca+H]);M=E.n_in;E=E.n_out;if(P.findReplayGain&&!P.decode_on_the_fly&&k.AnalyzeSamples(P.rgdata,z[0],P.mf_size,z[1],P.mf_size,E,P.channels_out)==ra.GAIN_ANALYSIS_ERROR)return-6;u-=M;n+=M;P.mf_size+=E;1>P.mf_samples_to_encode&&
(P.mf_samples_to_encode=v.ENCDELAY+v.POSTDELAY);P.mf_samples_to_encode+=E;if(P.mf_size>=l){M=I-w;0==I&&(M=0);E=a;M=f.enc.lame_encode_mp3_frame(E,z[0],z[1],A,L,M);E.frameNum++;E=M;if(0>E)return E;L+=E;w+=E;P.mf_size-=a.framesize;P.mf_samples_to_encode-=a.framesize;for(M=0;M<P.channels_out;M++)for(E=0;E<P.mf_size;E++)z[M][E]=z[M][E+a.framesize]}}return w}function b(){this.n_out=this.n_in=0}function x(){this.num_used=0}function G(a,l){return 0!=l?G(l,a%l):a}var f=this;ia.V9=410;ia.V8=420;ia.V7=430;ia.V6=
440;ia.V5=450;ia.V4=460;ia.V3=470;ia.V2=480;ia.V1=490;ia.V0=500;ia.R3MIX=1E3;ia.STANDARD=1001;ia.EXTREME=1002;ia.INSANE=1003;ia.STANDARD_FAST=1004;ia.EXTREME_FAST=1005;ia.MEDIUM=1006;ia.MEDIUM_FAST=1007;ia.LAME_MAXMP3BUFFER=147456;var k,c,m,t,r,d=new Wc,g,h,q;this.enc=new v;this.setModules=function(a,l,n,u,A,L,I,P,w){k=a;c=l;m=n;t=u;r=A;g=L;h=P;q=w;this.enc.setModules(c,d,t,g)};this.lame_init=function(){var a=new nd;a.class_id=4294479419;var l=a.internal_flags=new Ba;a.mode=Ca.NOT_SET;a.original=
1;a.in_samplerate=44100;a.num_channels=2;a.num_samples=-1;a.bWriteVbrTag=!0;a.quality=-1;a.short_blocks=null;l.subblock_gain=-1;a.lowpassfreq=0;a.highpassfreq=0;a.lowpasswidth=-1;a.highpasswidth=-1;a.VBR=aa.vbr_off;a.VBR_q=4;a.ATHcurve=-1;a.VBR_mean_bitrate_kbps=128;a.VBR_min_bitrate_kbps=0;a.VBR_max_bitrate_kbps=0;a.VBR_hard_min=0;l.VBR_min_bitrate=1;l.VBR_max_bitrate=13;a.quant_comp=-1;a.quant_comp_short=-1;a.msfix=-1;l.resample_ratio=1;l.OldValue[0]=180;l.OldValue[1]=180;l.CurrentStep[0]=4;l.CurrentStep[1]=
4;l.masking_lower=1;l.nsPsy.attackthre=-1;l.nsPsy.attackthre_s=-1;a.scale=-1;a.athaa_type=-1;a.ATHtype=-1;a.athaa_loudapprox=-1;a.athaa_sensitivity=0;a.useTemporal=null;a.interChRatio=-1;l.mf_samples_to_encode=v.ENCDELAY+v.POSTDELAY;a.encoder_padding=0;l.mf_size=v.ENCDELAY-v.MDCTDELAY;a.findReplayGain=!1;a.decode_on_the_fly=!1;l.decode_on_the_fly=!1;l.findReplayGain=!1;l.findPeakSample=!1;l.RadioGain=0;l.AudiophileGain=0;l.noclipGainChange=0;l.noclipScale=-1;a.preset=0;a.write_id3tag_automatic=!0;
a.lame_allocated_gfp=1;return a};this.nearestBitrateFullIndex=function(a){var l=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320];var n=l[16];var u=16;var A=l[16];var L=16;for(var I=0;16>I;I++)if(Math.max(a,l[I+1])!=a){n=l[I+1];u=I+1;A=l[I];L=I;break}return n-a>a-A?L:u};this.lame_init_params=function(a){var l=a.internal_flags;l.Class_ID=0;null==l.ATH&&(l.ATH=new od);null==l.PSY&&(l.PSY=new D);null==l.rgdata&&(l.rgdata=new pd);l.channels_in=a.num_channels;1==l.channels_in&&(a.mode=Ca.MONO);
l.channels_out=a.mode==Ca.MONO?1:2;l.mode_ext=v.MPG_MD_MS_LR;a.mode==Ca.MONO&&(a.force_ms=!1);a.VBR==aa.vbr_off&&128!=a.VBR_mean_bitrate_kbps&&0==a.brate&&(a.brate=a.VBR_mean_bitrate_kbps);a.VBR!=aa.vbr_off&&a.VBR!=aa.vbr_mtrh&&a.VBR!=aa.vbr_mt&&(a.free_format=!1);a.VBR==aa.vbr_off&&0==a.brate&&Wa.EQ(a.compression_ratio,0)&&(a.compression_ratio=11.025);a.VBR==aa.vbr_off&&0<a.compression_ratio&&(0==a.out_samplerate&&(a.out_samplerate=map2MP3Frequency(int(.97*a.in_samplerate))),a.brate=0|16*a.out_samplerate*
l.channels_out/(1E3*a.compression_ratio),l.samplerate_index=O(a.out_samplerate,a),a.free_format||(a.brate=K(a.brate,a.version,a.out_samplerate)));0!=a.out_samplerate&&(16E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,64)):32E3>a.out_samplerate?(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,8),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,160)):(a.VBR_mean_bitrate_kbps=Math.max(a.VBR_mean_bitrate_kbps,
32),a.VBR_mean_bitrate_kbps=Math.min(a.VBR_mean_bitrate_kbps,320)));if(0==a.lowpassfreq){switch(a.VBR){case aa.vbr_off:var n=new B;p(n,a.brate);n=n.lowerlimit;break;case aa.vbr_abr:n=new B;p(n,a.VBR_mean_bitrate_kbps);n=n.lowerlimit;break;case aa.vbr_rh:var u=[19500,19E3,18600,18E3,17500,16E3,15600,14900,12500,1E4,3950];if(0<=a.VBR_q&&9>=a.VBR_q){n=u[a.VBR_q];u=u[a.VBR_q+1];var A=a.VBR_q_frac;n=linear_int(n,u,A)}else n=19500;break;default:u=[19500,19E3,18500,18E3,17500,16500,15500,14500,12500,9500,
3950],0<=a.VBR_q&&9>=a.VBR_q?(n=u[a.VBR_q],u=u[a.VBR_q+1],A=a.VBR_q_frac,n=linear_int(n,u,A)):n=19500}a.mode!=Ca.MONO||a.VBR!=aa.vbr_off&&a.VBR!=aa.vbr_abr||(n*=1.5);a.lowpassfreq=n|0}0==a.out_samplerate&&(2*a.lowpassfreq>a.in_samplerate&&(a.lowpassfreq=a.in_samplerate/2),n=a.lowpassfreq|0,u=a.in_samplerate,A=44100,48E3<=u?A=48E3:44100<=u?A=44100:32E3<=u?A=32E3:24E3<=u?A=24E3:22050<=u?A=22050:16E3<=u?A=16E3:12E3<=u?A=12E3:11025<=u?A=11025:8E3<=u&&(A=8E3),-1==n?n=A:(15960>=n&&(A=44100),15250>=n&&(A=
32E3),11220>=n&&(A=24E3),9970>=n&&(A=22050),7230>=n&&(A=16E3),5420>=n&&(A=12E3),4510>=n&&(A=11025),3970>=n&&(A=8E3),n=u<A?44100<u?48E3:32E3<u?44100:24E3<u?32E3:22050<u?24E3:16E3<u?22050:12E3<u?16E3:11025<u?12E3:8E3<u?11025:8E3:A),a.out_samplerate=n);a.lowpassfreq=Math.min(20500,a.lowpassfreq);a.lowpassfreq=Math.min(a.out_samplerate/2,a.lowpassfreq);a.VBR==aa.vbr_off&&(a.compression_ratio=16*a.out_samplerate*l.channels_out/(1E3*a.brate));a.VBR==aa.vbr_abr&&(a.compression_ratio=16*a.out_samplerate*
l.channels_out/(1E3*a.VBR_mean_bitrate_kbps));a.bWriteVbrTag||(a.findReplayGain=!1,a.decode_on_the_fly=!1,l.findPeakSample=!1);l.findReplayGain=a.findReplayGain;l.decode_on_the_fly=a.decode_on_the_fly;l.decode_on_the_fly&&(l.findPeakSample=!0);if(l.findReplayGain&&k.InitGainAnalysis(l.rgdata,a.out_samplerate)==ra.INIT_GAIN_ANALYSIS_ERROR)return a.internal_flags=null,-6;l.decode_on_the_fly&&!a.decode_only&&(null!=l.hip&&q.hip_decode_exit(l.hip),l.hip=q.hip_decode_init());l.mode_gr=24E3>=a.out_samplerate?
1:2;a.framesize=576*l.mode_gr;a.encoder_delay=v.ENCDELAY;l.resample_ratio=a.in_samplerate/a.out_samplerate;switch(a.VBR){case aa.vbr_mt:case aa.vbr_rh:case aa.vbr_mtrh:a.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][a.VBR_q];break;case aa.vbr_abr:a.compression_ratio=16*a.out_samplerate*l.channels_out/(1E3*a.VBR_mean_bitrate_kbps);break;default:a.compression_ratio=16*a.out_samplerate*l.channels_out/(1E3*a.brate)}a.mode==Ca.NOT_SET&&(a.mode=Ca.JOINT_STEREO);0<a.highpassfreq?(l.highpass1=
2*a.highpassfreq,l.highpass2=0<=a.highpasswidth?2*(a.highpassfreq+a.highpasswidth):2*a.highpassfreq,l.highpass1/=a.out_samplerate,l.highpass2/=a.out_samplerate):(l.highpass1=0,l.highpass2=0);0<a.lowpassfreq?(l.lowpass2=2*a.lowpassfreq,0<=a.lowpasswidth?(l.lowpass1=2*(a.lowpassfreq-a.lowpasswidth),0>l.lowpass1&&(l.lowpass1=0)):l.lowpass1=2*a.lowpassfreq,l.lowpass1/=a.out_samplerate,l.lowpass2/=a.out_samplerate):(l.lowpass1=0,l.lowpass2=0);n=a.internal_flags;var L=32,I=-1;if(0<n.lowpass1){var P=999;
for(u=0;31>=u;u++)A=u/31,A>=n.lowpass2&&(L=Math.min(L,u)),n.lowpass1<A&&A<n.lowpass2&&(P=Math.min(P,u));n.lowpass1=999==P?(L-.75)/31:(P-.75)/31;n.lowpass2=L/31}0<n.highpass2&&n.highpass2<.75/31*.9&&(n.highpass1=0,n.highpass2=0,la.err.println("Warning: highpass filter disabled.  highpass frequency too small\n"));if(0<n.highpass2){L=-1;for(u=0;31>=u;u++)A=u/31,A<=n.highpass1&&(I=Math.max(I,u)),n.highpass1<A&&A<n.highpass2&&(L=Math.max(L,u));n.highpass1=I/31;n.highpass2=-1==L?(I+.75)/31:(L+.75)/31}for(u=
0;32>u;u++)A=u/31,I=n.highpass2>n.highpass1?N((n.highpass2-A)/(n.highpass2-n.highpass1+1E-20)):1,A=n.lowpass2>n.lowpass1?N((A-n.lowpass1)/(n.lowpass2-n.lowpass1+1E-20)):1,n.amp_filter[u]=I*A;l.samplerate_index=O(a.out_samplerate,a);if(0>l.samplerate_index)return a.internal_flags=null,-1;if(a.VBR==aa.vbr_off)if(a.free_format)l.bitrate_index=0;else{if(a.brate=K(a.brate,a.version,a.out_samplerate),l.bitrate_index=S(a.brate,a.version,a.out_samplerate),0>=l.bitrate_index)return a.internal_flags=null,-1}else l.bitrate_index=
1;a.analysis&&(a.bWriteVbrTag=!1);null!=l.pinfo&&(a.bWriteVbrTag=!1);c.init_bit_stream_w(l);n=l.samplerate_index+3*a.version+6*(16E3>a.out_samplerate?1:0);for(u=0;u<v.SBMAX_l+1;u++)l.scalefac_band.l[u]=t.sfBandIndex[n].l[u];for(u=0;u<v.PSFB21+1;u++)A=(l.scalefac_band.l[22]-l.scalefac_band.l[21])/v.PSFB21,A=l.scalefac_band.l[21]+u*A,l.scalefac_band.psfb21[u]=A;l.scalefac_band.psfb21[v.PSFB21]=576;for(u=0;u<v.SBMAX_s+1;u++)l.scalefac_band.s[u]=t.sfBandIndex[n].s[u];for(u=0;u<v.PSFB12+1;u++)A=(l.scalefac_band.s[13]-
l.scalefac_band.s[12])/v.PSFB12,A=l.scalefac_band.s[12]+u*A,l.scalefac_band.psfb12[u]=A;l.scalefac_band.psfb12[v.PSFB12]=192;l.sideinfo_len=1==a.version?1==l.channels_out?21:36:1==l.channels_out?13:21;a.error_protection&&(l.sideinfo_len+=2);n=a.internal_flags;a.frameNum=0;a.write_id3tag_automatic&&h.id3tag_write_v2(a);n.bitrate_stereoMode_Hist=ic([16,5]);n.bitrate_blockType_Hist=ic([16,6]);n.PeakSample=0;a.bWriteVbrTag&&g.InitVbrTag(a);l.Class_ID=4294479419;for(n=0;19>n;n++)l.nsPsy.pefirbuf[n]=700*
l.mode_gr*l.channels_out;-1==a.ATHtype&&(a.ATHtype=4);switch(a.VBR){case aa.vbr_mt:a.VBR=aa.vbr_mtrh;case aa.vbr_mtrh:null==a.useTemporal&&(a.useTemporal=!1);m.apply_preset(a,500-10*a.VBR_q,0);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);5>a.quality&&(a.quality=0);5<a.quality&&(a.quality=5);l.PSY.mask_adjust=a.maskingadjust;l.PSY.mask_adjust_short=a.maskingadjust_short;l.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;l.iteration_loop=new VBRNewIterationLoop(r);break;case aa.vbr_rh:m.apply_preset(a,
500-10*a.VBR_q,0);l.PSY.mask_adjust=a.maskingadjust;l.PSY.mask_adjust_short=a.maskingadjust_short;l.sfb21_extra=a.experimentalY?!1:44E3<a.out_samplerate;6<a.quality&&(a.quality=6);0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY);l.iteration_loop=new VBROldIterationLoop(r);break;default:l.sfb21_extra=!1,0>a.quality&&(a.quality=LAME_DEFAULT_QUALITY),n=a.VBR,n==aa.vbr_off&&(a.VBR_mean_bitrate_kbps=a.brate),m.apply_preset(a,a.VBR_mean_bitrate_kbps,0),a.VBR=n,l.PSY.mask_adjust=a.maskingadjust,l.PSY.mask_adjust_short=
a.maskingadjust_short,l.iteration_loop=n==aa.vbr_off?new qd(r):new ABRIterationLoop(r)}if(a.VBR!=aa.vbr_off){l.VBR_min_bitrate=1;l.VBR_max_bitrate=14;16E3>a.out_samplerate&&(l.VBR_max_bitrate=8);if(0!=a.VBR_min_bitrate_kbps&&(a.VBR_min_bitrate_kbps=K(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),l.VBR_min_bitrate=S(a.VBR_min_bitrate_kbps,a.version,a.out_samplerate),0>l.VBR_min_bitrate)||0!=a.VBR_max_bitrate_kbps&&(a.VBR_max_bitrate_kbps=K(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),l.VBR_max_bitrate=
S(a.VBR_max_bitrate_kbps,a.version,a.out_samplerate),0>l.VBR_max_bitrate))return-1;a.VBR_min_bitrate_kbps=R.bitrate_table[a.version][l.VBR_min_bitrate];a.VBR_max_bitrate_kbps=R.bitrate_table[a.version][l.VBR_max_bitrate];a.VBR_mean_bitrate_kbps=Math.min(R.bitrate_table[a.version][l.VBR_max_bitrate],a.VBR_mean_bitrate_kbps);a.VBR_mean_bitrate_kbps=Math.max(R.bitrate_table[a.version][l.VBR_min_bitrate],a.VBR_mean_bitrate_kbps)}a.tune&&(l.PSY.mask_adjust+=a.tune_value_a,l.PSY.mask_adjust_short+=a.tune_value_a);
n=a.internal_flags;switch(a.quality){default:case 9:n.psymodel=0;n.noise_shaping=0;n.noise_shaping_amp=0;n.noise_shaping_stop=0;n.use_best_huffman=0;n.full_outer_loop=0;break;case 8:a.quality=7;case 7:n.psymodel=1;n.noise_shaping=0;n.noise_shaping_amp=0;n.noise_shaping_stop=0;n.use_best_huffman=0;n.full_outer_loop=0;break;case 6:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);n.noise_shaping_amp=0;n.noise_shaping_stop=0;-1==n.subblock_gain&&(n.subblock_gain=1);n.use_best_huffman=0;n.full_outer_loop=
0;break;case 5:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);n.noise_shaping_amp=0;n.noise_shaping_stop=0;-1==n.subblock_gain&&(n.subblock_gain=1);n.use_best_huffman=0;n.full_outer_loop=0;break;case 4:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);n.noise_shaping_amp=0;n.noise_shaping_stop=0;-1==n.subblock_gain&&(n.subblock_gain=1);n.use_best_huffman=1;n.full_outer_loop=0;break;case 3:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);n.noise_shaping_amp=1;n.noise_shaping_stop=1;-1==
n.subblock_gain&&(n.subblock_gain=1);n.use_best_huffman=1;n.full_outer_loop=0;break;case 2:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);0==n.substep_shaping&&(n.substep_shaping=2);n.noise_shaping_amp=1;n.noise_shaping_stop=1;-1==n.subblock_gain&&(n.subblock_gain=1);n.use_best_huffman=1;n.full_outer_loop=0;break;case 1:n.psymodel=1;0==n.noise_shaping&&(n.noise_shaping=1);0==n.substep_shaping&&(n.substep_shaping=2);n.noise_shaping_amp=2;n.noise_shaping_stop=1;-1==n.subblock_gain&&(n.subblock_gain=
1);n.use_best_huffman=1;n.full_outer_loop=0;break;case 0:n.psymodel=1,0==n.noise_shaping&&(n.noise_shaping=1),0==n.substep_shaping&&(n.substep_shaping=2),n.noise_shaping_amp=2,n.noise_shaping_stop=1,-1==n.subblock_gain&&(n.subblock_gain=1),n.use_best_huffman=1,n.full_outer_loop=0}l.ATH.useAdjust=0>a.athaa_type?3:a.athaa_type;l.ATH.aaSensitivityP=Math.pow(10,a.athaa_sensitivity/-10);null==a.short_blocks&&(a.short_blocks=Va.short_block_allowed);a.short_blocks!=Va.short_block_allowed||a.mode!=Ca.JOINT_STEREO&&
a.mode!=Ca.STEREO||(a.short_blocks=Va.short_block_coupled);0>a.quant_comp&&(a.quant_comp=1);0>a.quant_comp_short&&(a.quant_comp_short=0);0>a.msfix&&(a.msfix=0);a.exp_nspsytune|=1;0>a.internal_flags.nsPsy.attackthre&&(a.internal_flags.nsPsy.attackthre=Wc.NSATTACKTHRE);0>a.internal_flags.nsPsy.attackthre_s&&(a.internal_flags.nsPsy.attackthre_s=Wc.NSATTACKTHRE_S);0>a.scale&&(a.scale=1);0>a.ATHtype&&(a.ATHtype=4);0>a.ATHcurve&&(a.ATHcurve=4);0>a.athaa_loudapprox&&(a.athaa_loudapprox=2);0>a.interChRatio&&
(a.interChRatio=0);null==a.useTemporal&&(a.useTemporal=!0);l.slot_lag=l.frac_SpF=0;a.VBR==aa.vbr_off&&(l.slot_lag=l.frac_SpF=72E3*(a.version+1)*a.brate%a.out_samplerate|0);t.iteration_init(a);d.psymodel_init(a);return 0};this.lame_encode_flush=function(a,l,n,u){var A=a.internal_flags,L=ed([2,1152]),I=0,P=A.mf_samples_to_encode-v.POSTDELAY,w=e(a);if(1>A.mf_samples_to_encode)return 0;var z=0;a.in_samplerate!=a.out_samplerate&&(P+=16*a.out_samplerate/a.in_samplerate);var C=a.framesize-P%a.framesize;
576>C&&(C+=a.framesize);a.encoder_padding=C;for(C=(P+C)/a.framesize;0<C&&0<=I;){var E=w-A.mf_size;P=a.frameNum;E*=a.in_samplerate;E/=a.out_samplerate;1152<E&&(E=1152);1>E&&(E=1);I=u-z;0==u&&(I=0);I=this.lame_encode_buffer(a,L[0],L[1],E,l,n,I);n+=I;z+=I;C-=P!=a.frameNum?1:0}A.mf_samples_to_encode=0;if(0>I)return I;I=u-z;0==u&&(I=0);c.flush_bitstream(a);I=c.copy_buffer(A,l,n,I,1);if(0>I)return I;n+=I;z+=I;I=u-z;0==u&&(I=0);if(a.write_id3tag_automatic){h.id3tag_write_v1(a);I=c.copy_buffer(A,l,n,I,0);
if(0>I)return I;z+=I}return z};this.lame_encode_buffer=function(a,l,n,u,A,L,I){var P=a.internal_flags,w=[null,null];if(4294479419!=P.Class_ID)return-3;if(0==u)return 0;if(null==P.in_buffer_0||P.in_buffer_nsamples<u)P.in_buffer_0=W(u),P.in_buffer_1=W(u),P.in_buffer_nsamples=u;w[0]=P.in_buffer_0;w[1]=P.in_buffer_1;for(var z=0;z<u;z++)w[0][z]=l[z],1<P.channels_in&&(w[1][z]=n[z]);return y(a,w[0],w[1],u,A,L,I)}}function zd(){this.setModules=function(D,B){}}function Ad(){this.setModules=function(D,B,F){}}
function Bd(){}function Cd(){this.setModules=function(D,B){}}function Jb(){this.sampleRate=this.channels=this.dataLen=this.dataOffset=0}function Uc(D){return D.charCodeAt(0)<<24|D.charCodeAt(1)<<16|D.charCodeAt(2)<<8|D.charCodeAt(3)}var nb={fill:function(D,B,F,N){if(2==arguments.length)for(var O=0;O<D.length;O++)D[O]=arguments[1];else for(O=B;O<F;O++)D[O]=N}},la={arraycopy:function(D,B,F,N,O){for(O=B+O;B<O;)F[N++]=D[B++]},out:{}};la.out.println=function(D){console.log(D)};la.out.printf=function(){console.log.apply(console,
arguments)};var na={SQRT2:1.4142135623730951,FAST_LOG10:function(D){return Math.log10(D)},FAST_LOG10_X:function(D,B){return Math.log10(D)*B}};Va.short_block_allowed=new Va(0);Va.short_block_coupled=new Va(1);Va.short_block_dispensed=new Va(2);Va.short_block_forced=new Va(3);var qc={MAX_VALUE:3.4028235E38};aa.vbr_off=new aa(0);aa.vbr_mt=new aa(1);aa.vbr_rh=new aa(2);aa.vbr_abr=new aa(3);aa.vbr_mtrh=new aa(4);aa.vbr_default=aa.vbr_mtrh;Ca.STEREO=new Ca(0);Ca.JOINT_STEREO=new Ca(1);Ca.DUAL_CHANNEL=new Ca(2);
Ca.MONO=new Ca(3);Ca.NOT_SET=new Ca(4);ra.STEPS_per_dB=100;ra.MAX_dB=120;ra.GAIN_NOT_ENOUGH_SAMPLES=-24601;ra.GAIN_ANALYSIS_ERROR=0;ra.GAIN_ANALYSIS_OK=1;ra.INIT_GAIN_ANALYSIS_ERROR=0;ra.INIT_GAIN_ANALYSIS_OK=1;ra.YULE_ORDER=10;ra.MAX_ORDER=ra.YULE_ORDER;ra.MAX_SAMP_FREQ=48E3;ra.RMS_WINDOW_TIME_NUMERATOR=1;ra.RMS_WINDOW_TIME_DENOMINATOR=20;ra.MAX_SAMPLES_PER_WINDOW=ra.MAX_SAMP_FREQ*ra.RMS_WINDOW_TIME_NUMERATOR/ra.RMS_WINDOW_TIME_DENOMINATOR+1;Wa.EQ=function(D,B){return Math.abs(D)>Math.abs(B)?Math.abs(D-
B)<=1E-6*Math.abs(D):Math.abs(D-B)<=1E-6*Math.abs(B)};Wa.NEQ=function(D,B){return!Wa.EQ(D,B)};Ac.NUMTOCENTRIES=100;Ac.MAXFRAMESIZE=2880;var R={t1HB:[1,1,1,0],t2HB:[1,2,1,3,1,1,3,2,0],t3HB:[3,2,1,1,1,1,3,2,0],t5HB:[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],t6HB:[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],t7HB:[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],t8HB:[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],t9HB:[7,5,9,14,15,7,6,4,5,5,6,7,
7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],t10HB:[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],t11HB:[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],t12HB:[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,
32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],t13HB:[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,
61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],t15HB:[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,
28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,
45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],t16HB:[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,
366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,
0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],t24HB:[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,
353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,
3,1,3],t32HB:[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],t33HB:[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],t1l:[1,4,3,5],t2l:[1,4,7,4,5,7,6,7,8],t3l:[2,3,7,4,4,7,6,7,8],t5l:[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],t6l:[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],t7l:[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],t8l:[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],t9l:[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,
9,10,8,8,9,9,10,11,9,9,10,10,11,11],t10l:[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],t11l:[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],t12l:[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,
10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],t13l:[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,
13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],t15l:[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,
10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,
15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],t16_5l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,
14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],t16l:[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,
12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,
15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],t24l:[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,
11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],t32l:[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],t33l:[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8]};R.ht=[new ya(0,0,null,null),new ya(2,0,R.t1HB,R.t1l),new ya(3,0,R.t2HB,R.t2l),new ya(3,0,R.t3HB,R.t3l),new ya(0,
0,null,null),new ya(4,0,R.t5HB,R.t5l),new ya(4,0,R.t6HB,R.t6l),new ya(6,0,R.t7HB,R.t7l),new ya(6,0,R.t8HB,R.t8l),new ya(6,0,R.t9HB,R.t9l),new ya(8,0,R.t10HB,R.t10l),new ya(8,0,R.t11HB,R.t11l),new ya(8,0,R.t12HB,R.t12l),new ya(16,0,R.t13HB,R.t13l),new ya(0,0,null,R.t16_5l),new ya(16,0,R.t15HB,R.t15l),new ya(1,1,R.t16HB,R.t16l),new ya(2,3,R.t16HB,R.t16l),new ya(3,7,R.t16HB,R.t16l),new ya(4,15,R.t16HB,R.t16l),new ya(6,63,R.t16HB,R.t16l),new ya(8,255,R.t16HB,R.t16l),new ya(10,1023,R.t16HB,R.t16l),new ya(13,
8191,R.t16HB,R.t16l),new ya(4,15,R.t24HB,R.t24l),new ya(5,31,R.t24HB,R.t24l),new ya(6,63,R.t24HB,R.t24l),new ya(7,127,R.t24HB,R.t24l),new ya(8,255,R.t24HB,R.t24l),new ya(9,511,R.t24HB,R.t24l),new ya(11,2047,R.t24HB,R.t24l),new ya(13,8191,R.t24HB,R.t24l),new ya(0,0,R.t32HB,R.t32l),new ya(0,0,R.t33HB,R.t33l)];R.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,
786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,
720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,
1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,
1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];R.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];R.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];R.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,
-1,-1,-1,-1]];R.samplerate_table=[[22050,24E3,16E3,-1],[44100,48E3,32E3,-1],[11025,12E3,8E3,-1]];R.scfsi_band=[0,6,11,16,21];var Cb={};Cb.SFBMAX=3*v.SBMAX_s;v.ENCDELAY=576;v.POSTDELAY=1152;v.MDCTDELAY=48;v.FFTOFFSET=224+v.MDCTDELAY;v.DECDELAY=528;v.SBLIMIT=32;v.CBANDS=64;v.SBPSY_l=21;v.SBPSY_s=12;v.SBMAX_l=22;v.SBMAX_s=13;v.PSFB21=6;v.PSFB12=6;v.BLKSIZE=1024;v.HBLKSIZE=v.BLKSIZE/2+1;v.BLKSIZE_s=256;v.HBLKSIZE_s=v.BLKSIZE_s/2+1;v.NORM_TYPE=0;v.START_TYPE=1;v.SHORT_TYPE=2;v.STOP_TYPE=3;v.MPG_MD_LR_LR=
0;v.MPG_MD_LR_I=1;v.MPG_MD_MS_LR=2;v.MPG_MD_MS_I=3;v.fircoef=[-.1039435,-.1892065,-.0432472*5,-.155915,3.898045E-17,.0467745*5,.50455,.756825,.187098*5];Ba.MFSIZE=3456+v.ENCDELAY-v.MDCTDELAY;Ba.MAX_HEADER_BUF=256;Ba.MAX_BITS_PER_CHANNEL=4095;Ba.MAX_BITS_PER_GRANULE=7680;Ba.BPC=320;fb.Q_MAX=257;fb.Q_MAX2=116;fb.LARGE_BITS=1E5;fb.IXMAX_VAL=8206;Jb.RIFF=Uc("RIFF");Jb.WAVE=Uc("WAVE");Jb.fmt_=Uc("fmt ");Jb.data=Uc("data");Jb.readHeader=function(D){var B=new Jb,F=D.getUint32(0,!1);if(Jb.RIFF==F&&(D.getUint32(4,
!0),Jb.WAVE==D.getUint32(8,!1)&&Jb.fmt_==D.getUint32(12,!1))){var N=D.getUint32(16,!0),O=20;switch(N){case 16:case 18:B.channels=D.getUint16(O+2,!0);B.sampleRate=D.getUint32(O+4,!0);break;default:throw"extended fmt chunk not implemented";}O+=N;N=Jb.data;for(var K=0;N!=F;){F=D.getUint32(O,!1);K=D.getUint32(O+4,!0);if(N==F)break;O+=K+8}B.dataLen=K;B.dataOffset=O+8;return B}};Cb.SFBMAX=3*v.SBMAX_s;lamejs.Mp3Encoder=function(D,B,F){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),
D=1,B=44100,F=128);var N=new ia,O=new zd,K=new ra,S=new Wa,p=new kd,e=new fb,y=new sd,b=new Ac,x=new jd,G=new Cd,f=new ld,k=new zc,c=new Ad,m=new Bd;N.setModules(K,S,p,e,y,b,x,G,m);S.setModules(K,m,x,b);G.setModules(S,x);p.setModules(N);y.setModules(S,f,e,k);e.setModules(k,f,N.enc.psy);f.setModules(S);k.setModules(e);b.setModules(N,S,x);O.setModules(c,m);c.setModules(x,G,p);var t=N.lame_init();t.num_channels=D;t.in_samplerate=B;t.brate=F;t.mode=Ca.STEREO;t.quality=3;t.bWriteVbrTag=!1;t.disable_reservoir=
!0;t.write_id3tag_automatic=!1;N.lame_init_params(t);var r=1152,d=0|1.25*r+7200,g=new Int8Array(d);this.encodeBuffer=function(h,q){1==D&&(q=h);h.length>r&&(r=h.length,d=0|1.25*r+7200,g=new Int8Array(d));h=N.lame_encode_buffer(t,h,q,h.length,g,0,d);return new Int8Array(g.subarray(0,h))};this.flush=function(){var h=N.lame_encode_flush(t,g,0,d);return new Int8Array(g.subarray(0,h))}};lamejs.WavHeader=Jb}lamejs();
